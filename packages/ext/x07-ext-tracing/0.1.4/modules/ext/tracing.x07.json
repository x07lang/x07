{"decls":[{"kind":"export","names":["ext.tracing.event_is_valid_record","ext.tracing.event_record","ext.tracing.event_record_level","ext.tracing.event_record_msg","ext.tracing.event_record_name","ext.tracing.event_record_span_id","ext.tracing.format_event_record","ext.tracing.format_span_record","ext.tracing.level_debug","ext.tracing.level_error","ext.tracing.level_info","ext.tracing.level_name","ext.tracing.level_trace","ext.tracing.level_warn","ext.tracing.span_id","ext.tracing.span_is_valid_record","ext.tracing.span_record","ext.tracing.span_record_id","ext.tracing.span_record_name","ext.tracing.span_record_parent"]},{"body":["begin",["let","n",["view.len","rec"]],["if",["<u","n",14],["return",0],0],["if",["!=",["view.get_u8","rec",0],0],["return",0],0],["let","name_len",["codec.read_u32_le","rec",6]],["let","after_name",["+",10,"name_len"]],["if",["<u","n",["+","after_name",4]],["return",0],0],["let","msg_len",["codec.read_u32_le","rec","after_name"]],["let","expected",["+",["+","after_name",4],"msg_len"]],["=","n","expected"]],"kind":"defn","name":"ext.tracing.event_is_valid_record","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","name_len",["view.len","name"]],["let","msg_len",["view.len","msg"]],["let","v",["vec_u8.with_capacity",["+",["+",14,"name_len"],"msg_len"]]],["set","v",["vec_u8.push","v",0]],["set","v",["vec_u8.push","v","level"]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","span_id"]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","name_len"]]],["set","v",["vec_u8.extend_bytes","v","name"]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","msg_len"]]],["set","v",["vec_u8.extend_bytes","v","msg"]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.tracing.event_record","params":[{"name":"level","ty":"i32"},{"name":"span_id","ty":"i32"},{"name":"name","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["if",["ext.tracing.event_is_valid_record","rec"],["view.get_u8","rec",1],0],"kind":"defn","name":"ext.tracing.event_record_level","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.tracing.event_is_valid_record","rec"],0],["return",["bytes.alloc",0]],0],["let","name_len",["codec.read_u32_le","rec",6]],["let","after_name",["+",10,"name_len"]],["let","msg_len",["codec.read_u32_le","rec","after_name"]],["view.to_bytes",["view.slice","rec",["+","after_name",4],"msg_len"]]],"kind":"defn","name":"ext.tracing.event_record_msg","params":[{"name":"rec","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.tracing.event_is_valid_record","rec"],0],["return",["bytes.alloc",0]],0],["let","name_len",["codec.read_u32_le","rec",6]],["view.to_bytes",["view.slice","rec",10,"name_len"]]],"kind":"defn","name":"ext.tracing.event_record_name","params":[{"name":"rec","ty":"bytes_view"}],"result":"bytes"},{"body":["if",["ext.tracing.event_is_valid_record","rec"],["codec.read_u32_le","rec",2],0],"kind":"defn","name":"ext.tracing.event_record_span_id","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.tracing.event_is_valid_record","rec"],0],["return",["bytes.lit","invalid_ext.tracing_event_record"]],0],["let","level",["view.get_u8","rec",1]],["let","span_id",["codec.read_u32_le","rec",2]],["let","name_len",["codec.read_u32_le","rec",6]],["let","after_name",["+",10,"name_len"]],["let","msg_len",["codec.read_u32_le","rec","after_name"]],["let","name_view",["view.slice","rec",10,"name_len"]],["let","msg_view",["view.slice","rec",["+","after_name",4],"msg_len"]],["let","level_name",["ext.tracing.level_name","level"]],["let","span_id_str",["std.fmt.u32_to_dec","span_id"]],["let","out",["vec_u8.with_capacity",["+",48,["+",["+",["bytes.len","level_name"],["bytes.len","span_id_str"]],["+","name_len","msg_len"]]]]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","event"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","level="]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","level_name"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","span="]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","span_id_str"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","name="]]],["set","out",["vec_u8.extend_bytes","out","name_view"]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","msg="]]],["set","out",["vec_u8.extend_bytes","out","msg_view"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.tracing.format_event_record","params":[{"name":"rec","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.tracing.span_is_valid_record","rec"],0],["return",["bytes.lit","invalid_ext.tracing_span_record"]],0],["let","span_id",["codec.read_u32_le","rec",1]],["let","parent_id",["codec.read_u32_le","rec",5]],["let","name_len",["codec.read_u32_le","rec",9]],["let","name_view",["view.slice","rec",13,"name_len"]],["let","span_id_str",["std.fmt.u32_to_dec","span_id"]],["let","parent_id_str",["std.fmt.u32_to_dec","parent_id"]],["let","out",["vec_u8.with_capacity",["+",32,["+",["bytes.len","span_id_str"],["+",["bytes.len","parent_id_str"],"name_len"]]]]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","span"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","id="]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","span_id_str"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","parent="]]],["set","out",["vec_u8.extend_bytes","out",["bytes.view","parent_id_str"]]],["set","out",["vec_u8.push","out",32]],["set","out",["vec_u8.extend_bytes","out",["bytes.lit","name="]]],["set","out",["vec_u8.extend_bytes","out","name_view"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.tracing.format_span_record","params":[{"name":"rec","ty":"bytes_view"}],"result":"bytes"},{"body":4,"kind":"defn","name":"ext.tracing.level_debug","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"ext.tracing.level_error","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"ext.tracing.level_info","params":[],"result":"i32"},{"body":["if",["=","level",1],["bytes.lit","error"],["if",["=","level",2],["bytes.lit","warn"],["if",["=","level",3],["bytes.lit","info"],["if",["=","level",4],["bytes.lit","debug"],["if",["=","level",5],["bytes.lit","trace"],["bytes.lit","unknown"]]]]]],"kind":"defn","name":"ext.tracing.level_name","params":[{"name":"level","ty":"i32"}],"result":"bytes"},{"body":5,"kind":"defn","name":"ext.tracing.level_trace","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"ext.tracing.level_warn","params":[],"result":"i32"},{"body":["begin",["let","h",["std.hash.fnv1a32_view","name"]],["let","x",["^","h","parent_id"]],["let","id",["std.hash.mix32","x"]],["if",["=","id",0],1,"id"]],"kind":"defn","name":"ext.tracing.span_id","params":[{"name":"parent_id","ty":"i32"},{"name":"name","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","rec"]],["if",["<u","n",13],["return",0],0],["if",["!=",["view.get_u8","rec",0],0],["return",0],0],["let","name_len",["codec.read_u32_le","rec",9]],["=","n",["+",13,"name_len"]]],"kind":"defn","name":"ext.tracing.span_is_valid_record","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","name_len",["view.len","name"]],["let","v",["vec_u8.with_capacity",["+",13,"name_len"]]],["set","v",["vec_u8.push","v",0]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","span_id"]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","parent_id"]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le","name_len"]]],["set","v",["vec_u8.extend_bytes","v","name"]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.tracing.span_record","params":[{"name":"span_id","ty":"i32"},{"name":"parent_id","ty":"i32"},{"name":"name","ty":"bytes_view"}],"result":"bytes"},{"body":["if",["ext.tracing.span_is_valid_record","rec"],["codec.read_u32_le","rec",1],0],"kind":"defn","name":"ext.tracing.span_record_id","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.tracing.span_is_valid_record","rec"],0],["return",["bytes.alloc",0]],0],["let","name_len",["codec.read_u32_le","rec",9]],["view.to_bytes",["view.slice","rec",13,"name_len"]]],"kind":"defn","name":"ext.tracing.span_record_name","params":[{"name":"rec","ty":"bytes_view"}],"result":"bytes"},{"body":["if",["ext.tracing.span_is_valid_record","rec"],["codec.read_u32_le","rec",5],0],"kind":"defn","name":"ext.tracing.span_record_parent","params":[{"name":"rec","ty":"bytes_view"}],"result":"i32"}],"imports":["std.fmt","std.hash"],"kind":"module","module_id":"ext.tracing","schema_version":"x07.x07ast@0.3.0"}
