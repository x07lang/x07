{"decls":[{"kind":"export","names":["std.auth.jose_jws_v1.tests.test_alg_rejected_v1","std.auth.jose_jws_v1.tests.test_es256_ok_v1","std.auth.jose_jws_v1.tests.test_rs256_ok_v1"]},{"body":["begin",["let","doc",["ext.json.data_model.parse","out_json"]],["let","dv",["bytes.view","doc"]],["try",["std.test.assert_i32_eq",["ext.data_model.doc_is_err","dv"],0,["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["ext.data_model.root_kind","dv"],5,["std.test.code_assert_i32_eq"]]],["let","root",["ext.data_model.root_offset","dv"]],["let","k_ok",["bytes.lit","ok"]],["let","ok_off",["ext.data_model.map_find","dv","root",["bytes.view","k_ok"]]],["try",["std.test.assert_true",[">=","ok_off",0],["std.test.code_assert_true"]]],["try",["std.test.assert_i32_eq",["ext.data_model.bool_get","dv","ok_off"],0,["std.test.code_assert_i32_eq"]]],["let","k_code",["bytes.lit","code"]],["let","code_off",["ext.data_model.map_find","dv","root",["bytes.view","k_code"]]],["try",["std.test.assert_true",[">=","code_off",0],["std.test.code_assert_true"]]],["let","code",["ext.data_model.string_get","dv","code_off"]],["try",["std.test.assert_bytes_eq","code",["bytes.lit","ERR_JWS_VERIFY"],["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"std.auth.jose_jws_v1.tests._assert_err_v1","params":[{"name":"out_json","ty":"bytes_view"}],"result":"result_i32"},{"body":["begin",["let","doc",["ext.json.data_model.parse","out_json"]],["let","dv",["bytes.view","doc"]],["try",["std.test.assert_i32_eq",["ext.data_model.doc_is_err","dv"],0,["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["ext.data_model.root_kind","dv"],5,["std.test.code_assert_i32_eq"]]],["let","root",["ext.data_model.root_offset","dv"]],["let","k_ok",["bytes.lit","ok"]],["let","ok_off",["ext.data_model.map_find","dv","root",["bytes.view","k_ok"]]],["try",["std.test.assert_true",[">=","ok_off",0],["std.test.code_assert_true"]]],["try",["std.test.assert_i32_eq",["ext.data_model.bool_get","dv","ok_off"],1,["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"std.auth.jose_jws_v1.tests._assert_ok_v1","params":[{"name":"out_json","ty":"bytes_view"}],"result":"result_i32"},{"body":["begin",["let","raw",["os.fs.read_file","path"]],["std.text.ascii.normalize_lines",["bytes.view","raw"]]],"kind":"defn","name":"std.auth.jose_jws_v1.tests._read_norm_text_v1","params":[{"name":"path","ty":"bytes"}],"result":"bytes"},{"body":["begin",["let","token",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/dpop_proof_valid.jwt"]]],["let","jwk",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/jwk_ec_p256_public.json"]]],["let","opts",["bytes.lit","{\"schema_version\":\"x07.jose.verify_opts@0.1.0\",\"accepted_algs\":[\"RS256\"],\"require_typ\":null}"]],["let","out_res",["std.auth.jose_jws_v1.jws_compact_verify_v1",["bytes.view","token"],["bytes.view","jwk"],["bytes.view","opts"]]],["try",["std.test.assert_i32_eq",["result_bytes.err_code","out_res"],0,["std.test.code_assert_i32_eq"]]],["let","out",["result_bytes.unwrap_or","out_res",["bytes.alloc",0]]],["try",["std.auth.jose_jws_v1.tests._assert_err_v1",["bytes.view","out"]]],["std.test.pass"]],"kind":"defn","name":"std.auth.jose_jws_v1.tests.test_alg_rejected_v1","params":[],"result":"result_i32"},{"body":["begin",["let","token",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/dpop_proof_valid.jwt"]]],["let","jwk",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/jwk_ec_p256_public.json"]]],["let","opts",["bytes.lit","{\"schema_version\":\"x07.jose.verify_opts@0.1.0\",\"accepted_algs\":[\"ES256\"],\"require_typ\":null}"]],["let","out_res",["std.auth.jose_jws_v1.jws_compact_verify_v1",["bytes.view","token"],["bytes.view","jwk"],["bytes.view","opts"]]],["try",["std.test.assert_i32_eq",["result_bytes.err_code","out_res"],0,["std.test.code_assert_i32_eq"]]],["let","out",["result_bytes.unwrap_or","out_res",["bytes.alloc",0]]],["try",["std.auth.jose_jws_v1.tests._assert_ok_v1",["bytes.view","out"]]],["std.test.pass"]],"kind":"defn","name":"std.auth.jose_jws_v1.tests.test_es256_ok_v1","params":[],"result":"result_i32"},{"body":["begin",["let","token",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/access_token_rs256_valid.jwt"]]],["let","jwk",["std.auth.jose_jws_v1.tests._read_norm_text_v1",["bytes.lit","packages/ext/x07-ext-auth-jwt/0.1.2/tests/fixtures/jws/jwk_rsa_public.json"]]],["let","opts",["bytes.lit","{\"schema_version\":\"x07.jose.verify_opts@0.1.0\",\"accepted_algs\":[\"RS256\"],\"require_typ\":null}"]],["let","out_res",["std.auth.jose_jws_v1.jws_compact_verify_v1",["bytes.view","token"],["bytes.view","jwk"],["bytes.view","opts"]]],["try",["std.test.assert_i32_eq",["result_bytes.err_code","out_res"],0,["std.test.code_assert_i32_eq"]]],["let","out",["result_bytes.unwrap_or","out_res",["bytes.alloc",0]]],["try",["std.auth.jose_jws_v1.tests._assert_ok_v1",["bytes.view","out"]]],["std.test.pass"]],"kind":"defn","name":"std.auth.jose_jws_v1.tests.test_rs256_ok_v1","params":[],"result":"result_i32"}],"imports":["ext.data_model","ext.json.data_model","std.auth.jose_jws_v1","std.test","std.text.ascii"],"kind":"module","module_id":"std.auth.jose_jws_v1.tests","schema_version":"x07.x07ast@0.3.0"}
