{"decls":[{"kind":"export","names":["ext.regex.cap_end_v1","ext.regex.cap_len_v1","ext.regex.cap_start_v1","ext.regex.cap_view_v1","ext.regex.caps_count_v1","ext.regex.code_compile_stack_overflow","ext.regex.code_compile_too_many_states","ext.regex.code_exec_invalid_compiled","ext.regex.code_parse_invalid_class","ext.regex.code_parse_invalid_escape","ext.regex.code_parse_invalid_repeat","ext.regex.code_parse_nothing_to_repeat","ext.regex.code_parse_repeat_range","ext.regex.code_parse_too_many_captures","ext.regex.code_parse_unbalanced_paren","ext.regex.code_parse_unclosed_class","ext.regex.compile","ext.regex.compile_opts_v1","ext.regex.err_code","ext.regex.err_pos","ext.regex.exec","ext.regex.exec_caps_from_v1","ext.regex.exec_caps_v1","ext.regex.exec_from_v1","ext.regex.exec_pat","ext.regex.find_all_x7sl_v1","ext.regex.is_err","ext.regex.is_match","ext.regex.match_end","ext.regex.match_len","ext.regex.match_start","ext.regex.opts_casei_v1","ext.regex.opts_dotall_v1","ext.regex.opts_multiline_v1","ext.regex.replace_all_v1","ext.regex.split_v1"]},{"body":["begin",["let","classes",["vec_u8.with_capacity",128]],["let","d_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",0]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",48]],["set","classes",["vec_u8.push","classes",57]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","d_off",1],1]],["let","d_len",["-",["vec_u8.len","classes"],"d_off"]],["let","D_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",1]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",48]],["set","classes",["vec_u8.push","classes",57]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","D_off",1],1]],["let","D_len",["-",["vec_u8.len","classes"],"D_off"]],["let","w_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",0]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",48]],["set","classes",["vec_u8.push","classes",57]],["set","classes",["vec_u8.push","classes",65]],["set","classes",["vec_u8.push","classes",90]],["set","classes",["vec_u8.push","classes",95]],["set","classes",["vec_u8.push","classes",95]],["set","classes",["vec_u8.push","classes",97]],["set","classes",["vec_u8.push","classes",122]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","w_off",1],4]],["let","w_len",["-",["vec_u8.len","classes"],"w_off"]],["let","W_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",1]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",48]],["set","classes",["vec_u8.push","classes",57]],["set","classes",["vec_u8.push","classes",65]],["set","classes",["vec_u8.push","classes",90]],["set","classes",["vec_u8.push","classes",95]],["set","classes",["vec_u8.push","classes",95]],["set","classes",["vec_u8.push","classes",97]],["set","classes",["vec_u8.push","classes",122]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","W_off",1],4]],["let","W_len",["-",["vec_u8.len","classes"],"W_off"]],["let","s_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",0]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",9]],["set","classes",["vec_u8.push","classes",13]],["set","classes",["vec_u8.push","classes",32]],["set","classes",["vec_u8.push","classes",32]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","s_off",1],2]],["let","s_len",["-",["vec_u8.len","classes"],"s_off"]],["let","S_off",["vec_u8.len","classes"]],["set","classes",["vec_u8.push","classes",1]],["set","classes",["std.u32.push_le","classes",0]],["set","classes",["vec_u8.push","classes",9]],["set","classes",["vec_u8.push","classes",13]],["set","classes",["vec_u8.push","classes",32]],["set","classes",["vec_u8.push","classes",32]],["set","classes",["std.u32.write_le_at_vec_u8","classes",["+","S_off",1],2]],["let","S_len",["-",["vec_u8.len","classes"],"S_off"]],["let","classes_b",["std.vec.as_bytes","classes"]],["let","classes_len",["view.len",["bytes.view","classes_b"]]],["let","out",["vec_u8.with_capacity",["+",49,"classes_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","d_off"]],["set","out",["std.u32.push_le","out","d_len"]],["set","out",["std.u32.push_le","out","D_off"]],["set","out",["std.u32.push_le","out","D_len"]],["set","out",["std.u32.push_le","out","w_off"]],["set","out",["std.u32.push_le","out","w_len"]],["set","out",["std.u32.push_le","out","W_off"]],["set","out",["std.u32.push_le","out","W_len"]],["set","out",["std.u32.push_le","out","s_off"]],["set","out",["std.u32.push_le","out","s_len"]],["set","out",["std.u32.push_le","out","S_off"]],["set","out",["std.u32.push_le","out","S_len"]],["set","out",["vec_u8.extend_bytes_range","out","classes_b",0,"classes_len"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._builtin_classes","params":[],"result":"bytes"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","v",["std.u32.read_le_at","src_work",["+","src_base",["*","slot",4]]]],["set","dst_work",["std.u32.write_le_at","dst_work",["+","dst_base",["*","slot",4]],"v"]],0]],"dst_work"],"kind":"defn","name":"ext.regex._caps_copy_row_between","params":[{"name":"dst_work","ty":"bytes"},{"name":"src_work","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"dst","ty":"i32"},{"name":"src","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=","dst","src"],["return","work"],0],["let","src_base",["+","state_count",["*","src","row_len"]]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","v",["std.u32.read_le_at",["bytes.view","work"],["+","src_base",["*","slot",4]]]],["set","work",["std.u32.write_le_at","work",["+","dst_base",["*","slot",4]],"v"]],0]],"work"],"kind":"defn","name":"ext.regex._caps_copy_row_within","params":[{"name":"work","ty":"bytes"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"dst","ty":"i32"},{"name":"src","ty":"i32"}],"result":"bytes"},{"body":["begin",["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","dst","src"]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["std.u32.write_le_at","work",["+","dst_base",["*","slot",4]],"val"]],"kind":"defn","name":"ext.regex._caps_copy_row_within_save","params":[{"name":"work","ty":"bytes"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"dst","ty":"i32"},{"name":"src","ty":"i32"},{"name":"slot","ty":"i32"},{"name":"val","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","v",["std.u32.read_le_at","work",["+","src_base",["*","slot",4]]]],["set","out",["std.u32.write_le_at","out",["*","slot",4],"v"]],0]],"out"],"kind":"defn","name":"ext.regex._caps_copy_to_bytes","params":[{"name":"out","ty":"bytes"},{"name":"work","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"src","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","a",["std.u32.read_le_at","src_work",["+","src_base",["*","slot",4]]]],["let","b",["std.u32.read_le_at","dst_work",["+","dst_base",["*","slot",4]]]],["if",["<u","a","b"],["return",1],0],["if",[">u","a","b"],["return",0],0],0]],0],"kind":"defn","name":"ext.regex._caps_lt_between","params":[{"name":"src_work","ty":"bytes_view"},{"name":"dst_work","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"src","ty":"i32"},{"name":"dst","ty":"i32"}],"result":"i32"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["for","i",0,"cap_slots",["begin",["let","a",["if",["=","i","slot"],"val",["std.u32.read_le_at","work",["+","src_base",["*","i",4]]]]],["let","b",["std.u32.read_le_at","work",["+","dst_base",["*","i",4]]]],["if",["<u","a","b"],["return",1],0],["if",[">u","a","b"],["return",0],0],0]],0],"kind":"defn","name":"ext.regex._caps_lt_save_within","params":[{"name":"work","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"src","ty":"i32"},{"name":"dst","ty":"i32"},{"name":"slot","ty":"i32"},{"name":"val","ty":"i32"}],"result":"i32"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["let","dst_base",["+","state_count",["*","dst","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","a",["std.u32.read_le_at","work",["+","src_base",["*","slot",4]]]],["let","b",["std.u32.read_le_at","work",["+","dst_base",["*","slot",4]]]],["if",["<u","a","b"],["return",1],0],["if",[">u","a","b"],["return",0],0],0]],0],"kind":"defn","name":"ext.regex._caps_lt_within","params":[{"name":"work","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"src","ty":"i32"},{"name":"dst","ty":"i32"}],"result":"i32"},{"body":["begin",["let","src_base",["+","state_count",["*","src","row_len"]]],["for","slot",0,"cap_slots",["begin",["let","a",["std.u32.read_le_at","work",["+","src_base",["*","slot",4]]]],["let","b",["std.u32.read_le_at","best",["*","slot",4]]],["if",["<u","a","b"],["return",1],0],["if",[">u","a","b"],["return",0],0],0]],0],"kind":"defn","name":"ext.regex._caps_lt_work_row_vs_bytes","params":[{"name":"work","ty":"bytes_view"},{"name":"best","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"src","ty":"i32"}],"result":"i32"},{"body":["begin",["let","slots",["*","cap_count",2]],["let","out",["vec_u8.with_capacity",["*","slots",4]]],["let","done",0],["for","_",0,["+","slots",1],["if","done",0,["if",[">=u","_","slots"],["set","done",1],["begin",["set","out",["std.u32.push_le","out",-1]],0]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._caps_missing_table","params":[{"name":"cap_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","classes"]],["if",["<","off",0],["return",0],0],["if",["<","len",5],["return",0],0],["if",[">=u","off",["+","n",1]],["return",0],0],["if",[">=u",["-","n","off"],"len"],0,["return",0]],["let","neg",["view.get_u8","classes","off"]],["let","count",["codec.read_u32_le","classes",["+","off",1]]],["let","need",["+",5,["*","count",2]]],["if",[">=u","len","need"],0,["return",0]],["let","pos",["+","off",5]],["let","matched",0],["for","i",0,"count",["begin",["let","a",["view.get_u8","classes",["+","pos",["*","i",2]]]],["let","b",["view.get_u8","classes",["+","pos",["+",["*","i",2],1]]]],["if",["if",[">=u","c","a"],["<=u","c","b"],0],["set","matched",1],0],0]],["if",["=","neg",1],["if",["=","matched",1],0,1],"matched"]],"kind":"defn","name":"ext.regex._class_matches","params":[{"name":"classes","ty":"bytes_view"},{"name":"off","ty":"i32"},{"name":"len","ty":"i32"},{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","parsed",["ext.regex._parse_post","pat"]],["if",["ext.regex.is_err",["bytes.view","parsed"]],["return","parsed"],0],["let","n",["view.len","pat"]],["let","pv",["bytes.view","parsed"]],["let","classes_len",["codec.read_u32_le","pv",1]],["let","post_len",["codec.read_u32_le","pv",5]],["let","cap_count",["codec.read_u32_le","pv",9]],["let","post_off",["+",13,"classes_len"]],["let","classes_b",["bytes.slice","parsed",13,"classes_len"]],["let","post_b",["bytes.slice","parsed","post_off","post_len"]],["let","classes",["vec_u8.with_capacity","classes_len"]],["set","classes",["vec_u8.extend_bytes","classes","classes_b"]],["ext.regex._compile_nfa_from_post","post_b","classes","n","opts","cap_count"]],"kind":"defn","name":"ext.regex._compile_impl","params":[{"name":"pat","ty":"bytes_view"},{"name":"opts","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","post_v",["bytes.view","post_b"]],["let","post_len",["view.len","post_v"]],["let","states",["vec_u8.with_capacity",["+",["*","post_len",["ext.regex._state_size"]],["*",4,["ext.regex._state_size"]]]]],["let","state_count",0],["let","frag_cap",["+","n",8]],["let","frag_stack",["bytes.alloc",["*","frag_cap",16]]],["let","frag_len",["bytes.len","frag_stack"]],["let","frag_top",0],["let","j",0],["let","cdone",0],["for","_",0,["+","post_len",1],["if","cdone",0,["if",[">=u","j","post_len"],["set","cdone",1],["begin",["let","tag",["view.get_u8","post_v","j"]],["set","j",["+","j",1]],["let","r",["bytes.alloc",0]],["if",["=","tag",["ext.regex._tok_lit"]],["begin",["if",[">=u","j","post_len"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","lit",["view.get_u8","post_v","j"]],["set","j",["+","j",1]],["set","r",["ext.regex._nfa_push_atom","frag_stack","frag_top","frag_cap","state_count",["ext.regex._kind_char"],"lit",0]],0],["if",["if",["=","tag",["ext.regex._tok_any"]],1,["if",["=","tag",["ext.regex._tok_bol"]],1,["=","tag",["ext.regex._tok_eol"]]]],["begin",["let","kind",["if",["=","tag",["ext.regex._tok_any"]],["ext.regex._kind_any"],["if",["=","tag",["ext.regex._tok_bol"]],["ext.regex._kind_bol"],["ext.regex._kind_eol"]]]],["set","r",["ext.regex._nfa_push_atom","frag_stack","frag_top","frag_cap","state_count","kind",0,0]],0],["if",["=","tag",["ext.regex._tok_class"]],["begin",["if",[">=u",["+","j",7],"post_len"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","cls_off",["codec.read_u32_le","post_v","j"]],["let","cls_len",["codec.read_u32_le","post_v",["+","j",4]]],["set","j",["+","j",8]],["set","r",["ext.regex._nfa_push_atom","frag_stack","frag_top","frag_cap","state_count",["ext.regex._kind_class"],"cls_off","cls_len"]],0],["if",["=","tag",["ext.regex._tok_save"]],["begin",["if",[">=u",["+","j",3],"post_len"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","slot",["codec.read_u32_le","post_v","j"]],["set","j",["+","j",4]],["set","r",["ext.regex._nfa_push_atom","frag_stack","frag_top","frag_cap","state_count",["ext.regex._kind_save"],"slot",0]],0],["if",["=","tag",["ext.regex._op_concat"]],["begin",["set","r",["ext.regex._nfa_op_concat","frag_stack","frag_top","state_count"]],0],["if",["=","tag",["ext.regex._op_alt"]],["begin",["set","r",["ext.regex._nfa_op_alt","frag_stack","frag_top","state_count"]],0],["if",["if",["=","tag",["ext.regex._op_star"]],1,["if",["=","tag",["ext.regex._op_plus"]],1,["=","tag",["ext.regex._op_qmark"]]]],["begin",["set","r",["if",["=","tag",["ext.regex._op_star"]],["ext.regex._nfa_op_star","frag_stack","frag_top","state_count"],["if",["=","tag",["ext.regex._op_plus"]],["ext.regex._nfa_op_plus","frag_stack","frag_top","state_count"],["ext.regex._nfa_op_qmark","frag_stack","frag_top","state_count"]]]],0],["if",["=","tag",["ext.regex._op_repeat"]],["begin",["if",[">=u",["+","j",7],"post_len"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","m",["codec.read_u32_le","post_v","j"]],["let","nval",["codec.read_u32_le","post_v",["+","j",4]]],["set","j",["+","j",8]],["set","r",["ext.regex._nfa_op_repeat",["vec_u8.as_view","states"],"frag_stack","frag_top","state_count","m","nval"]],0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]]]]]]]]]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","rv",["bytes.view","r"]],["set","state_count",["codec.read_u32_le","rv",1]],["set","frag_top",["codec.read_u32_le","rv",5]],["set","frag_stack",["bytes.slice","r",9,"frag_len"]],["let","patch_count",["codec.read_u32_le","rv",["+",9,"frag_len"]]],["let","delta_len",["codec.read_u32_le","rv",["+",["+",9,"frag_len"],4]]],["let","patches_start",["+",["+",9,"frag_len"],8]],["let","delta_start",["+","patches_start",["*","patch_count",8]]],["set","states",["vec_u8.extend_bytes_range","states","r","delta_start","delta_len"]],["for","k",0,"patch_count",["begin",["let","p_off",["codec.read_u32_le","rv",["+","patches_start",["*","k",8]]]],["let","p_val",["codec.read_u32_le","rv",["+","patches_start",["+",["*","k",8],4]]]],["set","states",["std.u32.write_le_at_vec_u8","states","p_off","p_val"]],0]],0]]]],["if",["!=","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","final_start",["codec.read_u32_le",["bytes.view","frag_stack"],0]],["let","final_end",["codec.read_u32_le",["bytes.view","frag_stack"],4]],["let","final_min",["codec.read_u32_le",["bytes.view","frag_stack"],8]],["let","final_max",["codec.read_u32_le",["bytes.view","frag_stack"],12]],["if",[">=u",["+","state_count",1],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","match","state_count"],["set","states",["std.u32.push_le","states",["ext.regex._kind_match"]]],["set","states",["std.u32.push_le","states",0]],["set","states",["std.u32.push_le","states",0]],["set","states",["std.u32.push_le","states",0]],["set","state_count",["+","state_count",1]],["set","states",["std.u32.write_le_at_vec_u8","states",["+",["*","final_end",16],8],"match"]],["let","classes_b",["vec_u8.into_bytes","classes"]],["let","states_b",["vec_u8.into_bytes","states"]],["let","classes_len",["bytes.len","classes_b"]],["let","out",["vec_u8.with_capacity",["+",["+",21,"classes_len"],["bytes.len","states_b"]]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","state_count"]],["set","out",["std.u32.push_le","out","final_start"]],["set","out",["std.u32.push_le","out","classes_len"]],["set","out",["std.u32.push_le","out","opts"]],["set","out",["std.u32.push_le","out","cap_count"]],["set","out",["vec_u8.extend_bytes","out","classes_b"]],["set","out",["vec_u8.extend_bytes","out","states_b"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._compile_nfa_from_post","params":[{"name":"post_b","ty":"bytes"},{"name":"classes","ty":"vec_u8"},{"name":"n","ty":"i32"},{"name":"opts","ty":"i32"},{"name":"cap_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","changed",1],["for","_",0,"state_count",["begin",["if",["=","changed",0],["return","flags"],0],["set","changed",0],["for","s",0,"state_count",["begin",["if",["=",["bytes.get_u8","flags","s"],0],0,["begin",["let","base",["*","s",["ext.regex._state_size"]]],["let","kind",["codec.read_u32_le","states","base"]],["if",["=","kind",["ext.regex._kind_split"]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["let","b",["codec.read_u32_le","states",["+","base",12]]],["if",["<u","a","state_count"],["if",["=",["bytes.get_u8","flags","a"],0],["begin",["set","flags",["bytes.set_u8","flags","a",1]],["set","changed",1],0],0],0],["if",["<u","b","state_count"],["if",["=",["bytes.get_u8","flags","b"],0],["begin",["set","flags",["bytes.set_u8","flags","b",1]],["set","changed",1],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_jmp"]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["if",["=",["bytes.get_u8","flags","a"],0],["begin",["set","flags",["bytes.set_u8","flags","a",1]],["set","changed",1],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_save"]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["if",["=",["bytes.get_u8","flags","a"],0],["begin",["set","flags",["bytes.set_u8","flags","a",1]],["set","changed",1],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_bol"]],["begin",["if",["if",["=","pos",0],1,["if",["=",["&","opts",["ext.regex.opts_multiline_v1"]],0],0,["if",[">","pos",0],["=",["view.get_u8","text",["-","pos",1]],10],0]]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["if",["=",["bytes.get_u8","flags","a"],0],["begin",["set","flags",["bytes.set_u8","flags","a",1]],["set","changed",1],0],0],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_eol"]],["begin",["if",["if",["=","pos","text_len"],1,["if",["=",["&","opts",["ext.regex.opts_multiline_v1"]],0],0,["if",["<u","pos","text_len"],["=",["view.get_u8","text","pos"],10],0]]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["if",["=",["bytes.get_u8","flags","a"],0],["begin",["set","flags",["bytes.set_u8","flags","a",1]],["set","changed",1],0],0],0],0],0],0],0],0]],0]],0]],"flags"],"kind":"defn","name":"ext.regex._eps_closure","params":[{"name":"flags","ty":"bytes"},{"name":"states","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"pos","ty":"i32"},{"name":"text","ty":"bytes_view"},{"name":"text_len","ty":"i32"},{"name":"opts","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","changed",1],["for","_",0,"state_count",["begin",["if",["=","changed",0],["return","work"],0],["set","changed",0],["for","s",0,"state_count",["begin",["if",["=",["bytes.get_u8","work","s"],0],0,["begin",["let","base",["*","s",["ext.regex._state_size"]]],["let","kind",["codec.read_u32_le","states","base"]],["if",["=","kind",["ext.regex._kind_split"]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["let","b",["codec.read_u32_le","states",["+","base",12]]],["if",["<u","a","state_count"],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","a","s"]],["set","changed",1],0],["begin",0,0]],0],0],["if",["<u","b","state_count"],["begin",["if",["=",["bytes.get_u8","work","b"],0],["begin",["set","work",["bytes.set_u8","work","b",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","b","s"]],["set","changed",1],0],["begin",0,0]],0],0],0],0],["if",["=","kind",["ext.regex._kind_jmp"]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","a","s"]],["set","changed",1],0],["begin",0,0]],0],0],0],0],["if",["=","kind",["ext.regex._kind_save"]],["begin",["let","slot",["codec.read_u32_le","states",["+","base",4]]],["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["begin",["if",["<u","slot","cap_slots"],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within_save","work","state_count","row_len","cap_slots","a","s","slot","pos"]],["set","changed",1],0],["begin",0,0]],0],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","a","s"]],["set","changed",1],0],["begin",0,0]],0]],0],0],0],0],["if",["=","kind",["ext.regex._kind_bol"]],["begin",["if",["if",["=","pos",0],1,["if",["=",["&","opts",["ext.regex.opts_multiline_v1"]],0],0,["if",[">","pos",0],["=",["view.get_u8","text",["-","pos",1]],10],0]]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","a","s"]],["set","changed",1],0],["begin",0,0]],0],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_eol"]],["begin",["if",["if",["=","pos","text_len"],1,["if",["=",["&","opts",["ext.regex.opts_multiline_v1"]],0],0,["if",["<u","pos","text_len"],["=",["view.get_u8","text","pos"],10],0]]],["begin",["let","a",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","a","state_count"],["begin",["if",["=",["bytes.get_u8","work","a"],0],["begin",["set","work",["bytes.set_u8","work","a",1]],["set","work",["ext.regex._caps_copy_row_within","work","state_count","row_len","cap_slots","a","s"]],["set","changed",1],0],["begin",0,0]],0],0],0],0],0],0],0]],0]],0]],"work"],"kind":"defn","name":"ext.regex._eps_closure_caps","params":[{"name":"work","ty":"bytes"},{"name":"states","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"pos","ty":"i32"},{"name":"text","ty":"bytes_view"},{"name":"text_len","ty":"i32"},{"name":"opts","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"row_len","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=","esc",110],["return",10],0],["if",["=","esc",114],["return",13],0],["if",["=","esc",116],["return",9],0],"esc"],"kind":"defn","name":"ext.regex._escape_to_byte","params":[{"name":"esc","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_err","compiled"],1],["return",["view.to_bytes","compiled"]],0],["let","n",["view.len","compiled"]],["if",["<","n",21],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","state_count",["codec.read_u32_le","compiled",1]],["let","start_state",["codec.read_u32_le","compiled",5]],["let","classes_len",["codec.read_u32_le","compiled",9]],["let","opts",["codec.read_u32_le","compiled",13]],["let","compiled_cap_count",["codec.read_u32_le","compiled",17]],["if",["<","state_count",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",["<","start_state",0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",[">=u","start_state","state_count"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",["<","classes_len",0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","states_len",["*","state_count",["ext.regex._state_size"]]],["let","need",["+",["+",21,"classes_len"],"states_len"]],["if",[">=u","n","need"],0,["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]]],["let","classes",["view.slice","compiled",21,"classes_len"]],["let","states",["view.slice","compiled",["+",21,"classes_len"],"states_len"]],["let","text_len",["view.len","text"]],["let","start",["if",["<","start_i32",0],0,"start_i32"]],["let","cap_limit0",["if",["<","cap_limit_i32",0],0,"cap_limit_i32"]],["let","cap_count",["if",["<u","cap_limit0","compiled_cap_count"],"cap_limit0","compiled_cap_count"]],["let","match_state",["ext.regex._find_match_state","states","state_count"]],["if",["<","match_state",0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","row_len",["*","cap_count",8]],["let","done",0],["for","_",0,["+","text_len",1],["if","done",0,["if",[">=u","start",["+","text_len",1]],["set","done",1],["begin",["let","m",["ext.regex._match_longest_from_caps","text","start","text_len","states","classes","state_count","start_state","match_state","opts","cap_count"]],["let","m_v",["bytes.view","m"]],["let","mlen",["codec.read_u32_le","m_v",0]],["if",["=","mlen",-1],["set","start",["+","start",1]],["return",["ext.regex._ok_caps",1,"start",["+","start","mlen"],"cap_count",["view.slice","m_v",4,"row_len"]]]],0]]]],["ext.regex._ok_caps",0,0,0,"cap_count",["view.slice","text",0,0]]],"kind":"defn","name":"ext.regex._exec_caps_from_impl","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"start_i32","ty":"i32"},{"name":"cap_limit_i32","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.regex.is_err","compiled"],1],["return",["view.to_bytes","compiled"]],0],["let","n",["view.len","compiled"]],["if",["<","n",21],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","state_count",["codec.read_u32_le","compiled",1]],["let","start_state",["codec.read_u32_le","compiled",5]],["let","classes_len",["codec.read_u32_le","compiled",9]],["let","opts",["codec.read_u32_le","compiled",13]],["let","cap_count",["codec.read_u32_le","compiled",17]],["if",["<","state_count",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",["<","start_state",0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",[">=u","start_state","state_count"],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",["<","classes_len",0],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["let","states_len",["*","state_count",["ext.regex._state_size"]]],["let","need",["+",["+",21,"classes_len"],"states_len"]],["if",[">=u","n","need"],0,["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]]],["let","classes",["view.slice","compiled",21,"classes_len"]],["let","states",["view.slice","compiled",["+",21,"classes_len"],"states_len"]],["let","text_len",["view.len","text"]],["let","start",["if",["<","start_i32",0],0,"start_i32"]],["let","done",0],["for","_",0,["+","text_len",1],["if","done",0,["if",[">=u","start",["+","text_len",1]],["set","done",1],["begin",["let","mlen",["ext.regex._match_longest_from","text","start","text_len","states","classes","state_count","start_state","opts"]],["if",["<","mlen",0],["set","start",["+","start",1]],["begin",["return",["ext.regex._ok_match",1,"start",["+","start","mlen"]]]]],0]]]],["ext.regex._ok_match",0,0,0]],"kind":"defn","name":"ext.regex._exec_from_impl","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"start_i32","ty":"i32"}],"result":"bytes"},{"body":["begin",["for","s",0,"state_count",["begin",["let","kind",["codec.read_u32_le","states",["*","s",["ext.regex._state_size"]]]],["if",["=","kind",["ext.regex._kind_match"]],["return","s"],0],0]],-1],"kind":"defn","name":"ext.regex._find_match_state","params":[{"name":"states","ty":"bytes_view"},{"name":"state_count","ty":"i32"}],"result":"i32"},{"body":["if",[">=u","c",48],["if",["<u","c",58],1,0],0],"kind":"defn","name":"ext.regex._is_digit_u8","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["=","c",92],["return",1],0],["if",["=","c",40],["return",1],0],["if",["=","c",41],["return",1],0],["if",["=","c",124],["return",1],0],["if",["=","c",42],["return",1],0],["if",["=","c",43],["return",1],0],["if",["=","c",63],["return",1],0],["if",["=","c",123],["return",1],0],["if",["=","c",91],["return",1],0],["if",["=","c",46],["return",1],0],["if",["=","c",94],["return",1],0],["if",["=","c",36],["return",1],0],0],"kind":"defn","name":"ext.regex._is_meta_u8","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":2,"kind":"defn","name":"ext.regex._kind_any","params":[],"result":"i32"},{"body":5,"kind":"defn","name":"ext.regex._kind_bol","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"ext.regex._kind_char","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"ext.regex._kind_class","params":[],"result":"i32"},{"body":6,"kind":"defn","name":"ext.regex._kind_eol","params":[],"result":"i32"},{"body":7,"kind":"defn","name":"ext.regex._kind_jmp","params":[],"result":"i32"},{"body":0,"kind":"defn","name":"ext.regex._kind_match","params":[],"result":"i32"},{"body":8,"kind":"defn","name":"ext.regex._kind_save","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"ext.regex._kind_split","params":[],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",9]],["set","out",["vec_u8.push","out",0]],["set","out",["std.u32.push_le","out","code"]],["set","out",["std.u32.push_le","out","pos"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._make_err","params":[{"name":"code","ty":"i32"},{"name":"pos","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","start",0],["return",-1],0],["if",[">=u","start",["+","text_len",1]],["return",-1],0],["if",["<","start_state",0],["return",-1],0],["if",[">=u","start_state","state_count"],["return",-1],0],["let","cur",["bytes.alloc","state_count"]],["set","cur",["bytes.set_u8","cur","start_state",1]],["set","cur",["ext.regex._eps_closure","cur","states","state_count","start","text","text_len","opts"]],["let","next",["bytes.alloc","state_count"]],["let","last",-1],["let","props0",["ext.regex._set_props",["bytes.view","cur"],"states","state_count"]],["if",["=",["&","props0",1],1],["set","last",0],0],["let","pos","start"],["let","done",0],["for","_",0,["+","text_len",1],["if","done",0,["if",[">=u","pos","text_len"],["set","done",1],["begin",["let","c",["view.get_u8","text","pos"]],["for","s",0,"state_count",["if",["=",["bytes.get_u8","cur","s"],0],0,["begin",["set","cur",["bytes.set_u8","cur","s",0]],["let","base",["*","s",["ext.regex._state_size"]]],["let","kind",["codec.read_u32_le","states","base"]],["if",["=","kind",["ext.regex._kind_char"]],["begin",["let","pc",["codec.read_u32_le","states",["+","base",4]]],["if",["if",["=",["&","opts",["ext.regex.opts_casei_v1"]],0],["=","pc","c"],["=",["std.text.ascii.to_lower_u8","pc"],["std.text.ascii.to_lower_u8","c"]]],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["set","next",["bytes.set_u8","next","to",1]],0],0],0],0],["if",["=","kind",["ext.regex._kind_any"]],["begin",["if",["if",["=",["&","opts",["ext.regex.opts_dotall_v1"]],0],["!=","c",10],1],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["set","next",["bytes.set_u8","next","to",1]],0],0],0],0],["if",["=","kind",["ext.regex._kind_class"]],["begin",["let","cls_off",["codec.read_u32_le","states",["+","base",4]]],["let","cls_len",["codec.read_u32_le","states",["+","base",12]]],["if",["if",["=",["&","opts",["ext.regex.opts_casei_v1"]],0],["ext.regex._class_matches","classes","cls_off","cls_len","c"],["if",["ext.regex._class_matches","classes","cls_off","cls_len","c"],1,["if",["ext.regex._class_matches","classes","cls_off","cls_len",["std.text.ascii.to_lower_u8","c"]],1,["ext.regex._class_matches","classes","cls_off","cls_len",["std.text.ascii.to_upper_u8","c"]]]]],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["set","next",["bytes.set_u8","next","to",1]],0],0],0],0],0]]],0]]],["set","pos",["+","pos",1]],["set","next",["ext.regex._eps_closure","next","states","state_count","pos","text","text_len","opts"]],["let","props",["ext.regex._set_props",["bytes.view","next"],"states","state_count"]],["if",["=",["&","props",1],1],["set","last",["-","pos","start"]],0],["if",["=",["&","props",2],0],["set","done",1],["begin",["let","tmp","cur"],["set","cur","next"],["set","next","tmp"],0]],0]]]],"last"],"kind":"defn","name":"ext.regex._match_longest_from","params":[{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"text_len","ty":"i32"},{"name":"states","ty":"bytes_view"},{"name":"classes","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"start_state","ty":"i32"},{"name":"opts","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["<","start",0],["return",["codec.write_u32_le",-1]],0],["if",[">=u","start",["+","text_len",1]],["return",["codec.write_u32_le",-1]],0],["if",["<","start_state",0],["return",["codec.write_u32_le",-1]],0],["if",[">=u","start_state","state_count"],["return",["codec.write_u32_le",-1]],0],["if",["<","match_state",0],["return",["codec.write_u32_le",-1]],0],["if",[">=u","match_state","state_count"],["return",["codec.write_u32_le",-1]],0],["let","cap_slots",["*","cap_count",2]],["let","row_len",["*","cap_count",8]],["let","work_len",["+","state_count",["*","state_count","row_len"]]],["let","cur",["bytes.alloc","work_len"]],["let","next",["bytes.alloc","work_len"]],["set","cur",["bytes.set_u8","cur","start_state",1]],["set","cur",["ext.regex._work_init_row_sentinel","cur","state_count","row_len","cap_slots","start_state"]],["set","cur",["ext.regex._eps_closure_caps","cur","states","state_count","start","text","text_len","opts","cap_slots","row_len"]],["let","best_len",-1],["let","best_caps",["bytes.alloc","row_len"]],["set","best_caps",["ext.regex._work_init_row_sentinel","best_caps",0,"row_len","cap_slots",0]],["if",["=",["bytes.get_u8","cur","match_state"],1],["begin",["set","best_len",0],["begin",["let","cur_v",["bytes.view","cur"]],["set","best_caps",["ext.regex._caps_copy_to_bytes","best_caps","cur_v","state_count","row_len","cap_slots","match_state"]],0],0],0],["let","pos","start"],["let","done",0],["let","props",0],["for","_",0,["+","text_len",1],["if","done",0,["if",[">=u","pos","text_len"],["set","done",1],["begin",["let","c",["view.get_u8","text","pos"]],["for","s",0,"state_count",["if",["=",["bytes.get_u8","cur","s"],0],0,["begin",["set","cur",["bytes.set_u8","cur","s",0]],["let","base",["*","s",["ext.regex._state_size"]]],["let","kind",["codec.read_u32_le","states","base"]],["if",["=","kind",["ext.regex._kind_char"]],["begin",["let","pc",["codec.read_u32_le","states",["+","base",4]]],["if",["if",["=",["&","opts",["ext.regex.opts_casei_v1"]],0],["=","pc","c"],["=",["std.text.ascii.to_lower_u8","pc"],["std.text.ascii.to_lower_u8","c"]]],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["begin",["if",["=",["bytes.get_u8","next","to"],0],["begin",["set","next",["bytes.set_u8","next","to",1]],["set","next",["ext.regex._caps_copy_row_between","next",["bytes.view","cur"],"state_count","row_len","cap_slots","to","s"]],0],0],0],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_any"]],["begin",["if",["if",["=",["&","opts",["ext.regex.opts_dotall_v1"]],0],["!=","c",10],1],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["begin",["if",["=",["bytes.get_u8","next","to"],0],["begin",["set","next",["bytes.set_u8","next","to",1]],["set","next",["ext.regex._caps_copy_row_between","next",["bytes.view","cur"],"state_count","row_len","cap_slots","to","s"]],0],0],0],0],0],0],0],0],["if",["=","kind",["ext.regex._kind_class"]],["begin",["let","cls_off",["codec.read_u32_le","states",["+","base",4]]],["let","cls_len",["codec.read_u32_le","states",["+","base",12]]],["if",["if",["=",["&","opts",["ext.regex.opts_casei_v1"]],0],["ext.regex._class_matches","classes","cls_off","cls_len","c"],["if",["ext.regex._class_matches","classes","cls_off","cls_len","c"],1,["if",["ext.regex._class_matches","classes","cls_off","cls_len",["std.text.ascii.to_lower_u8","c"]],1,["ext.regex._class_matches","classes","cls_off","cls_len",["std.text.ascii.to_upper_u8","c"]]]]],["begin",["let","to",["codec.read_u32_le","states",["+","base",8]]],["if",["<u","to","state_count"],["begin",["if",["=",["bytes.get_u8","next","to"],0],["begin",["set","next",["bytes.set_u8","next","to",1]],["set","next",["ext.regex._caps_copy_row_between","next",["bytes.view","cur"],"state_count","row_len","cap_slots","to","s"]],0],0],0],0],0],0],0],0],0]]],["set","pos",["+","pos",1]],["set","next",["ext.regex._eps_closure_caps","next","states","state_count","pos","text","text_len","opts","cap_slots","row_len"]],["set","props",0],["begin",["let","next_v",["bytes.view","next"]],["if",["=",["bytes.get_u8","next","match_state"],1],["begin",["let","cur_len",["-","pos","start"]],["if",[">","cur_len","best_len"],["begin",["set","best_len","cur_len"],["set","best_caps",["ext.regex._caps_copy_to_bytes","best_caps","next_v","state_count","row_len","cap_slots","match_state"]],0],0],0],0],["set","props",["ext.regex._set_props",["view.slice","next_v",0,"state_count"],"states","state_count"]],0],["if",["=",["&","props",2],0],["set","done",1],["begin",["let","tmp","cur"],["set","cur","next"],["set","next","tmp"],0]],0]]]],["let","out",["vec_u8.with_capacity",["+",4,"row_len"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","best_len"]]],["set","out",["vec_u8.extend_bytes","out","best_caps"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._match_longest_from_caps","params":[{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"text_len","ty":"i32"},{"name":"states","ty":"bytes_view"},{"name":"classes","ty":"bytes_view"},{"name":"state_count","ty":"i32"},{"name":"start_state","ty":"i32"},{"name":"match_state","ty":"i32"},{"name":"opts","ty":"i32"},{"name":"cap_count","ty":"i32"}],"result":"bytes"},{"body":32,"kind":"defn","name":"ext.regex._max_caps","params":[],"result":"i32"},{"body":4096,"kind":"defn","name":"ext.regex._max_states","params":[],"result":"i32"},{"body":["begin",["let","len_states",["+",["-","e_max","e_min"],1]],["if",[">=u",["+","state_count","len_states"],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","delta",["vec_u8.with_capacity",["*","len_states",16]]],["let","offset",["-","state_count","e_min"]],["for","s","e_min",["+","e_max",1],["begin",["let","src_off",["*","s",16]],["let","kind",["codec.read_u32_le","states","src_off"]],["let","data",["codec.read_u32_le","states",["+","src_off",4]]],["let","out1",["codec.read_u32_le","states",["+","src_off",8]]],["let","out2",["codec.read_u32_le","states",["+","src_off",12]]],["if",["=","kind",["ext.regex._kind_split"]],["begin",["if",[">=","out1",0],["set","out1",["+","out1","offset"]],0],["if",[">=","out2",0],["set","out2",["+","out2","offset"]],0],0],["if",["=","kind",["ext.regex._kind_match"]],0,["begin",["if",[">=","out1",0],["set","out1",["+","out1","offset"]],0],0]]],["set","delta",["std.u32.push_le","delta","kind"]],["set","delta",["std.u32.push_le","delta","data"]],["set","delta",["std.u32.push_le","delta","out1"]],["set","delta",["std.u32.push_le","delta","out2"]],0]],["let","new_state_count",["+","state_count","len_states"]],["let","c_start",["+","e_start","offset"]],["let","c_end",["+","e_end","offset"]],["let","c_min","state_count"],["let","c_max",["-","new_state_count",1]],["let","delta_b",["std.vec.as_bytes","delta"]],["let","delta_len",["bytes.len","delta_b"]],["let","out",["vec_u8.with_capacity",["+",25,"delta_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","c_start"]],["set","out",["std.u32.push_le","out","c_end"]],["set","out",["std.u32.push_le","out","c_min"]],["set","out",["std.u32.push_le","out","c_max"]],["set","out",["std.u32.push_le","out","delta_len"]],["set","out",["vec_u8.extend_bytes_range","out","delta_b",0,"delta_len"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_clone_fragment","params":[{"name":"states","ty":"bytes_view"},{"name":"e_start","ty":"i32"},{"name":"e_end","ty":"i32"},{"name":"e_min","ty":"i32"},{"name":"e_max","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",2],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","b_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","b_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","b_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","b_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["set","frag_top",["-","frag_top",1]],["let","a_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","a_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","a_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","a_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["let","end",["+","state_count",1]],["let","new_state_count",["+","state_count",2]],["let","patch1_off",["+",["*","a_end",16],8]],["let","patch1_val","end"],["let","patch2_off",["+",["*","b_end",16],8]],["let","patch2_val","end"],["let","new_min",["if",["<u","a_min","b_min"],"a_min","b_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"split"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"new_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"end"]],["set","frag_top",["+","frag_top",1]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],56]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out",2]],["set","out",["std.u32.push_le","out",32]],["set","out",["std.u32.push_le","out","patch1_off"]],["set","out",["std.u32.push_le","out","patch1_val"]],["set","out",["std.u32.push_le","out","patch2_off"]],["set","out",["std.u32.push_le","out","patch2_val"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_split"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out","a_start"]],["set","out",["std.u32.push_le","out","b_start"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_jmp"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",-1]],["set","out",["std.u32.push_le","out",0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_alt","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",2],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","b_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","b_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","b_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","b_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["set","frag_top",["-","frag_top",1]],["let","a_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","a_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","a_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","a_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["let","patch_off",["+",["*","a_end",16],8]],["let","patch_val","b_start"],["let","new_min",["if",["<u","a_min","b_min"],"a_min","b_min"]],["let","new_max",["if",["<u","a_max","b_max"],"b_max","a_max"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"a_start"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"b_end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"new_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"new_max"]],["set","frag_top",["+","frag_top",1]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],16]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out",1]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out","patch_off"]],["set","out",["std.u32.push_le","out","patch_val"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_concat","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","a_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","a_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","a_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","a_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["let","end",["+","state_count",1]],["let","new_state_count",["+","state_count",2]],["let","patch_off",["+",["*","a_end",16],8]],["let","patch_val","split"],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"a_start"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"a_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"end"]],["set","frag_top",["+","frag_top",1]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],48]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out",1]],["set","out",["std.u32.push_le","out",32]],["set","out",["std.u32.push_le","out","patch_off"]],["set","out",["std.u32.push_le","out","patch_val"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_split"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out","a_start"]],["set","out",["std.u32.push_le","out","end"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_jmp"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",-1]],["set","out",["std.u32.push_le","out",0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_plus","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","a_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","a_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","a_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","a_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["let","end",["+","state_count",1]],["let","new_state_count",["+","state_count",2]],["let","patch_off",["+",["*","a_end",16],8]],["let","patch_val","end"],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"split"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"a_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"end"]],["set","frag_top",["+","frag_top",1]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],48]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out",1]],["set","out",["std.u32.push_le","out",32]],["set","out",["std.u32.push_le","out","patch_off"]],["set","out",["std.u32.push_le","out","patch_val"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_split"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out","a_start"]],["set","out",["std.u32.push_le","out","end"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_jmp"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",-1]],["set","out",["std.u32.push_le","out",0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_qmark","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["if",["=","m",0],["return",["ext.regex._nfa_op_repeat_m0","states","frag_stack","frag_top","state_count","m","nval"]],0],["set","frag_top",["-","frag_top",1]],["let","e_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","e_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","e_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","e_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",["if",["!=","nval",-1],["<","nval","m"],0],["return",["ext.regex._make_err",["ext.regex.code_parse_repeat_range"],0]],0],["let","delta",["vec_u8.with_capacity",0]],["let","patches",["vec_u8.with_capacity",0]],["let","patch_count",0],["let","base_start",0],["let","base_end",0],["let","base_min",0],["let","base_max",0],["begin",["set","base_start","e_start"],["set","base_end","e_end"],["set","base_min","e_min"],["set","base_max","e_max"],["let","need",["-","m",1]],["for","k",0,"need",["begin",["let","r",["ext.regex._nfa_clone_fragment","states","e_start","e_end","e_min","e_max","state_count"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","rv",["bytes.view","r"]],["let","c_start",["codec.read_u32_le","rv",5]],["let","c_end",["codec.read_u32_le","rv",9]],["let","c_min",["codec.read_u32_le","rv",13]],["let","c_max",["codec.read_u32_le","rv",17]],["let","dlen",["codec.read_u32_le","rv",21]],["set","delta",["vec_u8.extend_bytes_range","delta","r",25,"dlen"]],["set","patches",["std.u32.push_le","patches",["+",["*","base_end",16],8]]],["set","patches",["std.u32.push_le","patches","c_start"]],["set","patch_count",["+","patch_count",1]],["set","base_end","c_end"],["set","base_max","c_max"],["set","state_count",["codec.read_u32_le","rv",1]],0]],["if",["=","nval",-1],["begin",["let","r2",["ext.regex._nfa_clone_fragment","states","e_start","e_end","e_min","e_max","state_count"]],["if",["ext.regex.is_err",["bytes.view","r2"]],["return","r2"],0],["let","rv2",["bytes.view","r2"]],["let","a_start",["codec.read_u32_le","rv2",5]],["let","a_end",["codec.read_u32_le","rv2",9]],["let","a_min",["codec.read_u32_le","rv2",13]],["let","a_max",["codec.read_u32_le","rv2",17]],["let","dlen2",["codec.read_u32_le","rv2",21]],["set","delta",["vec_u8.extend_bytes_range","delta","r2",25,"dlen2"]],["set","state_count",["codec.read_u32_le","rv2",1]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_split"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta","a_start"]],["set","state_count",["+","state_count",1]],["let","end","state_count"],["set","delta",["std.u32.push_le","delta","end"]],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_jmp"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta",-1]],["set","delta",["std.u32.push_le","delta",0]],["set","state_count",["+","state_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","a_end",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","base_end",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","base_end","end"],["set","base_max","end"],0],["begin",["let","opt_left",["-","nval","m"]],["for","k",0,"opt_left",["begin",["let","r3",["ext.regex._nfa_clone_fragment","states","e_start","e_end","e_min","e_max","state_count"]],["if",["ext.regex.is_err",["bytes.view","r3"]],["return","r3"],0],["let","rv3",["bytes.view","r3"]],["let","a_start",["codec.read_u32_le","rv3",5]],["let","a_end",["codec.read_u32_le","rv3",9]],["let","a_min",["codec.read_u32_le","rv3",13]],["let","a_max",["codec.read_u32_le","rv3",17]],["let","dlen3",["codec.read_u32_le","rv3",21]],["set","delta",["vec_u8.extend_bytes_range","delta","r3",25,"dlen3"]],["set","state_count",["codec.read_u32_le","rv3",1]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_split"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta","a_start"]],["set","state_count",["+","state_count",1]],["let","end","state_count"],["set","delta",["std.u32.push_le","delta","end"]],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_jmp"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta",-1]],["set","delta",["std.u32.push_le","delta",0]],["set","state_count",["+","state_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","a_end",16],8]]],["set","patches",["std.u32.push_le","patches","end"]],["set","patch_count",["+","patch_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","base_end",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","base_end","end"],["set","base_max","end"],0]],0]],0],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"base_start"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"base_end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"base_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"base_max"]],["set","frag_top",["+","frag_top",1]],["let","delta_len",["vec_u8.len","delta"]],["let","patches_len",["vec_u8.len","patches"]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",["+",17,"frag_len"],["*","patch_count",8]],"delta_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out","patch_count"]],["set","out",["std.u32.push_le","out","delta_len"]],["let","patches_b",["std.vec.as_bytes","patches"]],["set","out",["vec_u8.extend_bytes_range","out","patches_b",0,"patches_len"]],["let","delta_b",["std.vec.as_bytes","delta"]],["set","out",["vec_u8.extend_bytes_range","out","delta_b",0,"delta_len"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_repeat","params":[{"name":"states","ty":"bytes_view"},{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"},{"name":"m","ty":"i32"},{"name":"nval","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","e_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","e_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","e_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","e_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",["if",["!=","nval",-1],["<","nval","m"],0],["return",["ext.regex._make_err",["ext.regex.code_parse_repeat_range"],0]],0],["let","delta",["vec_u8.with_capacity",0]],["let","patches",["vec_u8.with_capacity",0]],["let","patch_count",0],["let","base_start",0],["let","base_end",0],["let","base_min",0],["let","base_max",0],["begin",["if",[">=u",["+","state_count",1],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","eps","state_count"],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_jmp"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta",-1]],["set","delta",["std.u32.push_le","delta",0]],["set","state_count",["+","state_count",1]],["set","base_start","eps"],["set","base_end","eps"],["set","base_min","eps"],["set","base_max","eps"],["if",["=","nval",0],0,["if",["=","nval",-1],["begin",["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_split"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta","e_start"]],["set","state_count",["+","state_count",1]],["let","end","state_count"],["set","delta",["std.u32.push_le","delta","end"]],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_jmp"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta",-1]],["set","delta",["std.u32.push_le","delta",0]],["set","state_count",["+","state_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","eps",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","e_end",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","base_end","end"],["set","base_min",["if",["<u","base_min","e_min"],"base_min","e_min"]],["set","base_max","end"],0],["begin",["for","k",0,"nval",["begin",["let","a_start",0],["let","a_end",0],["let","a_min",0],["let","a_max",0],["if",["=","k",0],["begin",["set","a_start","e_start"],["set","a_end","e_end"],["set","a_min","e_min"],["set","a_max","e_max"],0],["begin",["let","r",["ext.regex._nfa_clone_fragment","states","e_start","e_end","e_min","e_max","state_count"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","rv",["bytes.view","r"]],["set","state_count",["codec.read_u32_le","rv",1]],["set","a_start",["codec.read_u32_le","rv",5]],["set","a_end",["codec.read_u32_le","rv",9]],["set","a_min",["codec.read_u32_le","rv",13]],["set","a_max",["codec.read_u32_le","rv",17]],["let","dlen",["codec.read_u32_le","rv",21]],["set","delta",["vec_u8.extend_bytes_range","delta","r",25,"dlen"]],0]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_split"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta","a_start"]],["set","state_count",["+","state_count",1]],["let","end","state_count"],["set","delta",["std.u32.push_le","delta","end"]],["set","delta",["std.u32.push_le","delta",["ext.regex._kind_jmp"]]],["set","delta",["std.u32.push_le","delta",0]],["set","delta",["std.u32.push_le","delta",-1]],["set","delta",["std.u32.push_le","delta",0]],["set","state_count",["+","state_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","a_end",16],8]]],["set","patches",["std.u32.push_le","patches","end"]],["set","patch_count",["+","patch_count",1]],["set","patches",["std.u32.push_le","patches",["+",["*","base_end",16],8]]],["set","patches",["std.u32.push_le","patches","split"]],["set","patch_count",["+","patch_count",1]],["set","base_end","end"],["set","base_min",["if",["<u","base_min","a_min"],"base_min","a_min"]],["set","base_max","end"],0]],0]]]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"base_start"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"base_end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"base_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"base_max"]],["set","frag_top",["+","frag_top",1]],["let","delta_len",["vec_u8.len","delta"]],["let","patches_len",["vec_u8.len","patches"]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",["+",17,"frag_len"],["*","patch_count",8]],"delta_len"]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out","patch_count"]],["set","out",["std.u32.push_le","out","delta_len"]],["let","patches_b",["std.vec.as_bytes","patches"]],["set","out",["vec_u8.extend_bytes_range","out","patches_b",0,"patches_len"]],["let","delta_b",["std.vec.as_bytes","delta"]],["set","out",["vec_u8.extend_bytes_range","out","delta_b",0,"delta_len"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_repeat_m0","params":[{"name":"states","ty":"bytes_view"},{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"},{"name":"m","ty":"i32"},{"name":"nval","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["<","frag_top",1],["return",["ext.regex._make_err",["ext.regex.code_exec_invalid_compiled"],0]],0],["set","frag_top",["-","frag_top",1]],["let","a_start",["codec.read_u32_le",["bytes.view","frag_stack"],["*","frag_top",16]]],["let","a_end",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],4]]],["let","a_min",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],8]]],["let","a_max",["codec.read_u32_le",["bytes.view","frag_stack"],["+",["*","frag_top",16],12]]],["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","split","state_count"],["let","end",["+","state_count",1]],["let","new_state_count",["+","state_count",2]],["let","patch_off",["+",["*","a_end",16],8]],["let","patch_val","split"],["set","frag_stack",["std.u32.write_le_at","frag_stack",["*","frag_top",16],"split"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],4],"end"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],8],"a_min"]],["set","frag_stack",["std.u32.write_le_at","frag_stack",["+",["*","frag_top",16],12],"end"]],["set","frag_top",["+","frag_top",1]],["let","frag_len",["bytes.len","frag_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],48]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","frag_stack",0,"frag_len"]],["set","out",["std.u32.push_le","out",1]],["set","out",["std.u32.push_le","out",32]],["set","out",["std.u32.push_le","out","patch_off"]],["set","out",["std.u32.push_le","out","patch_val"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_split"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out","a_start"]],["set","out",["std.u32.push_le","out","end"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_jmp"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",-1]],["set","out",["std.u32.push_le","out",0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_op_star","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"state_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",[">=u",["+","state_count",2],["ext.regex._max_states"]],["return",["ext.regex._make_err",["ext.regex.code_compile_too_many_states"],0]],0],["let","start","state_count"],["let","end",["+","state_count",1]],["if",[">=u","frag_top","frag_cap"],["return",["ext.regex._make_err",["ext.regex.code_compile_stack_overflow"],0]],0],["let","fs","frag_stack"],["set","fs",["std.u32.write_le_at","fs",["*","frag_top",16],"start"]],["set","fs",["std.u32.write_le_at","fs",["+",["*","frag_top",16],4],"end"]],["set","fs",["std.u32.write_le_at","fs",["+",["*","frag_top",16],8],"start"]],["set","fs",["std.u32.write_le_at","fs",["+",["*","frag_top",16],12],"end"]],["let","frag_len",["bytes.len","fs"]],["let","new_state_count",["+","state_count",2]],["let","new_frag_top",["+","frag_top",1]],["let","out",["vec_u8.with_capacity",["+",["+",9,"frag_len"],40]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","new_state_count"]],["set","out",["std.u32.push_le","out","new_frag_top"]],["set","out",["vec_u8.extend_bytes_range","out","fs",0,"frag_len"]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",32]],["set","out",["std.u32.push_le","out","kind"]],["set","out",["std.u32.push_le","out","a"]],["set","out",["std.u32.push_le","out","end"]],["set","out",["std.u32.push_le","out","extra"]],["set","out",["std.u32.push_le","out",["ext.regex._kind_jmp"]]],["set","out",["std.u32.push_le","out",0]],["set","out",["std.u32.push_le","out",-1]],["set","out",["std.u32.push_le","out",0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._nfa_push_atom","params":[{"name":"frag_stack","ty":"bytes"},{"name":"frag_top","ty":"i32"},{"name":"frag_cap","ty":"i32"},{"name":"state_count","ty":"i32"},{"name":"kind","ty":"i32"},{"name":"a","ty":"i32"},{"name":"extra","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","cap_n",["view.len","cap_table"]],["let","out",["vec_u8.with_capacity",["+",14,"cap_n"]]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out",["if",["=","is_match",0],0,1]]],["set","out",["std.u32.push_le","out","start"]],["set","out",["std.u32.push_le","out","end"]],["set","out",["std.u32.push_le","out","cap_count"]],["set","out",["vec_u8.extend_bytes","out","cap_table"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._ok_caps","params":[{"name":"is_match","ty":"i32"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"},{"name":"cap_count","ty":"i32"},{"name":"cap_table","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","out",["vec_u8.with_capacity",10]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out",["if",["=","is_match",0],0,1]]],["set","out",["std.u32.push_le","out","start"]],["set","out",["std.u32.push_le","out","end"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._ok_match","params":[{"name":"is_match","ty":"i32"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"bytes"},{"body":17,"kind":"defn","name":"ext.regex._op_alt","params":[],"result":"i32"},{"body":16,"kind":"defn","name":"ext.regex._op_concat","params":[],"result":"i32"},{"body":32,"kind":"defn","name":"ext.regex._op_lparen","params":[],"result":"i32"},{"body":19,"kind":"defn","name":"ext.regex._op_plus","params":[],"result":"i32"},{"body":["begin",["if",["=","op",["ext.regex._op_alt"]],["return",1],0],["if",["=","op",["ext.regex._op_concat"]],["return",2],0],0],"kind":"defn","name":"ext.regex._op_prec","params":[{"name":"op","ty":"i32"}],"result":"i32"},{"body":20,"kind":"defn","name":"ext.regex._op_qmark","params":[],"result":"i32"},{"body":21,"kind":"defn","name":"ext.regex._op_repeat","params":[],"result":"i32"},{"body":18,"kind":"defn","name":"ext.regex._op_star","params":[],"result":"i32"},{"body":["begin",["let","i",["+","class_pat_pos",1]],["let","neg",0],["if",["<u","i","n"],["if",["=",["view.get_u8","pat","i"],94],["begin",["set","neg",1],["set","i",["+","i",1]],0],0],0],["let","cls",["vec_u8.with_capacity",64]],["set","cls",["vec_u8.push","cls","neg"]],["set","cls",["std.u32.push_le","cls",0]],["let","count",0],["let","has_pending",0],["let","pending",0],["let","first",1],["let","closed",0],["let","done",0],["for","_",0,["+","n",1],["if","done",0,["if",[">=u","i","n"],["set","done",1],["begin",["let","ch",["view.get_u8","pat","i"]],["if",["if",["=","ch",93],["=","first",0],0],["begin",["set","closed",1],["set","i",["+","i",1]],["set","done",1],0],["begin",["set","first",0],["if",["=","ch",92],["begin",["if",["<u",["+","i",1],"n"],0,["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_escape"],"i"]]],["let","esc",["view.get_u8","pat",["+","i",1]]],["set","i",["+","i",2]],["if",["if",["if",["if",["if",["if",["=","esc",100],1,["=","esc",68]],1,["=","esc",119]],1,["=","esc",87]],1,["=","esc",115]],1,["=","esc",83]],["begin",["if",["=","has_pending",1],["begin",["set","cls",["vec_u8.push","cls","pending"]],["set","cls",["vec_u8.push","cls","pending"]],["set","count",["+","count",1]],["set","has_pending",0],0],0],["if",["=","esc",100],["begin",["set","cls",["vec_u8.push","cls",48]],["set","cls",["vec_u8.push","cls",57]],["set","count",["+","count",1]],0],["if",["=","esc",68],["begin",["set","cls",["vec_u8.push","cls",0]],["set","cls",["vec_u8.push","cls",47]],["set","cls",["vec_u8.push","cls",58]],["set","cls",["vec_u8.push","cls",255]],["set","count",["+","count",2]],0],["if",["=","esc",119],["begin",["set","cls",["vec_u8.push","cls",48]],["set","cls",["vec_u8.push","cls",57]],["set","cls",["vec_u8.push","cls",65]],["set","cls",["vec_u8.push","cls",90]],["set","cls",["vec_u8.push","cls",95]],["set","cls",["vec_u8.push","cls",95]],["set","cls",["vec_u8.push","cls",97]],["set","cls",["vec_u8.push","cls",122]],["set","count",["+","count",4]],0],["if",["=","esc",87],["begin",["set","cls",["vec_u8.push","cls",0]],["set","cls",["vec_u8.push","cls",47]],["set","cls",["vec_u8.push","cls",58]],["set","cls",["vec_u8.push","cls",64]],["set","cls",["vec_u8.push","cls",91]],["set","cls",["vec_u8.push","cls",94]],["set","cls",["vec_u8.push","cls",96]],["set","cls",["vec_u8.push","cls",96]],["set","cls",["vec_u8.push","cls",123]],["set","cls",["vec_u8.push","cls",255]],["set","count",["+","count",5]],0],["if",["=","esc",115],["begin",["set","cls",["vec_u8.push","cls",9]],["set","cls",["vec_u8.push","cls",13]],["set","cls",["vec_u8.push","cls",32]],["set","cls",["vec_u8.push","cls",32]],["set","count",["+","count",2]],0],["begin",["set","cls",["vec_u8.push","cls",0]],["set","cls",["vec_u8.push","cls",8]],["set","cls",["vec_u8.push","cls",14]],["set","cls",["vec_u8.push","cls",31]],["set","cls",["vec_u8.push","cls",33]],["set","cls",["vec_u8.push","cls",255]],["set","count",["+","count",3]],0]]]]]],0],["begin",["let","lit",["ext.regex._escape_to_byte","esc"]],["if",["=","has_pending",0],["begin",["set","pending","lit"],["set","has_pending",1],0],["begin",["set","cls",["vec_u8.push","cls","pending"]],["set","cls",["vec_u8.push","cls","pending"]],["set","count",["+","count",1]],["set","pending","lit"],["set","has_pending",1],0]],0]],0],["begin",["set","i",["+","i",1]],["if",["if",["=","ch",45],["=","has_pending",1],0],["begin",["if",["<u","i","n"],["if",["!=",["view.get_u8","pat","i"],93],["begin",["let","end_lit",0],["let","consumed",1],["if",["=",["view.get_u8","pat","i"],92],["begin",["if",["<u",["+","i",1],"n"],0,["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_escape"],"i"]]],["let","esc2",["view.get_u8","pat",["+","i",1]]],["if",["if",["if",["if",["if",["if",["=","esc2",100],1,["=","esc2",68]],1,["=","esc2",119]],1,["=","esc2",87]],1,["=","esc2",115]],1,["=","esc2",83]],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_class"],"i"]],["begin",["set","end_lit",["ext.regex._escape_to_byte","esc2"]],["set","consumed",2],0]],0],["begin",["set","end_lit",["view.get_u8","pat","i"]],["set","consumed",1],0]],["if",["<u","end_lit","pending"],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_class"],"i"]],0],["set","cls",["vec_u8.push","cls","pending"]],["set","cls",["vec_u8.push","cls","end_lit"]],["set","count",["+","count",1]],["set","has_pending",0],["set","i",["+","i","consumed"]],0],0],0],0],0],["begin",["if",["=","has_pending",0],["begin",["set","pending","ch"],["set","has_pending",1],0],["begin",["set","cls",["vec_u8.push","cls","pending"]],["set","cls",["vec_u8.push","cls","pending"]],["set","count",["+","count",1]],["set","pending","ch"],["set","has_pending",1],0]],0]]]]]]]]],["if",["=","closed",0],["return",["ext.regex._make_err",["ext.regex.code_parse_unclosed_class"],"class_pat_pos"]],0],["if",["=","has_pending",1],["begin",["set","cls",["vec_u8.push","cls","pending"]],["set","cls",["vec_u8.push","cls","pending"]],["set","count",["+","count",1]],0],0],["set","cls",["std.u32.write_le_at_vec_u8","cls",1,"count"]],["let","cls_b",["vec_u8.into_bytes","cls"]],["let","res",["vec_u8.with_capacity",["+",5,["bytes.len","cls_b"]]]],["set","res",["vec_u8.push","res",1]],["set","res",["std.u32.push_le","res","i"]],["set","res",["vec_u8.extend_bytes","res","cls_b"]],["vec_u8.into_bytes","res"]],"kind":"defn","name":"ext.regex._parse_class_bytes","params":[{"name":"pat","ty":"bytes_view"},{"name":"class_pat_pos","ty":"i32"},{"name":"n","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","is_anchor",0],["if",[">=u",["+","i",1],"n"],["set","is_anchor",1],["begin",["let","nx",["view.get_u8","pat",["+","i",1]]],["if",["if",["=","nx",41],1,["=","nx",124]],["set","is_anchor",1],0],0]],["let","out",["vec_u8.with_capacity",8]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out",["+","i",1]]],["if",["=","is_anchor",1],["set","out",["vec_u8.push","out",["ext.regex._tok_eol"]]],["begin",["set","out",["vec_u8.push","out",["ext.regex._tok_lit"]]],["set","out",["vec_u8.push","out",36]],0]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._parse_dollar_emit","params":[{"name":"pat","ty":"bytes_view"},{"name":"i","ty":"i32"},{"name":"n","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","d_off",["codec.read_u32_le","built",1]],["let","d_len",["codec.read_u32_le","built",5]],["let","D_off",["codec.read_u32_le","built",9]],["let","D_len",["codec.read_u32_le","built",13]],["let","w_off",["codec.read_u32_le","built",17]],["let","w_len",["codec.read_u32_le","built",21]],["let","W_off",["codec.read_u32_le","built",25]],["let","W_len",["codec.read_u32_le","built",29]],["let","s_off",["codec.read_u32_le","built",33]],["let","s_len",["codec.read_u32_le","built",37]],["let","S_off",["codec.read_u32_le","built",41]],["let","S_len",["codec.read_u32_le","built",45]],["if",["<u",["+","i",1],"n"],0,["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_escape"],"i"]]],["let","esc",["view.get_u8","pat",["+","i",1]]],["let","is_class",["if",["if",["if",["if",["if",["if",["=","esc",100],1,["=","esc",68]],1,["=","esc",119]],1,["=","esc",87]],1,["=","esc",115]],1,["=","esc",83]],1,0]],["if",["=","is_class",1],["begin",["let","cls_off",0],["let","cls_len",0],["if",["=","esc",100],["begin",["set","cls_off","d_off"],["set","cls_len","d_len"],0],["if",["=","esc",68],["begin",["set","cls_off","D_off"],["set","cls_len","D_len"],0],["if",["=","esc",119],["begin",["set","cls_off","w_off"],["set","cls_len","w_len"],0],["if",["=","esc",87],["begin",["set","cls_off","W_off"],["set","cls_len","W_len"],0],["if",["=","esc",115],["begin",["set","cls_off","s_off"],["set","cls_len","s_len"],0],["begin",["set","cls_off","S_off"],["set","cls_len","S_len"],0]]]]]],["let","out",["vec_u8.with_capacity",14]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out",["+","i",2]]],["set","out",["vec_u8.push","out",["ext.regex._tok_class"]]],["set","out",["std.u32.push_le","out","cls_off"]],["set","out",["std.u32.push_le","out","cls_len"]],["std.vec.as_bytes","out"]],["begin",["if",["=",["if",["ext.regex._is_meta_u8","esc"],1,["if",["=","esc",92],1,["if",["=","esc",110],1,["if",["=","esc",114],1,["=","esc",116]]]]],1],0,["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_escape"],"i"]]],["let","lit",["ext.regex._escape_to_byte","esc"]],["let","out",["vec_u8.with_capacity",7]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out",["+","i",2]]],["set","out",["vec_u8.push","out",["ext.regex._tok_lit"]]],["set","out",["vec_u8.push","out","lit"]],["std.vec.as_bytes","out"]]]],"kind":"defn","name":"ext.regex._parse_escape_emit","params":[{"name":"pat","ty":"bytes_view"},{"name":"i","ty":"i32"},{"name":"n","ty":"i32"},{"name":"built","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","n",["view.len","pat"]],["let","built",["ext.regex._builtin_classes"]],["let","built_v",["bytes.view","built"]],["let","built_len",["view.len","built_v"]],["let","classes_len",["-","built_len",49]],["let","classes_init",["bytes.slice","built",49,"classes_len"]],["let","classes",["vec_u8.with_capacity",["+","classes_len",128]]],["set","classes",["vec_u8.extend_bytes_range","classes","classes_init",0,"classes_len"]],["let","stack_len",["+","n",8]],["let","shunt_push_out_off",["+",4,"stack_len"]],["let","shunt_pop_out_off",["+",8,"stack_len"]],["let","op_stack",["bytes.alloc","stack_len"]],["let","op_top",0],["let","post",["vec_u8.with_capacity",["+",["*","n",3],16]]],["begin",["let","scan",["ext.regex._parse_post_scan","pat","n","built_v","stack_len","shunt_push_out_off","shunt_pop_out_off","classes","op_stack","op_top","post"]],["if",["ext.regex.is_err",["bytes.view","scan"]],["return","scan"],0],["let","scan_v",["bytes.view","scan"]],["set","op_top",["codec.read_u32_le","scan_v",1]],["let","cap_count",["codec.read_u32_le","scan_v",5]],["let","scan_classes_n",["codec.read_u32_le","scan_v",9]],["let","scan_post_n",["codec.read_u32_le","scan_v",13]],["set","op_stack",["bytes.slice","scan",17,"stack_len"]],["let","classes_off",["+","stack_len",17]],["let","classes_b",["bytes.slice","scan","classes_off","scan_classes_n"]],["let","post_off",["+","classes_off","scan_classes_n"]],["let","post_b0",["bytes.slice","scan","post_off","scan_post_n"]],["set","post",["vec_u8.with_capacity",["+","scan_post_n","op_top"]]],["set","post",["vec_u8.extend_bytes_range","post","post_b0",0,"scan_post_n"]],["for","_",0,["+","n",1],["if",["=","op_top",0],0,["begin",["set","op_top",["-","op_top",1]],["let","op",["bytes.get_u8","op_stack","op_top"]],["if",["=","op",["ext.regex._op_lparen"]],["return",["ext.regex._make_err",["ext.regex.code_parse_unbalanced_paren"],"n"]],0],["set","post",["vec_u8.push","post","op"]],0]]],["let","post_b",["vec_u8.into_bytes","post"]],["begin",["let","classes_n",["bytes.len","classes_b"]],["let","post_n",["bytes.len","post_b"]],["let","out",["vec_u8.with_capacity",["+",13,["+","classes_n","post_n"]]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","classes_n"]],["set","out",["std.u32.push_le","out","post_n"]],["set","out",["std.u32.push_le","out","cap_count"]],["set","out",["vec_u8.extend_bytes","out","classes_b"]],["set","out",["vec_u8.extend_bytes","out","post_b"]],["vec_u8.into_bytes","out"]]]],"kind":"defn","name":"ext.regex._parse_post","params":[{"name":"pat","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","prev",0],["let","i",0],["let","done",0],["let","next_i",0],["let","emit_len",0],["let","cap_stack",["bytes.alloc",["*","stack_len",4]]],["let","cap_top",0],["let","cap_count",0],["for","_",0,["+","n",1],["if","done",0,["if",[">=u","i","n"],["set","done",1],["begin",["let","c",["view.get_u8","pat","i"]],["if",["=","c",40],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["set","op_stack",["bytes.set_u8","op_stack","op_top",["ext.regex._op_lparen"]]],["set","op_top",["+","op_top",1]],["let","r",["ext.regex._parse_post_scan_lparen","pat","i","n","cap_stack","cap_top","cap_count"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","r_v",["bytes.view","r"]],["set","next_i",["codec.read_u32_le","r_v",1]],["set","emit_len",["codec.read_u32_le","r_v",5]],["set","cap_top",["codec.read_u32_le","r_v",9]],["set","cap_count",["codec.read_u32_le","r_v",13]],["set","cap_stack",["bytes.slice","r",17,["*","stack_len",4]]],["if",["=","emit_len",1],["begin",["set","post",["vec_u8.extend_bytes_range","post","r",["+",17,["*","stack_len",4]],["-",["bytes.len","r"],["+",17,["*","stack_len",4]]]]],0],0],["set","i","next_i"],["set","prev","emit_len"],0],0],["if",["=","c",41],["begin",["let","r2",["ext.regex._parse_post_scan_rparen_capture","i","prev",["bytes.view","cap_stack"],"cap_top","op_stack","op_top","stack_len","shunt_push_out_off"]],["if",["ext.regex.is_err",["bytes.view","r2"]],["return","r2"],0],["let","r2_v",["bytes.view","r2"]],["set","op_top",["codec.read_u32_le","r2_v",1]],["set","cap_top",["codec.read_u32_le","r2_v",5]],["set","op_stack",["bytes.slice","r2",9,"stack_len"]],["set","post",["vec_u8.extend_bytes_range","post","r2",["+",9,"stack_len"],["-",["bytes.len","r2"],["+",9,"stack_len"]]]],["let","r",["ext.regex._shunt_pop_until_lparen","op_stack","op_top"]],["begin",["let","r_v",["bytes.view","r"]],["set","op_top",["codec.read_u32_le","r_v",4]],["if",["=",["codec.read_u32_le","r_v",0],0],["return",["ext.regex._make_err",["ext.regex.code_parse_unbalanced_paren"],"i"]],0],0],["set","op_stack",["bytes.slice","r",8,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_pop_out_off"]],["set","i",["+","i",1]],["set","prev",1],0],0],["if",["=","c",124],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_alt"],1]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],["set","i",["+","i",1]],["set","prev",0],0],0],["if",["=","c",42],["begin",["if",["=","prev",0],["return",["ext.regex._make_err",["ext.regex.code_parse_nothing_to_repeat"],"i"]],0],["set","post",["vec_u8.push","post",["ext.regex._op_star"]]],["set","i",["+","i",1]],0],0],["if",["=","c",43],["begin",["if",["=","prev",0],["return",["ext.regex._make_err",["ext.regex.code_parse_nothing_to_repeat"],"i"]],0],["set","post",["vec_u8.push","post",["ext.regex._op_plus"]]],["set","i",["+","i",1]],0],0],["if",["=","c",63],["begin",["if",["=","prev",0],["return",["ext.regex._make_err",["ext.regex.code_parse_nothing_to_repeat"],"i"]],0],["set","post",["vec_u8.push","post",["ext.regex._op_qmark"]]],["set","i",["+","i",1]],0],0],["if",["=","c",123],["begin",["if",["=","prev",0],["return",["ext.regex._make_err",["ext.regex.code_parse_nothing_to_repeat"],"i"]],0],["let","r",["ext.regex._parse_repeat_spec","pat","i","n"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","r_v",["bytes.view","r"]],["set","next_i",["codec.read_u32_le","r_v",1]],["let","m",["codec.read_u32_le","r_v",5]],["let","nval",["codec.read_u32_le","r_v",9]],["set","post",["vec_u8.push","post",["ext.regex._op_repeat"]]],["set","post",["std.u32.push_le","post","m"]],["set","post",["std.u32.push_le","post","nval"]],["set","i","next_i"],0],0],["if",["=","c",91],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["let","r",["ext.regex._parse_class_bytes","pat","i","n"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","r2_v",["bytes.view","r"]],["set","next_i",["codec.read_u32_le","r2_v",1]],["let","cls_off",["vec_u8.len","classes"]],["let","cls_len",["-",["view.len","r2_v"],5]],["set","classes",["vec_u8.extend_bytes_range","classes","r",5,"cls_len"]],["set","post",["vec_u8.push","post",["ext.regex._tok_class"]]],["set","post",["std.u32.push_le","post","cls_off"]],["set","post",["std.u32.push_le","post","cls_len"]],["set","i","next_i"],["set","prev",1],0],0],["if",["=","c",46],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["set","post",["vec_u8.push","post",["ext.regex._tok_any"]]],["set","i",["+","i",1]],["set","prev",1],0],0],["if",["=","c",94],["begin",["if",["=","prev",0],["begin",["set","post",["vec_u8.push","post",["ext.regex._tok_bol"]]],["set","i",["+","i",1]],["set","prev",1],0],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0]],0],0],["if",["=","c",36],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["let","r",["ext.regex._parse_dollar_emit","pat","i","n"]],["let","r2_v",["bytes.view","r"]],["set","next_i",["codec.read_u32_le","r2_v",1]],["set","emit_len",["-",["view.len","r2_v"],5]],["set","post",["vec_u8.extend_bytes_range","post","r",5,"emit_len"]],["set","i","next_i"],["set","prev",1],0],0],["if",["=","c",92],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["let","r",["ext.regex._parse_escape_emit","pat","i","n","built_v"]],["if",["ext.regex.is_err",["bytes.view","r"]],["return","r"],0],["let","r2_v",["bytes.view","r"]],["set","next_i",["codec.read_u32_le","r2_v",1]],["set","emit_len",["-",["view.len","r2_v"],5]],["set","post",["vec_u8.extend_bytes_range","post","r",5,"emit_len"]],["set","i","next_i"],["set","prev",1],0],0],["if",["ext.regex._is_meta_u8","c"],0,["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","post",["ext.regex._post_extend_from_off","post","r","shunt_push_out_off"]],0],0],["set","post",["ext.regex._post_push_lit","post","c"]],["set","i",["+","i",1]],["set","prev",1],0]],0]]]],["ext.regex._parse_post_scan_pack","op_stack","op_top","cap_count","classes","post"]],"kind":"defn","name":"ext.regex._parse_post_scan","params":[{"name":"pat","ty":"bytes_view"},{"name":"n","ty":"i32"},{"name":"built_v","ty":"bytes_view"},{"name":"stack_len","ty":"i32"},{"name":"shunt_push_out_off","ty":"i32"},{"name":"shunt_pop_out_off","ty":"i32"},{"name":"classes","ty":"vec_u8"},{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"},{"name":"post","ty":"vec_u8"}],"result":"bytes"},{"body":["begin",["let","next_i",["+","i",1]],["let","is_capture",1],["if",["<u",["+","next_i",1],"n"],["if",["if",["=",["view.get_u8","pat","next_i"],63],["=",["view.get_u8","pat",["+","next_i",1]],58],0],["begin",["set","is_capture",0],["set","next_i",["+","next_i",2]],0],0],0],["let","cap_id",0],["if",["=","is_capture",1],["begin",["set","cap_count",["+","cap_count",1]],["if",[">","cap_count",["ext.regex._max_caps"]],["return",["ext.regex._make_err",["ext.regex.code_parse_too_many_captures"],"i"]],0],["set","cap_id","cap_count"],0],0],["set","cap_stack",["std.u32.write_le_at","cap_stack",["*","cap_top",4],"cap_id"]],["set","cap_top",["+","cap_top",1]],["let","cap_stack_n",["bytes.len","cap_stack"]],["let","out",["vec_u8.with_capacity",["+",["+",17,"cap_stack_n"],["*","is_capture",5]]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","next_i"]],["set","out",["std.u32.push_le","out","is_capture"]],["set","out",["std.u32.push_le","out","cap_top"]],["set","out",["std.u32.push_le","out","cap_count"]],["set","out",["vec_u8.extend_bytes","out","cap_stack"]],["if",["=","is_capture",1],["begin",["set","out",["vec_u8.push","out",["ext.regex._tok_save"]]],["set","out",["std.u32.push_le","out",["*",["-","cap_id",1],2]]],0],0],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._parse_post_scan_lparen","params":[{"name":"pat","ty":"bytes_view"},{"name":"i","ty":"i32"},{"name":"n","ty":"i32"},{"name":"cap_stack","ty":"bytes"},{"name":"cap_top","ty":"i32"},{"name":"cap_count","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","post_b",["vec_u8.into_bytes","post"]],["let","classes_b",["std.vec.as_bytes","classes"]],["let","classes_n",["bytes.len","classes_b"]],["let","post_n",["bytes.len","post_b"]],["let","stack_n",["bytes.len","op_stack"]],["let","out",["vec_u8.with_capacity",["+",17,["+","stack_n",["+","classes_n","post_n"]]]]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","op_top"]],["set","out",["std.u32.push_le","out","cap_count"]],["set","out",["std.u32.push_le","out","classes_n"]],["set","out",["std.u32.push_le","out","post_n"]],["set","out",["vec_u8.extend_bytes","out","op_stack"]],["set","out",["vec_u8.extend_bytes","out","classes_b"]],["set","out",["vec_u8.extend_bytes","out","post_b"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.regex._parse_post_scan_pack","params":[{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"},{"name":"cap_count","ty":"i32"},{"name":"classes","ty":"vec_u8"},{"name":"post","ty":"vec_u8"}],"result":"bytes"},{"body":["begin",["if",["=","cap_top",0],["return",["ext.regex._make_err",["ext.regex.code_parse_unbalanced_paren"],"i"]],0],["set","cap_top",["-","cap_top",1]],["let","cap_id",["std.u32.read_le_at","cap_stack",["*","cap_top",4]]],["let","delta",["vec_u8.with_capacity",16]],["if",[">","cap_id",0],["begin",["if",["=","prev",1],["begin",["let","r",["ext.regex._shunt_push_op","op_stack","op_top",["ext.regex._op_concat"],2]],["set","op_top",["codec.read_u32_le",["bytes.view","r"],0]],["set","op_stack",["bytes.slice","r",4,"stack_len"]],["set","delta",["ext.regex._post_extend_from_off","delta","r","shunt_push_out_off"]],0],0],["set","delta",["vec_u8.push","delta",["ext.regex._tok_save"]]],["set","delta",["std.u32.push_le","delta",["+",["*",["-","cap_id",1],2],1]]],0],0],["let","delta_b",["vec_u8.into_bytes","delta"]],["let","delta_n",["bytes.len","delta_b"]],["let","res",["vec_u8.with_capacity",["+",["+",9,"stack_len"],"delta_n"]]],["set","res",["vec_u8.push","res",1]],["set","res",["std.u32.push_le","res","op_top"]],["set","res",["std.u32.push_le","res","cap_top"]],["set","res",["vec_u8.extend_bytes","res","op_stack"]],["set","res",["vec_u8.extend_bytes","res","delta_b"]],["vec_u8.into_bytes","res"]],"kind":"defn","name":"ext.regex._parse_post_scan_rparen_capture","params":[{"name":"i","ty":"i32"},{"name":"prev","ty":"i32"},{"name":"cap_stack","ty":"bytes_view"},{"name":"cap_top","ty":"i32"},{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"},{"name":"stack_len","ty":"i32"},{"name":"shunt_push_out_off","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","m",0],["let","k",0],["set","i",["+","i",1]],["let","got_m",0],["let","scan_done",0],["for","_",0,["+","n",1],["if","scan_done",0,["if",[">=u","i","n"],["set","scan_done",1],["begin",["let","dch",["view.get_u8","pat","i"]],["if",["ext.regex._is_digit_u8","dch"],["begin",["set","m",["+",["*","m",10],["-","dch",48]]],["set","got_m",1],["set","i",["+","i",1]],0],["set","scan_done",1]],0]]]],["if",["=","got_m",0],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],["-","i",1]]],0],["if",[">=u","i","n"],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],["-","i",1]]],0],["let","nval",0],["let","ch2",["view.get_u8","pat","i"]],["if",["=","ch2",125],["begin",["set","nval","m"],["set","i",["+","i",1]],0],["if",["=","ch2",44],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],["-","i",1]]],0],["if",["=",["view.get_u8","pat","i"],125],["begin",["set","nval",-1],["set","i",["+","i",1]],0],["begin",["set","nval",0],["let","got_n",0],["let","scan_done2",0],["for","_",0,["+","n",1],["if","scan_done2",0,["if",[">=u","i","n"],["set","scan_done2",1],["begin",["let","dch2",["view.get_u8","pat","i"]],["if",["ext.regex._is_digit_u8","dch2"],["begin",["set","nval",["+",["*","nval",10],["-","dch2",48]]],["set","got_n",1],["set","i",["+","i",1]],0],["set","scan_done2",1]],0]]]],["if",["=","got_n",0],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],["-","i",1]]],0],["if",[">=u","i","n"],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],["-","i",1]]],0],["if",["!=",["view.get_u8","pat","i"],125],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],"i"]],0],["set","i",["+","i",1]],0]],0],["return",["ext.regex._make_err",["ext.regex.code_parse_invalid_repeat"],"i"]]]],["if",["if",["!=","nval",-1],["<","nval","m"],0],["return",["ext.regex._make_err",["ext.regex.code_parse_repeat_range"],["-","i",1]]],0],["let","out",["vec_u8.with_capacity",13]],["set","out",["vec_u8.push","out",1]],["set","out",["std.u32.push_le","out","i"]],["set","out",["std.u32.push_le","out","m"]],["set","out",["std.u32.push_le","out","nval"]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex._parse_repeat_spec","params":[{"name":"pat","ty":"bytes_view"},{"name":"i","ty":"i32"},{"name":"n","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","src_len",["bytes.len","src"]],["let","out_len",["-","src_len","off"]],["vec_u8.extend_bytes_range","post","src","off","out_len"]],"kind":"defn","name":"ext.regex._post_extend_from_off","params":[{"name":"post","ty":"vec_u8"},{"name":"src","ty":"bytes"},{"name":"off","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["set","post",["vec_u8.push","post",["ext.regex._tok_lit"]]],["vec_u8.push","post","c"]],"kind":"defn","name":"ext.regex._post_push_lit","params":[{"name":"post","ty":"vec_u8"},{"name":"c","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","any",0],["let","is_match",0],["for","s",0,"state_count",["begin",["if",["=",["bytes.get_u8","flags","s"],0],0,["begin",["set","any",1],["let","kind",["codec.read_u32_le","states",["*","s",["ext.regex._state_size"]]]],["if",["=","kind",["ext.regex._kind_match"]],["set","is_match",1],0],0]],0]],["+",["*","any",2],"is_match"]],"kind":"defn","name":"ext.regex._set_props","params":[{"name":"flags","ty":"bytes_view"},{"name":"states","ty":"bytes_view"},{"name":"state_count","ty":"i32"}],"result":"i32"},{"body":["begin",["let","stack_len",["bytes.len","op_stack"]],["let","out",["vec_u8.with_capacity","op_top"]],["let","ok",1],["let","pop_done",0],["for","_",0,["+","stack_len",1],["if","pop_done",0,["if",["=","op_top",0],["set","pop_done",1],["begin",["set","op_top",["-","op_top",1]],["let","op",["bytes.get_u8","op_stack","op_top"]],["if",["=","op",["ext.regex._op_lparen"]],["set","ok",0],["set","out",["vec_u8.push","out","op"]]],0]]]],["let","out_b",["vec_u8.into_bytes","out"]],["let","res",["vec_u8.with_capacity",["+",["+",8,"stack_len"],["bytes.len","out_b"]]]],["set","res",["vec_u8.extend_bytes","res",["codec.write_u32_le","ok"]]],["set","res",["vec_u8.extend_bytes","res",["codec.write_u32_le","op_top"]]],["set","res",["vec_u8.extend_bytes","res","op_stack"]],["set","res",["vec_u8.extend_bytes","res","out_b"]],["vec_u8.into_bytes","res"]],"kind":"defn","name":"ext.regex._shunt_drain_all","params":[{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","stack_len",["bytes.len","op_stack"]],["let","out",["vec_u8.with_capacity","op_top"]],["let","found",0],["let","pop_done",0],["for","_",0,["+","stack_len",1],["if","pop_done",0,["if",["=","op_top",0],["set","pop_done",1],["begin",["set","op_top",["-","op_top",1]],["let","op",["bytes.get_u8","op_stack","op_top"]],["if",["=","op",["ext.regex._op_lparen"]],["begin",["set","found",1],["set","pop_done",1],0],["set","out",["vec_u8.push","out","op"]]],0]]]],["let","out_b",["vec_u8.into_bytes","out"]],["let","res",["vec_u8.with_capacity",["+",["+",8,"stack_len"],["bytes.len","out_b"]]]],["set","res",["vec_u8.extend_bytes","res",["codec.write_u32_le","found"]]],["set","res",["vec_u8.extend_bytes","res",["codec.write_u32_le","op_top"]]],["set","res",["vec_u8.extend_bytes","res","op_stack"]],["set","res",["vec_u8.extend_bytes","res","out_b"]],["vec_u8.into_bytes","res"]],"kind":"defn","name":"ext.regex._shunt_pop_until_lparen","params":[{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","stack_len",["bytes.len","op_stack"]],["let","out",["vec_u8.with_capacity","op_top"]],["let","pop_done",0],["for","_",0,["+","stack_len",1],["if","pop_done",0,["if",["=","op_top",0],["set","pop_done",1],["begin",["let","op",["bytes.get_u8","op_stack",["-","op_top",1]]],["if",["=","op",["ext.regex._op_lparen"]],["set","pop_done",1],["if",["<",["ext.regex._op_prec","op"],"new_prec"],["set","pop_done",1],["begin",["set","op_top",["-","op_top",1]],["set","out",["vec_u8.push","out","op"]],0]]],0]]]],["set","op_stack",["bytes.set_u8","op_stack","op_top","new_op"]],["set","op_top",["+","op_top",1]],["let","out_b",["vec_u8.into_bytes","out"]],["let","res",["vec_u8.with_capacity",["+",["+",4,"stack_len"],["bytes.len","out_b"]]]],["set","res",["vec_u8.extend_bytes","res",["codec.write_u32_le","op_top"]]],["set","res",["vec_u8.extend_bytes","res","op_stack"]],["set","res",["vec_u8.extend_bytes","res","out_b"]],["vec_u8.into_bytes","res"]],"kind":"defn","name":"ext.regex._shunt_push_op","params":[{"name":"op_stack","ty":"bytes"},{"name":"op_top","ty":"i32"},{"name":"new_op","ty":"i32"},{"name":"new_prec","ty":"i32"}],"result":"bytes"},{"body":16,"kind":"defn","name":"ext.regex._state_size","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"ext.regex._tok_any","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"ext.regex._tok_bol","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"ext.regex._tok_class","params":[],"result":"i32"},{"body":5,"kind":"defn","name":"ext.regex._tok_eol","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"ext.regex._tok_lit","params":[],"result":"i32"},{"body":6,"kind":"defn","name":"ext.regex._tok_save","params":[],"result":"i32"},{"body":["begin",["let","base",["+","state_count",["*","state","row_len"]]],["for","slot",0,"cap_slots",["begin",["set","work",["std.u32.write_le_at","work",["+","base",["*","slot",4]],-1]],0]],"work"],"kind":"defn","name":"ext.regex._work_init_row_sentinel","params":[{"name":"work","ty":"bytes"},{"name":"state_count","ty":"i32"},{"name":"row_len","ty":"i32"},{"name":"cap_slots","ty":"i32"},{"name":"state","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","cap_n",["ext.regex.caps_count_v1","doc"]],["if",["<=","cap_i",0],["return",-1],0],["if",[">=u",["+","cap_i",0],["+","cap_n",1]],["return",-1],0],["let","off",["+",18,["*",["-","cap_i",1],8]]],["if",[">u",["+","off",4],["view.len","doc"]],["return",-1],0],["let","v",["codec.read_u32_le","doc","off"]],["if",["=","v",-1],-1,"v"]],"kind":"defn","name":"ext.regex.cap_end_v1","params":[{"name":"doc","ty":"bytes_view"},{"name":"cap_i","ty":"i32"}],"result":"i32"},{"body":["begin",["let","s",["ext.regex.cap_start_v1","doc","cap_i"]],["let","e",["ext.regex.cap_end_v1","doc","cap_i"]],["if",["=","s",-1],["return",-1],0],["if",["=","e",-1],["return",-1],0],["if",["<u","e","s"],-1,["-","e","s"]]],"kind":"defn","name":"ext.regex.cap_len_v1","params":[{"name":"doc","ty":"bytes_view"},{"name":"cap_i","ty":"i32"}],"result":"i32"},{"body":["begin",["let","cap_n",["ext.regex.caps_count_v1","doc"]],["if",["<=","cap_i",0],["return",-1],0],["if",[">=u",["+","cap_i",0],["+","cap_n",1]],["return",-1],0],["let","off",["+",14,["*",["-","cap_i",1],8]]],["if",[">u",["+","off",4],["view.len","doc"]],["return",-1],0],["let","v",["codec.read_u32_le","doc","off"]],["if",["=","v",-1],-1,"v"]],"kind":"defn","name":"ext.regex.cap_start_v1","params":[{"name":"doc","ty":"bytes_view"},{"name":"cap_i","ty":"i32"}],"result":"i32"},{"body":["begin",["let","s",["ext.regex.cap_start_v1","doc","cap_i"]],["let","e",["ext.regex.cap_end_v1","doc","cap_i"]],["if",["=","s",-1],["return",["view.slice","text",0,0]],0],["if",["=","e",-1],["return",["view.slice","text",0,0]],0],["if",["<u","e","s"],["return",["view.slice","text",0,0]],0],["view.slice","text","s",["-","e","s"]]],"kind":"defn","name":"ext.regex.cap_view_v1","params":[{"name":"text","ty":"bytes_view"},{"name":"doc","ty":"bytes_view"},{"name":"cap_i","ty":"i32"}],"result":"bytes_view"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",0],0],["if",["!=",["view.get_u8","doc",0],1],["return",0],0],["if",["<",["view.len","doc"],14],["return",0],0],["codec.read_u32_le","doc",10]],"kind":"defn","name":"ext.regex.caps_count_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":8,"kind":"defn","name":"ext.regex.code_compile_stack_overflow","params":[],"result":"i32"},{"body":9,"kind":"defn","name":"ext.regex.code_compile_too_many_states","params":[],"result":"i32"},{"body":10,"kind":"defn","name":"ext.regex.code_exec_invalid_compiled","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"ext.regex.code_parse_invalid_class","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"ext.regex.code_parse_invalid_escape","params":[],"result":"i32"},{"body":6,"kind":"defn","name":"ext.regex.code_parse_invalid_repeat","params":[],"result":"i32"},{"body":5,"kind":"defn","name":"ext.regex.code_parse_nothing_to_repeat","params":[],"result":"i32"},{"body":7,"kind":"defn","name":"ext.regex.code_parse_repeat_range","params":[],"result":"i32"},{"body":11,"kind":"defn","name":"ext.regex.code_parse_too_many_captures","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"ext.regex.code_parse_unbalanced_paren","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"ext.regex.code_parse_unclosed_class","params":[],"result":"i32"},{"body":["ext.regex.compile_opts_v1","pat",0],"kind":"defn","name":"ext.regex.compile","params":[{"name":"pat","ty":"bytes_view"}],"result":"bytes"},{"body":["ext.regex._compile_impl","pat","opts"],"kind":"defn","name":"ext.regex.compile_opts_v1","params":[{"name":"pat","ty":"bytes_view"},{"name":"opts","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.regex.is_err","doc"],0],["return",0],0],["if",["<",["view.len","doc"],5],0,["codec.read_u32_le","doc",1]]],"kind":"defn","name":"ext.regex.err_code","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_err","doc"],0],["return",0],0],["if",["<",["view.len","doc"],9],0,["codec.read_u32_le","doc",5]]],"kind":"defn","name":"ext.regex.err_pos","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["ext.regex._exec_from_impl","compiled","text",0],"kind":"defn","name":"ext.regex.exec","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"}],"result":"bytes"},{"body":["ext.regex._exec_caps_from_impl","compiled","text","start",2147483647],"kind":"defn","name":"ext.regex.exec_caps_from_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"bytes"},{"body":["ext.regex._exec_caps_from_impl","compiled","text",0,2147483647],"kind":"defn","name":"ext.regex.exec_caps_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"}],"result":"bytes"},{"body":["ext.regex._exec_from_impl","compiled","text","start"],"kind":"defn","name":"ext.regex.exec_from_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"start","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","compiled",["ext.regex.compile","pat"]],["ext.regex.exec",["bytes.view","compiled"],"text"]],"kind":"defn","name":"ext.regex.exec_pat","params":[{"name":"pat","ty":"bytes_view"},{"name":"text","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.regex.is_err","compiled"],1],["return",["std.text.slices.builder_finish_v1",["std.text.slices.builder_new_v1",0],0]],0],["std.text.slices.builder_finish_v1","out","count"]],"kind":"defn","name":"ext.regex.find_all_x7sl_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"max_matches","ty":"i32"}],"result":"bytes","result_brand":"std.text.slices.x7sl_v1"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["=",["view.get_u8","doc",0],0]],"kind":"defn","name":"ext.regex.is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<",["view.len","doc"],2],["return",0],0],["if",["!=",["view.get_u8","doc",0],1],["return",0],0],["=",["view.get_u8","doc",1],1]],"kind":"defn","name":"ext.regex.is_match","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_match","doc"],0],["return",0],0],["if",["<",["view.len","doc"],10],0,["codec.read_u32_le","doc",6]]],"kind":"defn","name":"ext.regex.match_end","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_match","doc"],0],["return",0],0],["let","a",["ext.regex.match_start","doc"]],["let","b",["ext.regex.match_end","doc"]],["if",["<u","b","a"],0,["-","b","a"]]],"kind":"defn","name":"ext.regex.match_len","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_match","doc"],0],["return",0],0],["if",["<",["view.len","doc"],6],0,["codec.read_u32_le","doc",2]]],"kind":"defn","name":"ext.regex.match_start","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":1,"kind":"defn","name":"ext.regex.opts_casei_v1","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"ext.regex.opts_dotall_v1","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"ext.regex.opts_multiline_v1","params":[],"result":"i32"},{"body":["begin",["if",["=",["ext.regex.is_err","compiled"],1],["return",["view.to_bytes","compiled"]],0],["let","text_len",["view.len","text"]],["let","repl_len",["view.len","repl"]],["let","cap",["+","text_len",16]],["let","out",["vec_u8.with_capacity","cap"]],["let","count",0],["let","last_end",0],["let","pos",0],["let","limit",["if",[">","cap_limit",0],"cap_limit",2147483647]],["let","done",0],["for","step",0,["+","text_len",2],["if","done",0,["if",[">=","count","limit"],["set","done",1],["if",[">u","pos","text_len"],["set","done",1],["begin",["let","doc_b",["ext.regex._exec_from_impl","compiled","text","pos"]],["if",["=",["ext.regex.is_err",["bytes.view","doc_b"]],1],["return","doc_b"],0],["if",["=",["ext.regex.is_match",["bytes.view","doc_b"]],0],["set","done",1],["begin",["let","s",["ext.regex.match_start",["bytes.view","doc_b"]]],["let","e",["ext.regex.match_end",["bytes.view","doc_b"]]],["set","out",["vec_u8.extend_bytes_range","out","text","last_end",["-","s","last_end"]]],["set","out",["vec_u8.extend_bytes_range","out","repl",0,"repl_len"]],["set","count",["+","count",1]],["set","last_end","e"],["set","pos",["if",[">u","e","s"],"e",["+","s",1]]],0]],0]]]]],["set","out",["vec_u8.extend_bytes_range","out","text","last_end",["-","text_len","last_end"]]],["std.vec.as_bytes","out"]],"kind":"defn","name":"ext.regex.replace_all_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"repl","ty":"bytes_view"},{"name":"cap_limit","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.regex.is_err","compiled"],1],["return",["std.text.slices.builder_finish_v1",["std.text.slices.builder_new_v1",0],0]],0],["std.text.slices.builder_finish_v1","out","count"]],"kind":"defn","name":"ext.regex.split_v1","params":[{"name":"compiled","ty":"bytes_view"},{"name":"text","ty":"bytes_view"},{"name":"max_parts","ty":"i32"}],"result":"bytes","result_brand":"std.text.slices.x7sl_v1"}],"imports":["std.text.ascii","std.text.slices","std.u32","std.vec"],"kind":"module","module_id":"ext.regex","schema_version":"x07.x07ast@0.3.0"}