{
  "schema_version": "x07.run-os-policy@0.1.0",
  "policy_id": "ext_db_migrate_sqlite_apply_v1",
  "limits": {
    "cpu_ms": 5000,
    "wall_ms": 6000,
    "mem_bytes": 268435456,
    "fds": 64,
    "procs": 16
  },
  "fs": {
    "enabled": true,
    "read_roots": ["arch/db"],
    "write_roots": [],
    "deny_hidden": true,
    "allow_symlinks": false,
    "allow_mkdir": false,
    "allow_remove": false,
    "allow_rename": false,
    "allow_walk": false,
    "allow_glob": false,
    "max_read_bytes": 2097152,
    "max_write_bytes": 0,
    "max_entries": 4096,
    "max_depth": 16
  },
  "net": {
    "enabled": false,
    "allow_dns": false,
    "allow_tcp": false,
    "allow_udp": false,
    "allow_hosts": []
  },
  "db": {
    "enabled": true,
    "drivers": { "sqlite": true, "postgres": false, "mysql": false },
    "max_live_conns": 8,
    "max_queries": 1000,
    "connect_timeout_ms": 5000,
    "query_timeout_ms": 30000,
    "max_sql_bytes": 1048576,
    "max_rows": 10000,
    "max_resp_bytes": 8388608,
    "sqlite": {
      "allow_paths": [],
      "readonly_only": false,
      "allow_create": true,
      "allow_in_memory": true
    },
    "net": {
      "allow_dns": [],
      "allow_cidrs": [],
      "allow_ports": [],
      "require_tls": true,
      "require_verify": true
    }
  },
  "env": { "enabled": false, "allow_keys": [], "deny_keys": [] },
  "time": {
    "enabled": false,
    "allow_monotonic": false,
    "allow_wall_clock": false,
    "allow_sleep": false,
    "max_sleep_ms": 0,
    "allow_local_tzid": false
  },
  "language": { "allow_unsafe": false, "allow_ffi": false },
  "process": {
    "enabled": false,
    "allow_spawn": false,
    "max_live": 0,
    "max_spawns": 0,
    "allow_exec": false,
    "allow_exit": false
  }
}
