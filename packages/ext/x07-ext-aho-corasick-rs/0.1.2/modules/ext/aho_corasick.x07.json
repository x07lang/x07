{"decls":[{"kind":"export","names":["ext.aho_corasick.code_compile_empty_needle","ext.aho_corasick.code_compile_invalid_needles","ext.aho_corasick.code_exec_invalid_compiled","ext.aho_corasick.compile","ext.aho_corasick.err_code","ext.aho_corasick.find","ext.aho_corasick.is_err","ext.aho_corasick.is_match","ext.aho_corasick.match_end","ext.aho_corasick.match_len","ext.aho_corasick.match_pat_id","ext.aho_corasick.match_start"]},{"body":["begin",["let","t",["codec.read_u32_le","state_head",["*","state",4]]],["let","done",0],["for","_",0,["+","trans_count",1],["if","done",0,["if",["<","t",0],["set","done",1],["begin",["if",["=",["view.get_u8","trans_byte","t"],"c"],["return",["codec.read_u32_le","trans_next",["*","t",4]]],0],["set","t",["codec.read_u32_le","trans_link",["*","t",4]]]]]]],-1],"kind":"defn","name":"ext.aho_corasick._goto_view","params":[{"name":"state_head","ty":"bytes_view"},{"name":"trans_byte","ty":"bytes_view"},{"name":"trans_next","ty":"bytes_view"},{"name":"trans_link","ty":"bytes_view"},{"name":"trans_count","ty":"i32"},{"name":"state","ty":"i32"},{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",9]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","code"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",0]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.aho_corasick._make_err","params":[{"name":"code","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","out",["vec_u8.with_capacity",14]],["set","out",["vec_u8.push","out",1]],["set","out",["vec_u8.push","out",["if","is_match",1,0]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","start"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","end"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","pat_id"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.aho_corasick._ok_match","params":[{"name":"is_match","ty":"i32"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"},{"name":"pat_id","ty":"i32"}],"result":"bytes"},{"body":["vec_u8.extend_bytes","out",["codec.write_u32_le","x"]],"kind":"defn","name":"ext.aho_corasick._push_u32_le","params":[{"name":"out","ty":"vec_u8"},{"name":"x","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["set","b",["bytes.set_u8","b","off",["&","x",255]]],["set","b",["bytes.set_u8","b",["+","off",1],["&",[">>u","x",8],255]]],["set","b",["bytes.set_u8","b",["+","off",2],["&",[">>u","x",16],255]]],["set","b",["bytes.set_u8","b",["+","off",3],["&",[">>u","x",24],255]]],"b"],"kind":"defn","name":"ext.aho_corasick._write_u32_le_at_bytes","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"x","ty":"i32"}],"result":"bytes"},{"body":2,"kind":"defn","name":"ext.aho_corasick.code_compile_empty_needle","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"ext.aho_corasick.code_compile_invalid_needles","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"ext.aho_corasick.code_exec_invalid_compiled","params":[],"result":"i32"},{"body":["begin",["let","n",["view.len","needles"]],["if",["<u","n",4],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["let","pat_count",["codec.read_u32_le","needles",0]],["if",["<","pat_count",0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["let","max_pat_len",0],["let","total_pat_bytes",0],["let","off",4],["for","_",0,"pat_count",["begin",["if",[">=u",["+","off",3],"n"],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["let","pat_len",["codec.read_u32_le","needles","off"]],["set","off",["+","off",4]],["if",["=","pat_len",0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_empty_needle"]]],0],["if",["<","pat_len",0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["if",["<u","max_pat_len","pat_len"],["set","max_pat_len","pat_len"],0],["set","total_pat_bytes",["+","total_pat_bytes","pat_len"]],["if",[">=u",["+","off","pat_len"],["+","n",1]],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["set","off",["+","off","pat_len"]]]],["if",["=",["=","off","n"],0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_compile_invalid_needles"]]],0],["let","max_states",["+","total_pat_bytes",1]],["let","max_trans","total_pat_bytes"],["let","pat_lens",["bytes.alloc",["*","pat_count",4]]],["let","state_head",["bytes.alloc",["*","max_states",4]]],["let","fail",["bytes.alloc",["*","max_states",4]]],["let","out",["bytes.alloc",["*","max_states",4]]],["let","trans_byte",["bytes.alloc","max_trans"]],["let","trans_next",["bytes.alloc",["*","max_trans",4]]],["let","trans_link",["bytes.alloc",["*","max_trans",4]]],["set","state_head",["ext.aho_corasick._write_u32_le_at_bytes","state_head",0,-1]],["let","state_count",1],["let","trans_count",0],["set","off",4],["for","pat_id",0,"pat_count",["begin",["let","pat_len",["codec.read_u32_le","needles","off"]],["set","off",["+","off",4]],["set","pat_lens",["ext.aho_corasick._write_u32_le_at_bytes","pat_lens",["*","pat_id",4],"pat_len"]],["let","pat_start","off"],["let","state",0],["for","j",0,"pat_len",["begin",["let","c",["view.get_u8","needles",["+","pat_start","j"]]],["let","next",["ext.aho_corasick._goto_view",["bytes.view","state_head"],["bytes.view","trans_byte"],["bytes.view","trans_next"],["bytes.view","trans_link"],"trans_count","state","c"]],["if",["<","next",0],["begin",["let","new_state","state_count"],["set","state_count",["+","state_count",1]],["set","state_head",["ext.aho_corasick._write_u32_le_at_bytes","state_head",["*","new_state",4],-1]],["let","head",["codec.read_u32_le",["bytes.view","state_head"],["*","state",4]]],["set","trans_byte",["bytes.set_u8","trans_byte","trans_count","c"]],["set","trans_next",["ext.aho_corasick._write_u32_le_at_bytes","trans_next",["*","trans_count",4],"new_state"]],["set","trans_link",["ext.aho_corasick._write_u32_le_at_bytes","trans_link",["*","trans_count",4],"head"]],["set","state_head",["ext.aho_corasick._write_u32_le_at_bytes","state_head",["*","state",4],"trans_count"]],["set","trans_count",["+","trans_count",1]],["set","state","new_state"]],["set","state","next"]]]],["let","cur_out",["codec.read_u32_le",["bytes.view","out"],["*","state",4]]],["let","new_out",["+","pat_id",1]],["if",["if",["=","cur_out",0],1,["<u","new_out","cur_out"]],["begin",["set","out",["ext.aho_corasick._write_u32_le_at_bytes","out",["*","state",4],"new_out"]],["let","_unit",0]],0],["set","off",["+","off","pat_len"]]]],["let","q",["bytes.alloc",["*","max_states",4]]],["let","q_head",0],["let","q_tail",0],["let","t",["codec.read_u32_le",["bytes.view","state_head"],0]],["let","done_init",0],["for","_",0,["+","trans_count",1],["if","done_init",0,["if",["<","t",0],["set","done_init",1],["begin",["let","s",["codec.read_u32_le",["bytes.view","trans_next"],["*","t",4]]],["set","fail",["ext.aho_corasick._write_u32_le_at_bytes","fail",["*","s",4],0]],["set","q",["ext.aho_corasick._write_u32_le_at_bytes","q","q_tail","s"]],["set","q_tail",["+","q_tail",4]],["set","t",["codec.read_u32_le",["bytes.view","trans_link"],["*","t",4]]]]]]],["let","done_bfs",0],["for","_",0,"state_count",["if","done_bfs",0,["if",[">=u","q_head","q_tail"],["set","done_bfs",1],["begin",["let","r",["codec.read_u32_le",["bytes.view","q"],"q_head"]],["set","q_head",["+","q_head",4]],["let","tt",["codec.read_u32_le",["bytes.view","state_head"],["*","r",4]]],["let","done_tt",0],["for","_",0,["+","trans_count",1],["if","done_tt",0,["if",["<","tt",0],["set","done_tt",1],["begin",["let","a",["view.get_u8",["bytes.view","trans_byte"],"tt"]],["let","s",["codec.read_u32_le",["bytes.view","trans_next"],["*","tt",4]]],["set","q",["ext.aho_corasick._write_u32_le_at_bytes","q","q_tail","s"]],["set","q_tail",["+","q_tail",4]],["let","f",["codec.read_u32_le",["bytes.view","fail"],["*","r",4]]],["let","g",-1],["let","done_fail",0],["for","_",0,"state_count",["if","done_fail",0,["if",["=","f",0],["begin",["set","g",["ext.aho_corasick._goto_view",["bytes.view","state_head"],["bytes.view","trans_byte"],["bytes.view","trans_next"],["bytes.view","trans_link"],"trans_count",0,"a"]],["set","done_fail",1]],["begin",["set","g",["ext.aho_corasick._goto_view",["bytes.view","state_head"],["bytes.view","trans_byte"],["bytes.view","trans_next"],["bytes.view","trans_link"],"trans_count","f","a"]],["if",["<","g",0],["set","f",["codec.read_u32_le",["bytes.view","fail"],["*","f",4]]],["set","done_fail",1]]]]]],["if",["<","g",0],["set","g",0],0],["set","fail",["ext.aho_corasick._write_u32_le_at_bytes","fail",["*","s",4],"g"]],["let","out_g",["codec.read_u32_le",["bytes.view","out"],["*","g",4]]],["if",["=",["=","out_g",0],0],["begin",["let","out_s",["codec.read_u32_le",["bytes.view","out"],["*","s",4]]],["if",["if",["=","out_s",0],1,["<u","out_g","out_s"]],["begin",["set","out",["ext.aho_corasick._write_u32_le_at_bytes","out",["*","s",4],"out_g"]],["let","_unit",0]],0]],0],["set","tt",["codec.read_u32_le",["bytes.view","trans_link"],["*","tt",4]]]]]]]]]]],["let","state_head_used",["bytes.slice",["bytes.view","state_head"],0,["*","state_count",4]]],["let","fail_used",["bytes.slice",["bytes.view","fail"],0,["*","state_count",4]]],["let","out_used",["bytes.slice",["bytes.view","out"],0,["*","state_count",4]]],["let","trans_byte_used",["bytes.slice",["bytes.view","trans_byte"],0,"trans_count"]],["let","trans_next_used",["bytes.slice",["bytes.view","trans_next"],0,["*","trans_count",4]]],["let","trans_link_used",["bytes.slice",["bytes.view","trans_link"],0,["*","trans_count",4]]],["let","total",["+",["+",["+",["+",["+",["+",["+",17,["bytes.len","pat_lens"]],["bytes.len","state_head_used"]],["bytes.len","fail_used"]],["bytes.len","out_used"]],["bytes.len","trans_byte_used"]],["bytes.len","trans_next_used"]],["bytes.len","trans_link_used"]]],["let","compiled",["vec_u8.with_capacity","total"]],["set","compiled",["vec_u8.push","compiled",1]],["set","compiled",["ext.aho_corasick._push_u32_le","compiled","pat_count"]],["set","compiled",["ext.aho_corasick._push_u32_le","compiled","state_count"]],["set","compiled",["ext.aho_corasick._push_u32_le","compiled","trans_count"]],["set","compiled",["ext.aho_corasick._push_u32_le","compiled","max_pat_len"]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","pat_lens"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","state_head_used"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","fail_used"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","out_used"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","trans_byte_used"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","trans_next_used"]]],["set","compiled",["vec_u8.extend_bytes","compiled",["bytes.view","trans_link_used"]]],["vec_u8.into_bytes","compiled"]],"kind":"defn","name":"ext.aho_corasick.compile","params":[{"name":"needles","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["ext.aho_corasick.is_err","doc"],0],["return",0],0],["if",["<",["view.len","doc"],5],["return",0],0],["codec.read_u32_le","doc",1]],"kind":"defn","name":"ext.aho_corasick.err_code","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["ext.aho_corasick.is_err","compiled"],["return",["view.to_bytes","compiled"]],0],["let","n",["view.len","compiled"]],["if",["<u","n",17],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["if",["=",["=",["view.get_u8","compiled",0],1],0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["let","pat_count",["codec.read_u32_le","compiled",1]],["let","state_count",["codec.read_u32_le","compiled",5]],["let","trans_count",["codec.read_u32_le","compiled",9]],["let","_max_pat_len",["codec.read_u32_le","compiled",13]],["if",["if",["if",["<","pat_count",0],1,["<","state_count",1]],1,["<","trans_count",0]],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["let","off_pat_lens",17],["let","off_state_head",["+","off_pat_lens",["*","pat_count",4]]],["let","off_fail",["+","off_state_head",["*","state_count",4]]],["let","off_out",["+","off_fail",["*","state_count",4]]],["let","off_trans_byte",["+","off_out",["*","state_count",4]]],["let","off_trans_next",["+","off_trans_byte","trans_count"]],["let","off_trans_link",["+","off_trans_next",["*","trans_count",4]]],["let","need",["+","off_trans_link",["*","trans_count",4]]],["if",[">=u","need",["+","n",1]],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["let","pat_lens_v",["view.slice","compiled","off_pat_lens",["*","pat_count",4]]],["let","state_head_v",["view.slice","compiled","off_state_head",["*","state_count",4]]],["let","fail_v",["view.slice","compiled","off_fail",["*","state_count",4]]],["let","out_v",["view.slice","compiled","off_out",["*","state_count",4]]],["let","trans_byte_v",["view.slice","compiled","off_trans_byte","trans_count"]],["let","trans_next_v",["view.slice","compiled","off_trans_next",["*","trans_count",4]]],["let","trans_link_v",["view.slice","compiled","off_trans_link",["*","trans_count",4]]],["let","hay_len",["view.len","hay"]],["let","state",0],["for","i",0,"hay_len",["begin",["let","c",["view.get_u8","hay","i"]],["let","next",["ext.aho_corasick._goto_view","state_head_v","trans_byte_v","trans_next_v","trans_link_v","trans_count","state","c"]],["let","done",0],["for","_",0,"state_count",["if","done",0,["if",[">=","next",0],["set","done",1],["if",["=","state",0],["set","done",1],["begin",["set","state",["codec.read_u32_le","fail_v",["*","state",4]]],["set","next",["ext.aho_corasick._goto_view","state_head_v","trans_byte_v","trans_next_v","trans_link_v","trans_count","state","c"]]]]]]],["if",[">=","next",0],["set","state","next"],["set","state",0]],["let","out_id",["codec.read_u32_le","out_v",["*","state",4]]],["if",["=",["=","out_id",0],0],["begin",["let","pat_id",["-","out_id",1]],["if",["if",["<","pat_id",0],1,[">=u","pat_id","pat_count"]],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["let","pat_len",["codec.read_u32_le","pat_lens_v",["*","pat_id",4]]],["if",["<=","pat_len",0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["let","end",["+","i",1]],["let","start",["-","end","pat_len"]],["if",["<","start",0],["return",["ext.aho_corasick._make_err",["ext.aho_corasick.code_exec_invalid_compiled"]]],0],["return",["ext.aho_corasick._ok_match",1,"start","end","pat_id"]]],0]]],["ext.aho_corasick._ok_match",0,0,0,0]],"kind":"defn","name":"ext.aho_corasick.find","params":[{"name":"compiled","ty":"bytes_view"},{"name":"hay","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["=",["view.get_u8","doc",0],0]],"kind":"defn","name":"ext.aho_corasick.is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<",["view.len","doc"],2],["return",0],0],["if",["=",["=",["view.get_u8","doc",0],1],0],["return",0],0],["=",["view.get_u8","doc",1],1]],"kind":"defn","name":"ext.aho_corasick.is_match","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.aho_corasick.is_match","doc"],0],["return",0],0],["if",["<",["view.len","doc"],10],["return",0],0],["codec.read_u32_le","doc",6]],"kind":"defn","name":"ext.aho_corasick.match_end","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.aho_corasick.is_match","doc"],0],["return",0],0],["let","a",["ext.aho_corasick.match_start","doc"]],["let","b",["ext.aho_corasick.match_end","doc"]],["if",["<u","b","a"],0,["-","b","a"]]],"kind":"defn","name":"ext.aho_corasick.match_len","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.aho_corasick.is_match","doc"],0],["return",0],0],["if",["<",["view.len","doc"],14],["return",0],0],["codec.read_u32_le","doc",10]],"kind":"defn","name":"ext.aho_corasick.match_pat_id","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["ext.aho_corasick.is_match","doc"],0],["return",0],0],["if",["<",["view.len","doc"],6],["return",0],0],["codec.read_u32_le","doc",2]],"kind":"defn","name":"ext.aho_corasick.match_start","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_aho_corasick@0.1.0/aho_corasick.rs","source_sha256":"bd31783ef27a7099aa6a1bd8fcc76d673c28ce43d3499863bac3c9faf7700f9a"},"module_id":"ext.aho_corasick","schema_version":"x07.x07ast@0.3.0"}
