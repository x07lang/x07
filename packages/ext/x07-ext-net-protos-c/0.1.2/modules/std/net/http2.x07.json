{
  "schema_version": "x07.x07ast@0.3.0",
  "kind": "module",
  "module_id": "std.net.http2",
  "imports": ["ext.data_model", "ext.json.data_model"],
  "decls": [
    { "kind": "export", "names": ["std.net.http2.client_from_arch_v1"] },
    {
      "kind": "defn",
      "name": "std.net.http2._read_index_doc_v1",
      "params": [],
      "result": "bytes",
      "body": [
        "begin",
        ["let", "raw", ["os.fs.read_file", ["bytes.lit", "arch/net/index.x07net.json"]]],
        ["ext.json.data_model.parse", ["bytes.view", "raw"]]
      ]
    },
    {
      "kind": "defn",
      "name": "std.net.http2.client_from_arch_v1",
      "params": [],
      "result": "result_i32",
      "body": [
        "budget.scope_from_arch_v1",
        ["bytes.lit", "net_proto_v1"],
        [
          "begin",
          ["let", "doc", ["std.net.http2._read_index_doc_v1"]],
          ["let", "dv", ["bytes.view", "doc"]],
          ["if", ["=", ["ext.data_model.doc_is_err", "dv"], 1], ["return", ["result_i32.err", 8001]], 0],
          ["if", ["!=", ["ext.data_model.root_kind", "dv"], 5], ["return", ["result_i32.err", 8002]], 0],
          ["let", "root", ["ext.data_model.root_offset", "dv"]],
          ["let", "k_http2", ["bytes.lit", "http2"]],
          ["let", "http2_off", ["ext.data_model.map_find", "dv", "root", ["bytes.view", "k_http2"]]],
          ["if", ["<", "http2_off", 0], ["return", ["result_i32.err", 8003]], 0],
          ["let", "k_enabled", ["bytes.lit", "enabled"]],
          ["let", "en_off", ["ext.data_model.map_find", "dv", "http2_off", ["bytes.view", "k_enabled"]]],
          ["if", ["<", "en_off", 0], ["return", ["result_i32.err", 8004]], 0],
          ["if", ["=", ["ext.data_model.bool_get", "dv", "en_off"], 0], ["return", ["result_i32.err", 8005]], 0],
          ["result_i32.ok", 0]
        ]
      ]
    }
  ]
}
