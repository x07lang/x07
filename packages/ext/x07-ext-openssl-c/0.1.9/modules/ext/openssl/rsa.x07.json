{"decls":[{"kind":"export","names":["ext.openssl.rsa.sign_pkcs1_sha256_v1","ext.openssl.rsa.verify_pkcs1_sha256_v1"]},{"body":["begin",["if",["<=",["view.len","n"],0],["return",["bytes.alloc",0]],0],["if",["<=",["view.len","e"],0],["return",["bytes.alloc",0]],0],["if",["<=",["view.len","d"],0],["return",["bytes.alloc",0]],0],["let","h",["unsafe",["ext.openssl._ffi.rsa_pkcs1_sha256_sign_alloc",["view.as_ptr","n"],["view.len","n"],["view.as_ptr","e"],["view.len","e"],["view.as_ptr","d"],["view.len","d"],["view.as_ptr","msg"],["view.len","msg"]]]],["if",["=","h",0],["return",["bytes.alloc",0]],0],["let","len",["unsafe",["ext.openssl._ffi.buf_len","h"]]],["if",["<=","len",0],["let","_",["unsafe",["ext.openssl._ffi.buf_free","h"]]],0],["if",["<=","len",0],["return",["bytes.alloc",0]],0],["let","ptr",["unsafe",["ext.openssl._ffi.buf_ptr","h"]]],["let","out",["vec_u8.with_capacity","len"]],["for","i",0,"len",["set","out",["vec_u8.push","out",["unsafe",["ptr.read_u8",["ptr.add","ptr","i"]]]]]],["let","sig",["vec_u8.into_bytes","out"]],["let","_",["unsafe",["ext.openssl._ffi.buf_free","h"]]],"sig"],"kind":"defn","name":"ext.openssl.rsa.sign_pkcs1_sha256_v1","params":[{"name":"n","ty":"bytes_view"},{"name":"e","ty":"bytes_view"},{"name":"d","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<=",["view.len","n"],0],["return",0],0],["if",["<=",["view.len","e"],0],["return",0],0],["if",["<=",["view.len","sig"],0],["return",0],0],["let","rc",["unsafe",["ext.openssl._ffi.rsa_pkcs1_sha256_verify",["view.as_ptr","n"],["view.len","n"],["view.as_ptr","e"],["view.len","e"],["view.as_ptr","msg"],["view.len","msg"],["view.as_ptr","sig"],["view.len","sig"]]]],["if",["=","rc",1],1,0]],"kind":"defn","name":"ext.openssl.rsa.verify_pkcs1_sha256_v1","params":[{"name":"n","ty":"bytes_view"},{"name":"e","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"},{"name":"sig","ty":"bytes_view"}],"result":"i32"}],"imports":["ext.openssl._ffi"],"kind":"module","module_id":"ext.openssl.rsa","schema_version":"x07.x07ast@0.3.0"}
