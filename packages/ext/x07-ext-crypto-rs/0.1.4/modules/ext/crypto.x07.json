{"decls":[{"kind":"export","names":["ext.crypto.eq_ct","ext.crypto.hkdf_err_code","ext.crypto.hkdf_get_bytes","ext.crypto.hkdf_is_err","ext.crypto.hkdf_sha256_expand_v1","ext.crypto.hkdf_sha256_extract","ext.crypto.hkdf_sha256_v1","ext.crypto.hmac_sha256","ext.crypto.sha256","ext.crypto.sha512"]},{"body":["^",["^",["ext.crypto._rotr","x",2],["ext.crypto._rotr","x",13]],["ext.crypto._rotr","x",22]],"kind":"defn","name":"ext.crypto._big_sigma0","params":[{"name":"x","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._rotr","x",6],["ext.crypto._rotr","x",11]],["ext.crypto._rotr","x",25]],"kind":"defn","name":"ext.crypto._big_sigma1","params":[{"name":"x","ty":"i32"}],"result":"i32"},{"body":["^",["&","x","y"],["&",["^","x",["-",0,1]],"z"]],"kind":"defn","name":"ext.crypto._ch","params":[{"name":"x","ty":"i32"},{"name":"y","ty":"i32"},{"name":"z","ty":"i32"}],"result":"i32"},{"body":["^",["^",["&","x","y"],["&","x","z"]],["&","y","z"]],"kind":"defn","name":"ext.crypto._maj","params":[{"name":"x","ty":"i32"},{"name":"y","ty":"i32"},{"name":"z","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",9]],["set","out",["vec_u8.push","out",0]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","code"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",0]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto._make_err_doc","params":[{"name":"code","ty":"i32"}],"result":"bytes"},{"body":["begin",["set","out",["vec_u8.push","out",["&",[">>u","x",24],255]]],["set","out",["vec_u8.push","out",["&",[">>u","x",16],255]]],["set","out",["vec_u8.push","out",["&",[">>u","x",8],255]]],["vec_u8.push","out",["&","x",255]]],"kind":"defn","name":"ext.crypto._push_u32_be","params":[{"name":"out","ty":"vec_u8"},{"name":"x","ty":"i32"}],"result":"vec_u8"},{"body":["begin",["let","b0",["view.get_u8","b","off"]],["let","b1",["view.get_u8","b",["+","off",1]]],["let","b2",["view.get_u8","b",["+","off",2]]],["let","b3",["view.get_u8","b",["+","off",3]]],["|",["|",["|",["<<u","b0",24],["<<u","b1",16]],["<<u","b2",8]],"b3"]],"kind":"defn","name":"ext.crypto._read_u32_be","params":[{"name":"b","ty":"bytes_view"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["|",[">>u","x","n"],["<<u","x",["-",32,"n"]]],"kind":"defn","name":"ext.crypto._rotr","params":[{"name":"x","ty":"i32"},{"name":"n","ty":"i32"}],"result":"i32"},{"body":["begin",["let","st",["bytes.view","state"]],["let","h0_0",["codec.read_u32_le","st",0]],["let","h1_0",["codec.read_u32_le","st",4]],["let","h2_0",["codec.read_u32_le","st",8]],["let","h3_0",["codec.read_u32_le","st",12]],["let","h4_0",["codec.read_u32_le","st",16]],["let","h5_0",["codec.read_u32_le","st",20]],["let","h6_0",["codec.read_u32_le","st",24]],["let","h7_0",["codec.read_u32_le","st",28]],["let","w",["vec_u8.with_capacity",["*",64,4]]],["for","t",0,16,["begin",["let","wt",["ext.crypto._read_u32_be","block",["*","t",4]]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wt"]]]]],["for","t",16,64,["begin",["let","w2",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",2],4]]],["let","w7",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",7],4]]],["let","w15",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",15],4]]],["let","w16",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",16],4]]],["let","s0",["ext.crypto._small_sigma0","w15"]],["let","s1",["ext.crypto._small_sigma1","w2"]],["let","wt",["+",["+",["+","w16","s0"],"w7"],"s1"]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wt"]]]]],["let","wv",["vec_u8.as_view","w"]],["let","a","h0_0"],["let","b","h1_0"],["let","c","h2_0"],["let","d","h3_0"],["let","e","h4_0"],["let","f","h5_0"],["let","g","h6_0"],["let","h","h7_0"],["for","t",0,64,["begin",["let","kt",["codec.read_u32_le","k",["*","t",4]]],["let","wt",["codec.read_u32_le","wv",["*","t",4]]],["let","t1",["+",["+",["+",["+","h",["ext.crypto._big_sigma1","e"]],["ext.crypto._ch","e","f","g"]],"kt"],"wt"]],["let","t2",["+",["ext.crypto._big_sigma0","a"],["ext.crypto._maj","a","b","c"]]],["set","h","g"],["set","g","f"],["set","f","e"],["set","e",["+","d","t1"]],["set","d","c"],["set","c","b"],["set","b","a"],["set","a",["+","t1","t2"]]]],["let","h0",["+","h0_0","a"]],["let","h1",["+","h1_0","b"]],["let","h2",["+","h2_0","c"]],["let","h3",["+","h3_0","d"]],["let","h4",["+","h4_0","e"]],["let","h5",["+","h5_0","f"]],["let","h6",["+","h6_0","g"]],["let","h7",["+","h7_0","h"]],["let","out",["vec_u8.with_capacity",32]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h0"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h1"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h2"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h3"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h4"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h5"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h6"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h7"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto._sha256_compress","params":[{"name":"state","ty":"bytes"},{"name":"block","ty":"bytes_view"},{"name":"k","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","out",["vec_u8.with_capacity",32]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1779033703]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",-1150833019]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1013904242]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",-1521486534]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1359893119]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",-1694144372]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",528734635]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1541459225]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto._sha256_init_state","params":[],"result":"bytes"},{"body":["begin",["let","v",["vec_u8.with_capacity",["*",64,4]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1116352408]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1899447441]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1245643825]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-373957723]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",961987163]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1508970993]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1841331548]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1424204075]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-670586216]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",310598401]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",607225278]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1426881987]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1925078388]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2132889090]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1680079193]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1046744716]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-459576895]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-272742522]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",264347078]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",604807628]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",770255983]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1249150122]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1555081692]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1996064986]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1740746414]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1473132947]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1341970488]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1084653625]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-958395405]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-710438585]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",113926993]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",338241895]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",666307205]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",773529912]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1294757372]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1396182291]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1695183700]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1986661051]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2117940946]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1838011259]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1564481375]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1474664885]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1035236496]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-949202525]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-778901479]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-694614492]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-200395387]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",275423344]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",430227734]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",506948616]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",659060556]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",883997877]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",958139571]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1322822218]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1537002063]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1747873779]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1955562222]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",2024104815]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2067236844]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1933114872]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1866530822]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1538233109]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1090935817]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-965641998]]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.crypto._sha256_k_bytes","params":[],"result":"bytes"},{"body":["^",["^",["ext.crypto._u64_rotr_hi","lo","hi",28],["ext.crypto._u64_rotr_hi","lo","hi",34]],["ext.crypto._u64_rotr_hi","lo","hi",39]],"kind":"defn","name":"ext.crypto._sha512_big_sigma0_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_lo","lo","hi",28],["ext.crypto._u64_rotr_lo","lo","hi",34]],["ext.crypto._u64_rotr_lo","lo","hi",39]],"kind":"defn","name":"ext.crypto._sha512_big_sigma0_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_hi","lo","hi",14],["ext.crypto._u64_rotr_hi","lo","hi",18]],["ext.crypto._u64_rotr_hi","lo","hi",41]],"kind":"defn","name":"ext.crypto._sha512_big_sigma1_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_lo","lo","hi",14],["ext.crypto._u64_rotr_lo","lo","hi",18]],["ext.crypto._u64_rotr_lo","lo","hi",41]],"kind":"defn","name":"ext.crypto._sha512_big_sigma1_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["&","x_hi","y_hi"],["&",["^","x_hi",["-",0,1]],"z_hi"]],"kind":"defn","name":"ext.crypto._sha512_ch_hi","params":[{"name":"x_hi","ty":"i32"},{"name":"y_hi","ty":"i32"},{"name":"z_hi","ty":"i32"}],"result":"i32"},{"body":["^",["&","x_lo","y_lo"],["&",["^","x_lo",["-",0,1]],"z_lo"]],"kind":"defn","name":"ext.crypto._sha512_ch_lo","params":[{"name":"x_lo","ty":"i32"},{"name":"y_lo","ty":"i32"},{"name":"z_lo","ty":"i32"}],"result":"i32"},{"body":["begin",["let","st",["bytes.view","state"]],["let","h0_lo_0",["codec.read_u32_le","st",0]],["let","h0_hi_0",["codec.read_u32_le","st",4]],["let","h1_lo_0",["codec.read_u32_le","st",8]],["let","h1_hi_0",["codec.read_u32_le","st",12]],["let","h2_lo_0",["codec.read_u32_le","st",16]],["let","h2_hi_0",["codec.read_u32_le","st",20]],["let","h3_lo_0",["codec.read_u32_le","st",24]],["let","h3_hi_0",["codec.read_u32_le","st",28]],["let","h4_lo_0",["codec.read_u32_le","st",32]],["let","h4_hi_0",["codec.read_u32_le","st",36]],["let","h5_lo_0",["codec.read_u32_le","st",40]],["let","h5_hi_0",["codec.read_u32_le","st",44]],["let","h6_lo_0",["codec.read_u32_le","st",48]],["let","h6_hi_0",["codec.read_u32_le","st",52]],["let","h7_lo_0",["codec.read_u32_le","st",56]],["let","h7_hi_0",["codec.read_u32_le","st",60]],["let","w",["vec_u8.with_capacity",["*",80,8]]],["for","t",0,16,["begin",["let","wi_hi",["ext.crypto._read_u32_be","block",["*","t",8]]],["let","wi_lo",["ext.crypto._read_u32_be","block",["+",["*","t",8],4]]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wi_lo"]]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wi_hi"]]]]],["for","t",16,80,["begin",["let","w2_lo",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",2],8]]],["let","w2_hi",["codec.read_u32_le",["vec_u8.as_view","w"],["+",["*",["-","t",2],8],4]]],["let","w7_lo",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",7],8]]],["let","w7_hi",["codec.read_u32_le",["vec_u8.as_view","w"],["+",["*",["-","t",7],8],4]]],["let","w15_lo",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",15],8]]],["let","w15_hi",["codec.read_u32_le",["vec_u8.as_view","w"],["+",["*",["-","t",15],8],4]]],["let","w16_lo",["codec.read_u32_le",["vec_u8.as_view","w"],["*",["-","t",16],8]]],["let","w16_hi",["codec.read_u32_le",["vec_u8.as_view","w"],["+",["*",["-","t",16],8],4]]],["let","s0_lo",["ext.crypto._sha512_small_sigma0_lo","w15_lo","w15_hi"]],["let","s0_hi",["ext.crypto._sha512_small_sigma0_hi","w15_lo","w15_hi"]],["let","s1_lo",["ext.crypto._sha512_small_sigma1_lo","w2_lo","w2_hi"]],["let","s1_hi",["ext.crypto._sha512_small_sigma1_hi","w2_lo","w2_hi"]],["let","t0_lo",["ext.crypto._u64_add_lo","w16_lo","s0_lo"]],["let","t0_hi",["ext.crypto._u64_add_hi","w16_lo","w16_hi","s0_lo","s0_hi","t0_lo"]],["let","t1_lo",["ext.crypto._u64_add_lo","t0_lo","w7_lo"]],["let","t1_hi",["ext.crypto._u64_add_hi","t0_lo","t0_hi","w7_lo","w7_hi","t1_lo"]],["let","wt_lo",["ext.crypto._u64_add_lo","t1_lo","s1_lo"]],["let","wt_hi",["ext.crypto._u64_add_hi","t1_lo","t1_hi","s1_lo","s1_hi","wt_lo"]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wt_lo"]]],["set","w",["vec_u8.extend_bytes","w",["codec.write_u32_le","wt_hi"]]]]],["let","wv",["vec_u8.as_view","w"]],["let","a_lo","h0_lo_0"],["let","a_hi","h0_hi_0"],["let","b_lo","h1_lo_0"],["let","b_hi","h1_hi_0"],["let","c_lo","h2_lo_0"],["let","c_hi","h2_hi_0"],["let","d_lo","h3_lo_0"],["let","d_hi","h3_hi_0"],["let","e_lo","h4_lo_0"],["let","e_hi","h4_hi_0"],["let","f_lo","h5_lo_0"],["let","f_hi","h5_hi_0"],["let","g_lo","h6_lo_0"],["let","g_hi","h6_hi_0"],["let","h_lo","h7_lo_0"],["let","h_hi","h7_hi_0"],["for","t",0,80,["begin",["let","kt_lo",["codec.read_u32_le","k",["*","t",8]]],["let","kt_hi",["codec.read_u32_le","k",["+",["*","t",8],4]]],["let","wt_lo",["codec.read_u32_le","wv",["*","t",8]]],["let","wt_hi",["codec.read_u32_le","wv",["+",["*","t",8],4]]],["let","s1_lo",["ext.crypto._sha512_big_sigma1_lo","e_lo","e_hi"]],["let","s1_hi",["ext.crypto._sha512_big_sigma1_hi","e_lo","e_hi"]],["let","ch_lo",["ext.crypto._sha512_ch_lo","e_lo","f_lo","g_lo"]],["let","ch_hi",["ext.crypto._sha512_ch_hi","e_hi","f_hi","g_hi"]],["let","t1a_lo",["ext.crypto._u64_add_lo","h_lo","s1_lo"]],["let","t1a_hi",["ext.crypto._u64_add_hi","h_lo","h_hi","s1_lo","s1_hi","t1a_lo"]],["let","t1b_lo",["ext.crypto._u64_add_lo","t1a_lo","ch_lo"]],["let","t1b_hi",["ext.crypto._u64_add_hi","t1a_lo","t1a_hi","ch_lo","ch_hi","t1b_lo"]],["let","t1c_lo",["ext.crypto._u64_add_lo","t1b_lo","kt_lo"]],["let","t1c_hi",["ext.crypto._u64_add_hi","t1b_lo","t1b_hi","kt_lo","kt_hi","t1c_lo"]],["let","t1_lo",["ext.crypto._u64_add_lo","t1c_lo","wt_lo"]],["let","t1_hi",["ext.crypto._u64_add_hi","t1c_lo","t1c_hi","wt_lo","wt_hi","t1_lo"]],["let","s0_lo",["ext.crypto._sha512_big_sigma0_lo","a_lo","a_hi"]],["let","s0_hi",["ext.crypto._sha512_big_sigma0_hi","a_lo","a_hi"]],["let","maj_lo",["ext.crypto._sha512_maj_lo","a_lo","b_lo","c_lo"]],["let","maj_hi",["ext.crypto._sha512_maj_hi","a_hi","b_hi","c_hi"]],["let","t2_lo",["ext.crypto._u64_add_lo","s0_lo","maj_lo"]],["let","t2_hi",["ext.crypto._u64_add_hi","s0_lo","s0_hi","maj_lo","maj_hi","t2_lo"]],["set","h_lo","g_lo"],["set","h_hi","g_hi"],["set","g_lo","f_lo"],["set","g_hi","f_hi"],["set","f_lo","e_lo"],["set","f_hi","e_hi"],["let","e2_lo",["ext.crypto._u64_add_lo","d_lo","t1_lo"]],["let","e2_hi",["ext.crypto._u64_add_hi","d_lo","d_hi","t1_lo","t1_hi","e2_lo"]],["set","e_lo","e2_lo"],["set","e_hi","e2_hi"],["set","d_lo","c_lo"],["set","d_hi","c_hi"],["set","c_lo","b_lo"],["set","c_hi","b_hi"],["set","b_lo","a_lo"],["set","b_hi","a_hi"],["let","a2_lo",["ext.crypto._u64_add_lo","t1_lo","t2_lo"]],["let","a2_hi",["ext.crypto._u64_add_hi","t1_lo","t1_hi","t2_lo","t2_hi","a2_lo"]],["set","a_lo","a2_lo"],["set","a_hi","a2_hi"]]],["let","h0_lo",["ext.crypto._u64_add_lo","h0_lo_0","a_lo"]],["let","h0_hi",["ext.crypto._u64_add_hi","h0_lo_0","h0_hi_0","a_lo","a_hi","h0_lo"]],["let","h1_lo",["ext.crypto._u64_add_lo","h1_lo_0","b_lo"]],["let","h1_hi",["ext.crypto._u64_add_hi","h1_lo_0","h1_hi_0","b_lo","b_hi","h1_lo"]],["let","h2_lo",["ext.crypto._u64_add_lo","h2_lo_0","c_lo"]],["let","h2_hi",["ext.crypto._u64_add_hi","h2_lo_0","h2_hi_0","c_lo","c_hi","h2_lo"]],["let","h3_lo",["ext.crypto._u64_add_lo","h3_lo_0","d_lo"]],["let","h3_hi",["ext.crypto._u64_add_hi","h3_lo_0","h3_hi_0","d_lo","d_hi","h3_lo"]],["let","h4_lo",["ext.crypto._u64_add_lo","h4_lo_0","e_lo"]],["let","h4_hi",["ext.crypto._u64_add_hi","h4_lo_0","h4_hi_0","e_lo","e_hi","h4_lo"]],["let","h5_lo",["ext.crypto._u64_add_lo","h5_lo_0","f_lo"]],["let","h5_hi",["ext.crypto._u64_add_hi","h5_lo_0","h5_hi_0","f_lo","f_hi","h5_lo"]],["let","h6_lo",["ext.crypto._u64_add_lo","h6_lo_0","g_lo"]],["let","h6_hi",["ext.crypto._u64_add_hi","h6_lo_0","h6_hi_0","g_lo","g_hi","h6_lo"]],["let","h7_lo",["ext.crypto._u64_add_lo","h7_lo_0","h_lo"]],["let","h7_hi",["ext.crypto._u64_add_hi","h7_lo_0","h7_hi_0","h_lo","h_hi","h7_lo"]],["let","out",["vec_u8.with_capacity",64]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h0_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h0_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h1_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h1_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h2_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h2_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h3_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h3_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h4_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h4_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h5_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h5_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h6_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h6_hi"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h7_lo"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","h7_hi"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto._sha512_compress","params":[{"name":"state","ty":"bytes"},{"name":"block","ty":"bytes_view"},{"name":"k","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","v",["vec_u8.with_capacity",64]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-205731576]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1779033703]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2067093701]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1150833019]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-23791573]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1013904242]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1595750129]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1521486534]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1377402159]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1359893119]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",725511199]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1694144372]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-79577749]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",528734635]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",327033209]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1541459225]]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.crypto._sha512_init_state","params":[],"result":"bytes"},{"body":["begin",["let","k0",["ext.crypto._sha512_k_bytes_0"]],["let","k1",["ext.crypto._sha512_k_bytes_1"]],["let","v",["vec_u8.with_capacity",["*",80,8]]],["set","v",["vec_u8.extend_bytes","v","k0"]],["set","v",["vec_u8.extend_bytes","v","k1"]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.crypto._sha512_k_bytes","params":[],"result":"bytes"},{"body":["begin",["let","v",["vec_u8.with_capacity",["*",40,8]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-685199838]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1116352408]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",602891725]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1899447441]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-330482897]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1245643825]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2121671748]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-373957723]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-213338824]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",961987163]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1241133031]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1508970993]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1357295717]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1841331548]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-630357736]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1424204075]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1560083902]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-670586216]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1164996542]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",310598401]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1323610764]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",607225278]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-704662302]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1426881987]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-226784913]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1925078388]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",991336113]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2132889090]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",633803317]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1680079193]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-815192428]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1046744716]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1628353838]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-459576895]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",944711139]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-272742522]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1953704523]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",264347078]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",2007800933]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",604807628]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1495990901]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",770255983]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1856431235]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1249150122]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1119749164]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1555081692]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2096016459]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1996064986]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-295247957]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1740746414]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",766784016]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1473132947]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1728372417]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1341970488]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1091629340]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1084653625]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1034457026]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-958395405]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1828018395]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-710438585]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-536640913]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",113926993]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",168717936]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",338241895]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1188179964]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",666307205]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1546045734]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",773529912]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1522805485]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1294757372]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1651133473]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1396182291]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1951439906]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1695183700]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1014477480]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1986661051]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1206759142]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2117940946]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",344077627]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1838011259]]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.crypto._sha512_k_bytes_0","params":[],"result":"bytes"},{"body":["begin",["let","v",["vec_u8.with_capacity",["*",40,8]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1290863460]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1564481375]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1136513023]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1474664885]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-789014639]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1035236496]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",106217008]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-949202525]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-688958952]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-778901479]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1432725776]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-694614492]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1467031594]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-200395387]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",851169720]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",275423344]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1194143544]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",430227734]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1363258195]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",506948616]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-544281703]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",659060556]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-509917016]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",883997877]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-976659869]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",958139571]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-482243893]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1322822218]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",2003034995]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1537002063]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-692930397]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1747873779]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1575990012]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1955562222]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1125592928]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",2024104815]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1578062990]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-2067236844]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",442776044]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1933114872]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",593698344]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1866530822]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-561857047]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1538233109]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1295615723]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1090935817]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-479046869]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-965641998]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-366583396]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-903397682]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",566280711]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-779700025]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-840897762]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-354779690]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-294727304]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-176337025]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1914138554]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",116418474]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1563912026]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",174292421]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1090974290]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",289380356]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",320620315]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",460393269]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",587496836]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",685471733]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1086792851]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",852142971]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",365543100]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1017036298]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-1676669620]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1126000580]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-885112138]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1288033470]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",-60457430]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1501505948]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",987167468]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1607167915]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1246189591]]],["set","v",["vec_u8.extend_bytes","v",["codec.write_u32_le",1816402316]]],["vec_u8.into_bytes","v"]],"kind":"defn","name":"ext.crypto._sha512_k_bytes_1","params":[],"result":"bytes"},{"body":["^",["^",["&","x_hi","y_hi"],["&","x_hi","z_hi"]],["&","y_hi","z_hi"]],"kind":"defn","name":"ext.crypto._sha512_maj_hi","params":[{"name":"x_hi","ty":"i32"},{"name":"y_hi","ty":"i32"},{"name":"z_hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["&","x_lo","y_lo"],["&","x_lo","z_lo"]],["&","y_lo","z_lo"]],"kind":"defn","name":"ext.crypto._sha512_maj_lo","params":[{"name":"x_lo","ty":"i32"},{"name":"y_lo","ty":"i32"},{"name":"z_lo","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_hi","lo","hi",1],["ext.crypto._u64_rotr_hi","lo","hi",8]],["ext.crypto._u64_shr_u_hi","lo","hi",7]],"kind":"defn","name":"ext.crypto._sha512_small_sigma0_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_lo","lo","hi",1],["ext.crypto._u64_rotr_lo","lo","hi",8]],["ext.crypto._u64_shr_u_lo","lo","hi",7]],"kind":"defn","name":"ext.crypto._sha512_small_sigma0_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_hi","lo","hi",19],["ext.crypto._u64_rotr_hi","lo","hi",61]],["ext.crypto._u64_shr_u_hi","lo","hi",6]],"kind":"defn","name":"ext.crypto._sha512_small_sigma1_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._u64_rotr_lo","lo","hi",19],["ext.crypto._u64_rotr_lo","lo","hi",61]],["ext.crypto._u64_shr_u_lo","lo","hi",6]],"kind":"defn","name":"ext.crypto._sha512_small_sigma1_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._rotr","x",7],["ext.crypto._rotr","x",18]],[">>u","x",3]],"kind":"defn","name":"ext.crypto._small_sigma0","params":[{"name":"x","ty":"i32"}],"result":"i32"},{"body":["^",["^",["ext.crypto._rotr","x",17],["ext.crypto._rotr","x",19]],[">>u","x",10]],"kind":"defn","name":"ext.crypto._small_sigma1","params":[{"name":"x","ty":"i32"}],"result":"i32"},{"body":["begin",["let","carry",["if",["<u","sum_lo","a_lo"],1,0]],["+",["+","a_hi","b_hi"],"carry"]],"kind":"defn","name":"ext.crypto._u64_add_hi","params":[{"name":"a_lo","ty":"i32"},{"name":"a_hi","ty":"i32"},{"name":"b_lo","ty":"i32"},{"name":"b_hi","ty":"i32"},{"name":"sum_lo","ty":"i32"}],"result":"i32"},{"body":["+","a_lo","b_lo"],"kind":"defn","name":"ext.crypto._u64_add_lo","params":[{"name":"a_lo","ty":"i32"},{"name":"b_lo","ty":"i32"}],"result":"i32"},{"body":["if",["=","n",0],"hi",["if",["<u","n",32],["|",[">>u","hi","n"],["<<u","lo",["-",32,"n"]]],["if",["=","n",32],"lo",["if",["<u","n",64],["|",[">>u","lo",["-","n",32]],["<<u","hi",["-",64,"n"]]],0]]]],"kind":"defn","name":"ext.crypto._u64_rotr_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"},{"name":"n","ty":"i32"}],"result":"i32"},{"body":["if",["=","n",0],"lo",["if",["<u","n",32],["|",[">>u","lo","n"],["<<u","hi",["-",32,"n"]]],["if",["=","n",32],"hi",["if",["<u","n",64],["|",[">>u","hi",["-","n",32]],["<<u","lo",["-",64,"n"]]],0]]]],"kind":"defn","name":"ext.crypto._u64_rotr_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"},{"name":"n","ty":"i32"}],"result":"i32"},{"body":["if",["=","n",0],"hi",["if",["<u","n",32],[">>u","hi","n"],["if",["<u","n",64],0,0]]],"kind":"defn","name":"ext.crypto._u64_shr_u_hi","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"},{"name":"n","ty":"i32"}],"result":"i32"},{"body":["if",["=","n",0],"lo",["if",["<u","n",32],["|",[">>u","lo","n"],["<<u","hi",["-",32,"n"]]],["if",["=","n",32],"hi",["if",["<u","n",64],[">>u","hi",["-","n",32]],0]]]],"kind":"defn","name":"ext.crypto._u64_shr_u_lo","params":[{"name":"lo","ty":"i32"},{"name":"hi","ty":"i32"},{"name":"n","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["view.len","a"]],["if",["=",["=","n",["view.len","b"]],0],["return",0],0],["let","diff",0],["for","i",0,"n",["set","diff",["|","diff",["^",["view.get_u8","a","i"],["view.get_u8","b","i"]]]]],["=","diff",0]],"kind":"defn","name":"ext.crypto.eq_ct","params":[{"name":"a","ty":"bytes_view"},{"name":"b","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<",["view.len","doc"],5],["return",0],0],["if",["=",["=",["view.get_u8","doc",0],0],0],["return",0],0],["codec.read_u32_le","doc",1]],"kind":"defn","name":"ext.crypto.hkdf_err_code","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","doc"]],["if",["if",["<","n",1],1,["=",["=",["view.get_u8","doc",0],1],0]],["return",["bytes.alloc",0]],0],["view.to_bytes",["view.slice","doc",1,["-","n",1]]]],"kind":"defn","name":"ext.crypto.hkdf_get_bytes","params":[{"name":"doc","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["<",["view.len","doc"],1],["return",1],0],["=",["view.get_u8","doc",0],0]],"kind":"defn","name":"ext.crypto.hkdf_is_err","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["<","out_len",0],["return",["ext.crypto._make_err_doc",1]],0],["if",[">","out_len",8160],["return",["ext.crypto._make_err_doc",1]],0],["let","n_blocks",["/",["+","out_len",31],32]],["if",[">","n_blocks",255],["return",["ext.crypto._make_err_doc",1]],0],["let","out",["vec_u8.with_capacity",["+","out_len",1]]],["set","out",["vec_u8.push","out",1]],["let","info_len",["view.len","info"]],["let","t_prev",["bytes.alloc",0]],["for","i",0,"n_blocks",["begin",["let","counter",["+","i",1]],["let","t_prev_len",["bytes.len","t_prev"]],["let","msg",["vec_u8.with_capacity",["+",["+","t_prev_len","info_len"],1]]],["set","msg",["vec_u8.extend_bytes","msg",["bytes.view","t_prev"]]],["set","msg",["vec_u8.extend_bytes","msg","info"]],["set","msg",["vec_u8.push","msg","counter"]],["let","msg_b",["vec_u8.into_bytes","msg"]],["let","t",["ext.crypto.hmac_sha256","prk",["bytes.view","msg_b"]]],["let","written",["-",["vec_u8.len","out"],1]],["let","remaining",["-","out_len","written"]],["let","take",["if",["<","remaining",32],"remaining",32]],["set","out",["vec_u8.extend_bytes_range","out",["bytes.view","t"],0,"take"]],["set","t_prev","t"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto.hkdf_sha256_expand_v1","params":[{"name":"prk","ty":"bytes_view"},{"name":"info","ty":"bytes_view"},{"name":"out_len","ty":"i32"}],"result":"bytes"},{"body":["begin",["if",["=",["view.len","salt"],0],["begin",["let","zeros",["bytes.alloc",32]],["return",["ext.crypto.hmac_sha256",["bytes.view","zeros"],"ikm"]]],0],["ext.crypto.hmac_sha256","salt","ikm"]],"kind":"defn","name":"ext.crypto.hkdf_sha256_extract","params":[{"name":"salt","ty":"bytes_view"},{"name":"ikm","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","prk",["ext.crypto.hkdf_sha256_extract","salt","ikm"]],["ext.crypto.hkdf_sha256_expand_v1",["bytes.view","prk"],"info","out_len"]],"kind":"defn","name":"ext.crypto.hkdf_sha256_v1","params":[{"name":"salt","ty":"bytes_view"},{"name":"ikm","ty":"bytes_view"},{"name":"info","ty":"bytes_view"},{"name":"out_len","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","key_len",["view.len","key"]],["let","key2",["if",[">","key_len",64],["ext.crypto.sha256","key"],["bytes.alloc",0]]],["let","keyv",["if",[">","key_len",64],["bytes.view","key2"],"key"]],["let","keyv_len",["view.len","keyv"]],["let","ipad",["vec_u8.with_capacity",64]],["let","opad",["vec_u8.with_capacity",64]],["for","i",0,64,["begin",["let","kb",["if",["<u","i","keyv_len"],["view.get_u8","keyv","i"],0]],["set","ipad",["vec_u8.push","ipad",["^","kb",54]]],["set","opad",["vec_u8.push","opad",["^","kb",92]]]]],["let","inner",["vec_u8.with_capacity",["+",64,["view.len","msg"]]]],["set","inner",["vec_u8.extend_bytes","inner",["vec_u8.into_bytes","ipad"]]],["set","inner",["vec_u8.extend_bytes_range","inner","msg",0,["view.len","msg"]]],["let","inner_b",["vec_u8.into_bytes","inner"]],["let","inner_h",["ext.crypto.sha256",["bytes.view","inner_b"]]],["let","outer",["vec_u8.with_capacity",["+",64,32]]],["set","outer",["vec_u8.extend_bytes","outer",["vec_u8.into_bytes","opad"]]],["set","outer",["vec_u8.extend_bytes","outer","inner_h"]],["let","outer_b",["vec_u8.into_bytes","outer"]],["ext.crypto.sha256",["bytes.view","outer_b"]]],"kind":"defn","name":"ext.crypto.hmac_sha256","params":[{"name":"key","ty":"bytes_view"},{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","k_bytes",["ext.crypto._sha256_k_bytes"]],["let","k",["bytes.view","k_bytes"]],["let","state",["ext.crypto._sha256_init_state"]],["let","n",["view.len","msg"]],["let","off",0],["for","_",0,"n",["if",["<u",["+","off",63],"n"],["begin",["let","block",["view.slice","msg","off",64]],["set","state",["ext.crypto._sha256_compress","state","block","k"]],["set","off",["+","off",64]]],0]],["let","rem",["-","n","off"]],["let","tail",["vec_u8.with_capacity",128]],["if",[">","rem",0],["set","tail",["vec_u8.extend_bytes_range","tail","msg","off","rem"]],0],["set","tail",["vec_u8.push","tail",128]],["let","cur_mod",["%",["vec_u8.len","tail"],64]],["let","pad_len",["if",["<=","cur_mod",56],["-",56,"cur_mod"],["+",56,["-",64,"cur_mod"]]]],["for","_",0,"pad_len",["set","tail",["vec_u8.push","tail",0]]],["let","bit_lo",["<<u","n",3]],["let","bit_hi",[">>u","n",29]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",24],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",16],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",8],255]]],["set","tail",["vec_u8.push","tail",["&","bit_hi",255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",24],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",16],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",8],255]]],["set","tail",["vec_u8.push","tail",["&","bit_lo",255]]],["let","tail_b",["vec_u8.into_bytes","tail"]],["let","tail_v",["bytes.view","tail_b"]],["let","tail_n",["view.len","tail_v"]],["let","tail_off",0],["for","_",0,"tail_n",["if",["<u",["+","tail_off",63],"tail_n"],["begin",["let","block",["view.slice","tail_v","tail_off",64]],["set","state",["ext.crypto._sha256_compress","state","block","k"]],["set","tail_off",["+","tail_off",64]]],0]],["let","st",["bytes.view","state"]],["let","out",["vec_u8.with_capacity",32]],["for","i",0,8,["begin",["let","w",["codec.read_u32_le","st",["*","i",4]]],["set","out",["ext.crypto._push_u32_be","out","w"]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto.sha256","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","k_bytes",["ext.crypto._sha512_k_bytes"]],["let","k",["bytes.view","k_bytes"]],["let","state",["ext.crypto._sha512_init_state"]],["let","n",["view.len","msg"]],["let","blocks",["/","n",128]],["let","off",0],["for","_",0,"blocks",["begin",["let","block",["view.slice","msg","off",128]],["set","state",["ext.crypto._sha512_compress","state","block","k"]],["set","off",["+","off",128]]]],["let","rem",["-","n","off"]],["let","tail",["vec_u8.with_capacity",256]],["if",[">","rem",0],["set","tail",["vec_u8.extend_bytes_range","tail","msg","off","rem"]],0],["set","tail",["vec_u8.push","tail",128]],["let","cur_mod",["%",["vec_u8.len","tail"],128]],["let","pad_len",["if",["<=","cur_mod",112],["-",112,"cur_mod"],["+",112,["-",128,"cur_mod"]]]],["for","_",0,"pad_len",["set","tail",["vec_u8.push","tail",0]]],["for","_",0,8,["set","tail",["vec_u8.push","tail",0]]],["let","bit_lo",["<<u","n",3]],["let","bit_hi",[">>u","n",29]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",24],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",16],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_hi",8],255]]],["set","tail",["vec_u8.push","tail",["&","bit_hi",255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",24],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",16],255]]],["set","tail",["vec_u8.push","tail",["&",[">>u","bit_lo",8],255]]],["set","tail",["vec_u8.push","tail",["&","bit_lo",255]]],["let","tail_b",["vec_u8.into_bytes","tail"]],["let","tail_v",["bytes.view","tail_b"]],["let","tail_n",["view.len","tail_v"]],["let","tail_blocks",["/","tail_n",128]],["let","tail_off",0],["for","_",0,"tail_blocks",["begin",["let","block",["view.slice","tail_v","tail_off",128]],["set","state",["ext.crypto._sha512_compress","state","block","k"]],["set","tail_off",["+","tail_off",128]]]],["let","st2",["bytes.view","state"]],["let","out",["vec_u8.with_capacity",64]],["for","i",0,8,["begin",["let","lo",["codec.read_u32_le","st2",["*","i",8]]],["let","hi",["codec.read_u32_le","st2",["+",["*","i",8],4]]],["set","out",["ext.crypto._push_u32_be","out","hi"]],["set","out",["ext.crypto._push_u32_be","out","lo"]]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"ext.crypto.sha512","params":[{"name":"msg","ty":"bytes_view"}],"result":"bytes"}],"imports":[],"kind":"module","meta":{"generated_by":"x07import","source_path":"tests/x07import/fixtures/import_sources/rust/ext_crypto@0.1.0/crypto.rs","source_sha256":"df8ed43f0b7c0da0cef6f8029c6936e64a34cc38055e251538a6e3bf0e9a3415"},"module_id":"ext.crypto","schema_version":"x07.x07ast@0.3.0"}
