{"decls":[{"kind":"export","names":["std.db.spec.caps_connect_timeout_ms_v1","std.db.spec.caps_default_v1","std.db.spec.caps_max_resp_bytes_v1","std.db.spec.caps_max_rows_v1","std.db.spec.caps_pack_v1","std.db.spec.caps_query_timeout_ms_v1","std.db.spec.conn_driver_v1","std.db.spec.conn_pack_v1","std.db.spec.conn_raw_v1","std.db.spec.driver_mysql_v1","std.db.spec.driver_pg_v1","std.db.spec.driver_redis_v1","std.db.spec.driver_sqlite_v1","std.db.spec.op_close_v1","std.db.spec.op_exec_v1","std.db.spec.op_open_v1","std.db.spec.op_pool_close_v1","std.db.spec.op_pool_new_v1","std.db.spec.op_query_v1","std.db.spec.resp_check_v1","std.db.spec.resp_err_code_v1","std.db.spec.resp_err_msg_v1","std.db.spec.resp_err_v1","std.db.spec.resp_is_ok_v1","std.db.spec.resp_ok_payload_v1","std.db.spec.resp_ok_payload_view_v1","std.db.spec.resp_ok_v1","std.db.spec.resp_op_v1"]},{"body":["begin",["if",["<",["view.len","caps"],24],["return",0],0],["let","m",["std.db.spec._magic_evdc_v1"]],["if",["!=",["view.get_u8","caps",0],["bytes.get_u8","m",0]],["return",0],0],["if",["!=",["view.get_u8","caps",1],["bytes.get_u8","m",1]],["return",0],0],["if",["!=",["view.get_u8","caps",2],["bytes.get_u8","m",2]],["return",0],0],["if",["!=",["view.get_u8","caps",3],["bytes.get_u8","m",3]],["return",0],0],["if",["!=",["codec.read_u32_le","caps",4],1],["return",0],0],1],"kind":"defn","name":"std.db.spec._caps_is_v1","params":[{"name":"caps","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","b",["bytes.alloc",4]],["set","b",["bytes.set_u8","b",0,69]],["set","b",["bytes.set_u8","b",1,86]],["set","b",["bytes.set_u8","b",2,68]],["set","b",["bytes.set_u8","b",3,66]],"b"],"kind":"defn","name":"std.db.spec._magic_evdb_v1","params":[],"result":"bytes"},{"body":["begin",["let","b",["bytes.alloc",4]],["set","b",["bytes.set_u8","b",0,69]],["set","b",["bytes.set_u8","b",1,86]],["set","b",["bytes.set_u8","b",2,68]],["set","b",["bytes.set_u8","b",3,67]],"b"],"kind":"defn","name":"std.db.spec._magic_evdc_v1","params":[],"result":"bytes"},{"body":["codec.read_u32_le","b","off"],"kind":"defn","name":"std.db.spec._u32_at","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["if",["=",["std.db.spec._caps_is_v1","caps"],1],["codec.read_u32_le","caps",8],0],"kind":"defn","name":"std.db.spec.caps_connect_timeout_ms_v1","params":[{"name":"caps","ty":"bytes_view"}],"result":"i32"},{"body":["std.db.spec.caps_pack_v1",0,0,0,0],"kind":"defn","name":"std.db.spec.caps_default_v1","params":[],"result":"bytes"},{"body":["if",["=",["std.db.spec._caps_is_v1","caps"],1],["codec.read_u32_le","caps",20],0],"kind":"defn","name":"std.db.spec.caps_max_resp_bytes_v1","params":[{"name":"caps","ty":"bytes_view"}],"result":"i32"},{"body":["if",["=",["std.db.spec._caps_is_v1","caps"],1],["codec.read_u32_le","caps",16],0],"kind":"defn","name":"std.db.spec.caps_max_rows_v1","params":[{"name":"caps","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","ct",["if",["<","connect_timeout_ms",0],0,"connect_timeout_ms"]],["let","qt",["if",["<","query_timeout_ms",0],0,"query_timeout_ms"]],["let","mr",["if",["<","max_rows",0],0,"max_rows"]],["let","mb",["if",["<","max_resp_bytes",0],0,"max_resp_bytes"]],["let","magic",["std.db.spec._magic_evdc_v1"]],["let","out",["vec_u8.with_capacity",24]],["set","out",["vec_u8.extend_bytes","out","magic"]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","ct"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","qt"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","mr"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","mb"]]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"std.db.spec.caps_pack_v1","params":[{"name":"connect_timeout_ms","ty":"i32"},{"name":"query_timeout_ms","ty":"i32"},{"name":"max_rows","ty":"i32"},{"name":"max_resp_bytes","ty":"i32"}],"result":"bytes"},{"body":["if",["=",["std.db.spec._caps_is_v1","caps"],1],["codec.read_u32_le","caps",12],0],"kind":"defn","name":"std.db.spec.caps_query_timeout_ms_v1","params":[{"name":"caps","ty":"bytes_view"}],"result":"i32"},{"body":[">>u","conn",24],"kind":"defn","name":"std.db.spec.conn_driver_v1","params":[{"name":"conn","ty":"i32"}],"result":"i32"},{"body":["+","raw_id",["<<u","driver_id",24]],"kind":"defn","name":"std.db.spec.conn_pack_v1","params":[{"name":"driver_id","ty":"i32"},{"name":"raw_id","ty":"i32"}],"result":"i32"},{"body":["begin",["let","d",["std.db.spec.conn_driver_v1","conn"]],["-","conn",["<<u","d",24]]],"kind":"defn","name":"std.db.spec.conn_raw_v1","params":[{"name":"conn","ty":"i32"}],"result":"i32"},{"body":3,"kind":"defn","name":"std.db.spec.driver_mysql_v1","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"std.db.spec.driver_pg_v1","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"std.db.spec.driver_redis_v1","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"std.db.spec.driver_sqlite_v1","params":[],"result":"i32"},{"body":4,"kind":"defn","name":"std.db.spec.op_close_v1","params":[],"result":"i32"},{"body":2,"kind":"defn","name":"std.db.spec.op_exec_v1","params":[],"result":"i32"},{"body":1,"kind":"defn","name":"std.db.spec.op_open_v1","params":[],"result":"i32"},{"body":61,"kind":"defn","name":"std.db.spec.op_pool_close_v1","params":[],"result":"i32"},{"body":60,"kind":"defn","name":"std.db.spec.op_pool_new_v1","params":[],"result":"i32"},{"body":3,"kind":"defn","name":"std.db.spec.op_query_v1","params":[],"result":"i32"},{"body":["begin",["let","n",["bytes.len","doc"]],["if",["<u","n",20],["return",2000600003],0],["let","magic",["std.db.spec._magic_evdb_v1"]],["if",["=",["bytes.eq",["bytes.slice","doc",0,4],"magic"],1],0,["return",2000600001]],["let","ver",["codec.read_u32_le","doc",4]],["if",["=","ver",1],0,["return",2000600002]],["let","tag",["codec.read_u32_le","doc",8]],["if",["<u","tag",2],0,["return",2000600004]],0],"kind":"defn","name":"std.db.spec.resp_check_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["std.db.spec.resp_check_v1","doc"],0],0,["return",0]],["if",["=",["codec.read_u32_le","doc",8],0],["codec.read_u32_le","doc",16],0]],"kind":"defn","name":"std.db.spec.resp_err_code_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["if",["=",["std.db.spec.resp_check_v1","doc"],0],0,["return",["bytes.alloc",0]]],["if",["=",["codec.read_u32_le","doc",8],0],["begin",["let","m_len",["codec.read_u32_le","doc",20]],["bytes.slice","doc",24,"m_len"]],["bytes.alloc",0]]],"kind":"defn","name":"std.db.spec.resp_err_msg_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","magic",["std.db.spec._magic_evdb_v1"]],["let","m_len",["bytes.len","msg"]],["let","out",["vec_u8.with_capacity",["+",4,["+",4,["+",4,["+",4,["+",4,["+",4,"m_len"]]]]]]]],["set","out",["vec_u8.extend_bytes","out","magic"]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",0]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","op"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","err_code"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","m_len"]]],["set","out",["vec_u8.extend_bytes","out","msg"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"std.db.spec.resp_err_v1","params":[{"name":"op","ty":"i32"},{"name":"err_code","ty":"i32"},{"name":"msg","ty":"bytes"}],"result":"bytes"},{"body":["if",["=",["std.db.spec.resp_check_v1","doc"],0],["if",["=",["codec.read_u32_le","doc",8],1],1,0],0],"kind":"defn","name":"std.db.spec.resp_is_ok_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","v",["std.db.spec.resp_ok_payload_view_v1","doc"]],["view.to_bytes","v"]],"kind":"defn","name":"std.db.spec.resp_ok_payload_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["if",["=",["std.db.spec.resp_check_v1","doc"],0],0,["return",["view.slice","doc",0,0]]],["if",["=",["codec.read_u32_le","doc",8],1],["begin",["let","p_len",["codec.read_u32_le","doc",16]],["view.slice","doc",20,"p_len"]],["view.slice","doc",0,0]]],"kind":"defn","name":"std.db.spec.resp_ok_payload_view_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"bytes_view"},{"body":["begin",["let","magic",["std.db.spec._magic_evdb_v1"]],["let","p_len",["bytes.len","payload"]],["let","out",["vec_u8.with_capacity",["+",4,["+",4,["+",4,["+",4,["+",4,"p_len"]]]]]]],["set","out",["vec_u8.extend_bytes","out","magic"]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le",1]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","op"]]],["set","out",["vec_u8.extend_bytes","out",["codec.write_u32_le","p_len"]]],["set","out",["vec_u8.extend_bytes","out","payload"]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"std.db.spec.resp_ok_v1","params":[{"name":"op","ty":"i32"},{"name":"payload","ty":"bytes"}],"result":"bytes"},{"body":["if",["=",["std.db.spec.resp_check_v1","doc"],0],["codec.read_u32_le","doc",12],0],"kind":"defn","name":"std.db.spec.resp_op_v1","params":[{"name":"doc","ty":"bytes_view"}],"result":"i32"}],"imports":["ext.data_model","std.codec","std.vec"],"kind":"module","module_id":"std.db.spec","schema_version":"x07.x07ast@0.3.0"}
