{"decls":[{"body":["begin",["let","key2",["std.bytes.copy","key"]],["let","body",["std.rr.fetch","key"]],["std.kv.set","key2","body"],["bytes.empty"]],"kind":"defasync","name":"main.fetch_and_store","params":[{"name":"key","ty":"bytes"}],"result":"bytes"}],"imports":["std.bytes","std.io","std.kv","std.rr"],"kind":"entry","module_id":"main","schema_version":"x07.x07ast@0.1.0","solve":["begin",["let","n_input",["bytes.len","input"]],["if",["<u","n_input",1],["bytes.empty"],["begin",["let","n",["bytes.get_u8","input",0]],["if",["<u","n_input",["+",1,"n"]],["bytes.empty"],["begin",["let","keys_off",1],["let","seen",["set_u32.new",16]],["let","handles",["map_u32.new",16]],["for","i",0,"n",["begin",["let","key_u8",["bytes.get_u8","input",["+","keys_off","i"]]],["if",["=",["set_u32.contains","seen","key_u8"],0],["begin",["set_u32.add","seen","key_u8"],["let","key",["bytes.alloc",1]],["set","key",["bytes.set_u8","key",0,"key_u8"]],["let","h",["main.fetch_and_store","key"]],["task.spawn","h"],["map_u32.set","handles","key_u8","h"],0],0],0]],["let","joined",["set_u32.new",16]],["for","i",0,"n",["begin",["let","key_u8",["bytes.get_u8","input",["+","keys_off","i"]]],["if",["=",["set_u32.contains","joined","key_u8"],0],["begin",["set_u32.add","joined","key_u8"],["let","h",["map_u32.get","handles","key_u8",0]],["await","h"],0],0],0]],["let","out",["vec_u8.with_capacity",0]],["for","i",0,"n",["begin",["let","key_u8",["bytes.get_u8","input",["+","keys_off","i"]]],["let","key",["bytes.alloc",1]],["set","key",["bytes.set_u8","key",0,"key_u8"]],["let","body",["std.kv.get","key"]],["set","out",["vec_u8.extend_bytes","out","body"]],0]],["vec_u8.into_bytes","out"]]]]]]}
