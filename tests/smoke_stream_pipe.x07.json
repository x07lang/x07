{"decls":[{"kind":"export","names":["smoke_stream_pipe._assert_err_code_v1","smoke_stream_pipe._assert_ok_doc_v1","smoke_stream_pipe.pipe_bytes_budget_items","smoke_stream_pipe.pipe_bytes_collect_identity","smoke_stream_pipe.pipe_bytes_filter_collect","smoke_stream_pipe.pipe_bytes_frame_u32le_collect","smoke_stream_pipe.pipe_bytes_hash_fnv1a32","smoke_stream_pipe.pipe_bytes_map_bytes_collect","smoke_stream_pipe.pipe_bytes_split_lines_collect","smoke_stream_pipe.pipe_bytes_split_lines_line_too_long","smoke_stream_pipe.pipe_bytes_take_collect","smoke_stream_pipe.pipe_bytes_u32frames_collect"]},{"body":["begin",["let","dv",["bytes.view","doc"]],["try",["std.test.assert_i32_eq",["view.get_u8","dv",0],0,["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",1],"code",["std.test.code_assert_i32_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_stream_pipe._assert_err_code_v1","params":[{"name":"doc","ty":"bytes"},{"name":"code","ty":"i32"}],"result":"result_i32"},{"body":["begin",["let","dv",["bytes.view","doc"]],["try",["std.test.assert_i32_eq",["view.get_u8","dv",0],1,["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",1],"bytes_in",["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",5],"bytes_out",["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",9],"items_in",["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",13],"items_out",["std.test.code_assert_i32_eq"]]],["let","pl_len",["codec.read_u32_le","dv",17]],["try",["std.test.assert_i32_eq","pl_len",["bytes.len","payload"],["std.test.code_assert_i32_eq"]]],["let","pl_view",["view.slice","dv",21,"pl_len"]],["try",["std.test.assert_bytes_eq",["view.to_bytes","pl_view"],"payload",["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_stream_pipe._assert_ok_doc_v1","params":[{"name":"doc","ty":"bytes"},{"name":"bytes_in","ty":"i32"},{"name":"bytes_out","ty":"i32"},{"name":"items_in","ty":"i32"},{"name":"items_out","ty":"i32"},{"name":"payload","ty":"bytes"}],"result":"result_i32"},{"body":["view.to_bytes","x"],"kind":"defn","name":"smoke_stream_pipe._map_id_copy","params":[{"name":"x","ty":"bytes_view"}],"result":"bytes"},{"body":["if",["=",["view.len","x"],0],0,1],"kind":"defn","name":"smoke_stream_pipe._pred_nonempty","params":[{"name":"x","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","in",["bytes.lit","a\nb\n"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",1]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",64]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_err_code_v1","doc",4]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_budget_items","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","abc"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1"],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",3,3,1,1,["bytes.lit","abc"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_collect_identity","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","\nX\n"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",64]],["std.stream.xf.filter_v1",["std.stream.fn_v1","smoke_stream_pipe._pred_nonempty"]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",3,1,1,1,["bytes.lit","X"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_filter_collect","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","hi"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.frame_u32le_v1"]],["std.stream.sink.collect_bytes_v1"]]],["let","exp",["vec_u8.with_capacity",6]],["set","exp",["vec_u8.extend_bytes","exp",["codec.write_u32_le",2]]],["set","exp",["vec_u8.extend_bytes","exp",["bytes.lit","hi"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",2,6,1,1,["vec_u8.into_bytes","exp"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_frame_u32le_collect","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","abc"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1"],["std.stream.sink.hash_fnv1a32_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",3,3,1,1,["codec.write_u32_le",440920331]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_hash_fnv1a32","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","abc"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.map_bytes_v1",["std.stream.fn_v1","smoke_stream_pipe._map_id_copy"]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",3,3,1,1,["bytes.lit","abc"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_map_bytes_collect","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","a\nb\n"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",64]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",4,2,1,2,["bytes.lit","ab"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_split_lines_collect","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","abc"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",2]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_err_code_v1","doc",5]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_split_lines_line_too_long","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","a\nb\nc\n"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",64]],["std.stream.xf.take_v1",["std.stream.expr_v1",2]]],["std.stream.sink.collect_bytes_v1"]]],["smoke_stream_pipe._assert_ok_doc_v1","doc",6,2,1,2,["bytes.lit","ab"]]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_take_collect","params":[],"result":"result_i32"},{"body":["begin",["let","in",["bytes.lit","a\nb\n"]],["let","doc",["std.stream.pipe_v1",["std.stream.cfg_v1",["chunk_max_bytes",64],["bufread_cap_bytes",64],["max_in_bytes",64],["max_out_bytes",64],["max_items",10]],["std.stream.src.bytes_v1",["std.stream.expr_v1","in"]],["std.stream.chain_v1",["std.stream.xf.split_lines_v1",["std.stream.expr_v1",10],["std.stream.expr_v1",64]]],["std.stream.sink.u32frames_v1",["std.stream.sink.collect_bytes_v1"]]]],["let","dv",["bytes.view","doc"]],["try",["std.test.assert_i32_eq",["view.get_u8","dv",0],1,["std.test.code_assert_i32_eq"]]],["try",["std.test.assert_i32_eq",["codec.read_u32_le","dv",5],10,["std.test.code_assert_i32_eq"]]],["let","pl_len",["codec.read_u32_le","dv",17]],["try",["std.test.assert_i32_eq","pl_len",10,["std.test.code_assert_i32_eq"]]],["let","pl",["view.slice","dv",21,10]],["let","plb",["view.to_bytes","pl"]],["let","exp",["vec_u8.with_capacity",10]],["set","exp",["vec_u8.extend_bytes","exp",["codec.write_u32_le",1]]],["set","exp",["vec_u8.extend_bytes","exp",["bytes.lit","a"]]],["set","exp",["vec_u8.extend_bytes","exp",["codec.write_u32_le",1]]],["set","exp",["vec_u8.extend_bytes","exp",["bytes.lit","b"]]],["try",["std.test.assert_bytes_eq","plb",["vec_u8.into_bytes","exp"],["std.test.code_assert_bytes_eq"]]],["std.test.pass"]],"kind":"defn","name":"smoke_stream_pipe.pipe_bytes_u32frames_collect","params":[],"result":"result_i32"}],"imports":["std.test"],"kind":"module","module_id":"smoke_stream_pipe","schema_version":"x07.x07ast@0.3.0"}
