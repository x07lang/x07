{"decls":[],"imports":["ext.data_model","ext.hex","std.db","std.db.params","std.db.spec","std.db.sqlite"],"kind":"entry","module_id":"main","schema_version":"x07.x07ast@0.2.0","solve":["begin",["let","caps",["std.db.sqlite.caps_default_v1"]],["let","sql_create",["begin",["let","hex",["bytes.lit","435245415445205441424c45207428696420494e5445474552205052494d415259204b45592c762054455854293b"]],["let","doc",["ext.hex.hex_decode",["bytes.view","hex"]]],["ext.hex.hex_get_bytes",["bytes.view","doc"]]]],["let","sql_ins1",["begin",["let","hex",["bytes.lit","494e5345525420494e544f20742876292056414c55455328276127293b"]],["let","doc",["ext.hex.hex_decode",["bytes.view","hex"]]],["ext.hex.hex_get_bytes",["bytes.view","doc"]]]],["let","sql_ins2",["begin",["let","hex",["bytes.lit","494e5345525420494e544f20742876292056414c55455328276227293b"]],["let","doc",["ext.hex.hex_decode",["bytes.view","hex"]]],["ext.hex.hex_get_bytes",["bytes.view","doc"]]]],["let","sql_query_items",["begin",["let","hex",["bytes.lit","53454c4543542069642c6e616d652c6e2c7061796c6f61642c6e6f74652046524f4d206974656d73204f524445522042592069643b"]],["let","doc",["ext.hex.hex_decode",["bytes.view","hex"]]],["ext.hex.hex_get_bytes",["bytes.view","doc"]]]],["let","open_mem_resp",["std.db.sqlite.open_v1",["bytes.lit",":memory:"],0,"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","open_mem_resp"],0],["return",["bytes.lit","FAIL_open_mem"]],0],["let","conn_mem",["std.db.open_handle_v1","open_mem_resp"]],["let","resp_create",["std.db.exec_v1","conn_mem","sql_create",["std.db.params.empty_v1"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","resp_create"],0],["return",["bytes.lit","FAIL_create"]],0],["let","resp_ins1",["std.db.exec_v1","conn_mem","sql_ins1",["std.db.params.empty_v1"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","resp_ins1"],0],["return",["bytes.lit","FAIL_ins1"]],0],["if",["!=",["std.db.exec_rows_affected_v1","resp_ins1"],1],["return",["bytes.lit","FAIL_ins1_ra"]],0],["let","resp_ins2",["std.db.exec_v1","conn_mem","sql_ins2",["std.db.params.empty_v1"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","resp_ins2"],0],["return",["bytes.lit","FAIL_ins2"]],0],["if",["!=",["std.db.exec_rows_affected_v1","resp_ins2"],1],["return",["bytes.lit","FAIL_ins2_ra"]],0],["let","close_mem_resp",["std.db.close_v1","conn_mem","caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","close_mem_resp"],0],["return",["bytes.lit","FAIL_close_mem"]],0],["let","open_resp",["std.db.open_v1",["bytes.lit","sqlite:benchmarks/fixtures/db/sqlite/v1/app.db"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","open_resp"],0],["return",["bytes.lit","FAIL_open"]],0],["let","conn",["std.db.open_handle_v1","open_resp"]],["let","query_resp",["std.db.query_v1","conn","sql_query_items",["std.db.params.empty_v1"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","query_resp"],0],["return",["bytes.lit","FAIL_query"]],0],["let","got_doc",["std.db.spec.resp_ok_payload_v1","query_resp"]],["let","c_id",["begin",["let","s",["bytes.lit","id"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","c_name",["begin",["let","s",["bytes.lit","name"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","c_n",["begin",["let","s",["bytes.lit","n"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","c_payload",["begin",["let","s",["bytes.lit","payload"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","c_note",["begin",["let","s",["bytes.lit","note"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","cols_elems",["vec_u8.with_capacity",0]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",5]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",["bytes.len","c_id"]]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems","c_id"]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",["bytes.len","c_name"]]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems","c_name"]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",["bytes.len","c_n"]]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems","c_n"]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",["bytes.len","c_payload"]]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems","c_payload"]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems",["codec.write_u32_le",["bytes.len","c_note"]]]],["set","cols_elems",["vec_u8.extend_bytes","cols_elems","c_note"]],["let","cols_elems_b",["vec_u8.into_bytes","cols_elems"]],["let","cols_val",["ext.data_model.value_seq_from_elems",["bytes.view","cols_elems_b"]]],["let","n1",["begin",["let","s",["bytes.lit","1"]],["ext.data_model.value_number",["bytes.view","s"]]]],["let","n2",["begin",["let","s",["bytes.lit","2"]],["ext.data_model.value_number",["bytes.view","s"]]]],["let","n3",["begin",["let","s",["bytes.lit","3"]],["ext.data_model.value_number",["bytes.view","s"]]]],["let","s_alpha",["begin",["let","s",["bytes.lit","alpha"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","s_beta",["begin",["let","s",["bytes.lit","beta"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","s_gamma",["begin",["let","s",["bytes.lit","gamma"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","blob1",["bytes.alloc",3]],["set","blob1",["bytes.set_u8","blob1",0,0]],["set","blob1",["bytes.set_u8","blob1",1,1]],["set","blob1",["bytes.set_u8","blob1",2,2]],["let","v_blob1",["ext.data_model.value_string",["bytes.view","blob1"]]],["let","blob2",["bytes.alloc",1]],["set","blob2",["bytes.set_u8","blob2",0,255]],["let","v_blob2",["ext.data_model.value_string",["bytes.view","blob2"]]],["let","blob3",["bytes.alloc",0]],["let","v_blob3",["ext.data_model.value_string",["bytes.view","blob3"]]],["let","nullv",["ext.data_model.value_null"]],["let","sx",["begin",["let","s",["bytes.lit","x"]],["ext.data_model.value_string",["bytes.view","s"]]]],["let","sempty",["begin",["let","b",["bytes.alloc",0]],["ext.data_model.value_string",["bytes.view","b"]]]],["let","row1_elems",["vec_u8.with_capacity",0]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",5]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",["bytes.len","n1"]]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems","n1"]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",["bytes.len","s_alpha"]]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems","s_alpha"]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",["bytes.len","n1"]]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems","n1"]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",["bytes.len","v_blob1"]]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems","v_blob1"]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems",["codec.write_u32_le",["bytes.len","nullv"]]]],["set","row1_elems",["vec_u8.extend_bytes","row1_elems","nullv"]],["let","row1_elems_b",["vec_u8.into_bytes","row1_elems"]],["let","row1",["ext.data_model.value_seq_from_elems",["bytes.view","row1_elems_b"]]],["let","row2_elems",["vec_u8.with_capacity",0]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",5]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",["bytes.len","n2"]]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems","n2"]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",["bytes.len","s_beta"]]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems","s_beta"]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",["bytes.len","n2"]]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems","n2"]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",["bytes.len","v_blob2"]]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems","v_blob2"]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems",["codec.write_u32_le",["bytes.len","sx"]]]],["set","row2_elems",["vec_u8.extend_bytes","row2_elems","sx"]],["let","row2_elems_b",["vec_u8.into_bytes","row2_elems"]],["let","row2",["ext.data_model.value_seq_from_elems",["bytes.view","row2_elems_b"]]],["let","row3_elems",["vec_u8.with_capacity",0]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",5]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",["bytes.len","n3"]]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems","n3"]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",["bytes.len","s_gamma"]]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems","s_gamma"]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",["bytes.len","n3"]]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems","n3"]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",["bytes.len","v_blob3"]]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems","v_blob3"]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems",["codec.write_u32_le",["bytes.len","sempty"]]]],["set","row3_elems",["vec_u8.extend_bytes","row3_elems","sempty"]],["let","row3_elems_b",["vec_u8.into_bytes","row3_elems"]],["let","row3",["ext.data_model.value_seq_from_elems",["bytes.view","row3_elems_b"]]],["let","rows_elems",["vec_u8.with_capacity",0]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems",["codec.write_u32_le",3]]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems",["codec.write_u32_le",["bytes.len","row1"]]]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems","row1"]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems",["codec.write_u32_le",["bytes.len","row2"]]]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems","row2"]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems",["codec.write_u32_le",["bytes.len","row3"]]]],["set","rows_elems",["vec_u8.extend_bytes","rows_elems","row3"]],["let","rows_elems_b",["vec_u8.into_bytes","rows_elems"]],["let","rows_val",["ext.data_model.value_seq_from_elems",["bytes.view","rows_elems_b"]]],["let","entries",["vec_u8.with_capacity",0]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",2]]],["let","k_cols",["bytes.lit","cols"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","k_cols"]]]],["set","entries",["vec_u8.extend_bytes","entries","k_cols"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","cols_val"]]]],["set","entries",["vec_u8.extend_bytes","entries","cols_val"]],["let","k_rows",["bytes.lit","rows"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","k_rows"]]]],["set","entries",["vec_u8.extend_bytes","entries","k_rows"]],["set","entries",["vec_u8.extend_bytes","entries",["codec.write_u32_le",["bytes.len","rows_val"]]]],["set","entries",["vec_u8.extend_bytes","entries","rows_val"]],["let","entries_b",["vec_u8.into_bytes","entries"]],["let","map_val",["ext.data_model.value_map_from_entries",["bytes.view","entries_b"]]],["let","expected_doc",["ext.data_model.doc_ok",["bytes.view","map_val"]]],["if",["=",["bytes.eq","got_doc","expected_doc"],0],["return",["bytes.lit","FAIL_doc_mismatch"]],0],["let","close_resp",["std.db.close_v1","conn","caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","close_resp"],0],["return",["bytes.lit","FAIL_close"]],0],["bytes.lit","OK"]]}
