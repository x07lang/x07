{"decls":[],"imports":["ext.data_model","std.db","std.db.redis","std.db.redis.argv","std.db.redis.spec","std.db.spec"],"kind":"entry","module_id":"main","schema_version":"x07.x07ast@0.2.0","solve":["begin",["let","caps",["std.db.spec.caps_default_v1"]],["let","host",["bytes.lit","127.0.0.1"]],["let","u",["bytes.alloc",0]],["let","p",["bytes.alloc",0]],["let","open_resp",["std.db.redis.open_tcp_v1","host",6379,"u","p",0,"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","open_resp"],0],["return",["bytes.lit","FAIL_open"]],0],["let","conn",["std.db.open_handle_v1","open_resp"]],["let","ping",["bytes.lit","PING"]],["let","argv",["std.db.redis.argv.from1_v1",["bytes.view","ping"]]],["let","resp",["std.db.redis.cmd_v1","conn","argv",["std.db.redis.spec.flags_none_v1"],"caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","resp"],0],["return",["bytes.lit","FAIL_cmd"]],0],["let","doc",["std.db.redis.cmd_doc_v1","resp"]],["let","pong",["bytes.lit","PONG"]],["let","v_pong",["ext.data_model.value_string",["bytes.view","pong"]]],["let","expected_doc",["ext.data_model.doc_ok",["bytes.view","v_pong"]]],["if",["=",["bytes.eq","doc","expected_doc"],0],["return",["bytes.lit","FAIL_doc_mismatch"]],0],["let","close_resp",["std.db.redis.close_v1","conn","caps"]],["if",["=",["std.db.spec.resp_is_ok_v1","close_resp"],0],["return",["bytes.lit","FAIL_close"]],0],["bytes.lit","OK"]]}
