{"decls":[],"imports":["std.net.codec","std.net.err","std.net.io","std.net.tcp","std.net.tls"],"kind":"entry","module_id":"main","schema_version":"x07.x07ast@0.3.0","solve":["begin",["let","caps",["std.net.codec.caps_default_v1"]],["let","caps_v",["bytes.view","caps"]],["let","addr",["std.net.codec.addr_ipv4_v1",127,0,0,1,30030]],["let","addr_v",["bytes.view","addr"]],["let","empty",["bytes.alloc",0]],["let","empty_v",["bytes.view","empty"]],["let","doc1",["std.net.tls.connect_v1","addr_v","empty_v","caps_v"]],["let","dv1",["bytes.view","doc1"]],["if",["=",["std.net.err.is_err_doc_v1","dv1"],0],["return",["bytes.lit","err"]],0],["if",["!=",["std.net.err.err_code_v1","dv1"],["std.net.err.code_invalid_req_v1"]],["return",["bytes.lit","err"]],0],["let","cfg",["std.net.tls.client_cfg_v1",0,"empty_v"]],["let","cfg_v",["bytes.view","cfg"]],["let","doc2",["std.net.tls.connect_v1","addr_v","cfg_v","caps_v"]],["let","dv2",["bytes.view","doc2"]],["if",["std.net.err.is_err_doc_v1","dv2"],["return",["bytes.lit","err"]],0],["let","h",["std.net.tls.connect_stream_handle_v1","dv2"]],["if",["<=","h",0],["return",["bytes.lit","err"]],0],["let","msg",["bytes.lit","ping"]],["let","wdoc",["std.net.io.write_all_v1","h",["bytes.view","msg"],"caps_v"]],["let","wdoc_v",["bytes.view","wdoc"]],["if",["std.net.err.is_err_doc_v1","wdoc_v"],["return",["bytes.lit","err"]],0],["if",["!=",["std.net.tcp.stream_write_bytes_written_v1","wdoc_v"],["bytes.len","msg"]],["return",["bytes.lit","err"]],0],["let","rdoc",["std.net.tcp.stream_read_v1","h",1024,"caps_v"]],["let","rdoc_v",["bytes.view","rdoc"]],["if",["std.net.err.is_err_doc_v1","rdoc_v"],["return",["bytes.lit","err"]],0],["let","got",["std.net.tcp.stream_read_payload_v1","rdoc_v"]],["if",["=",["bytes.eq",["bytes.view","got"],["bytes.view","msg"]],0],["return",["bytes.lit","err"]],0],["std.net.tcp.stream_close_v1","h"],["std.net.tcp.stream_drop_v1","h"],["bytes.lit","ok"]]}
