{"decls":[{"kind":"export","names":["std.json.canonicalize_small","std.json.extract_path_canon_or_err"]},{"body":["std.slice.cmp_bytes",["std.json._member_key","members","offsets","a"],["std.json._member_key","members","offsets","b"]],"kind":"defn","name":"std.json._cmp_member_key","params":[{"name":"members","ty":"bytes"},{"name":"offsets","ty":"bytes"},{"name":"a","ty":"i32"},{"name":"b","ty":"i32"}],"result":"i32"},{"body":["begin",["let","off",["codec.read_u32_le","offsets",["*","idx",4]]],["let","key_len",["codec.read_u32_le","members","off"]],["let","key_start",["+","off",4]],["let","key",["bytes.slice","members","key_start","key_len"]],["let","val_len_off",["+","key_start","key_len"]],["let","val_len",["codec.read_u32_le","members","val_len_off"]],["let","val_start",["+","val_len_off",4]],["let","val",["bytes.slice","members","val_start","val_len"]],["vec_u8.push","out",34],["vec_u8.extend_bytes","out","key"],["vec_u8.push","out",34],["vec_u8.push","out",58],["vec_u8.extend_bytes","out","val"],"out"],"kind":"defn","name":"std.json._emit_member_kv","params":[{"name":"members","ty":"bytes"},{"name":"offsets","ty":"bytes"},{"name":"idx","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["vec_u8.push","out",123],["let","used",["bytes.alloc","count"]],["let","first",1],["for","_",0,"count",["begin",["let","best",-1],["for","j",0,"count",["begin",["if",["=",["bytes.get_u8","used","j"],1],0,["if",["=","best",-1],["set","best","j"],["if",["<",["std.json._cmp_member_key","members","offsets","j","best"],0],["set","best","j"],0]]],0]],["bytes.set_u8","used","best",1],["if",["=","first",0],["vec_u8.push","out",44],["set","first",0]],["std.json._emit_member_kv","members","offsets","best","out"],0]],["vec_u8.push","out",125],"out"],"kind":"defn","name":"std.json._emit_object_sorted","params":[{"name":"members","ty":"bytes"},{"name":"offsets","ty":"bytes"},{"name":"count","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["bytes.lit","ERR"],"kind":"defn","name":"std.json._err","params":[],"result":"bytes"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i",["std.json._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",-1],0],["let","target",["std.json._segment_at","segs","seg_idx"]],["if",["=",["bytes.len","target"],0],["return",-1],0],["if",["=",["bytes.get_u8","b","i"],125],["return",-1],0],["for","_",0,["+","n",1],["begin",["if",[">=u","i","n"],["return",-1],0],["if",["=",["bytes.get_u8","b","i"],34],0,["return",-1]],["let","key_start",["+","i",1]],["let","key_end",["std.json._string_end_or_err","b","key_start"]],["if",["<","key_end",0],["return",-1],0],["let","key_len",["-","key_end","key_start"]],["let","key",["bytes.slice","b","key_start","key_len"]],["set","i",["+","key_end",1]],["set","i",["std.json._skip_ws","b","i"]],["if",["if",[">=u","i","n"],1,["=",["bytes.get_u8","b","i"],58]],0,["return",-1]],["set","i",["+","i",1]],["if",["bytes.eq","key","target"],["begin",["let","next_idx",["+","seg_idx",1]],["let","end",["std.json._extract_from_value","b","i","segs","next_idx","seg_count","out"]],["if",["<","end",0],["return",-1],["return","end"]]],["begin",["let","tmp",["vec_u8.with_capacity",0]],["let","end",["std.json._parse_value","b","i","tmp"]],["if",["<","end",0],["return",-1],["set","i",["std.json._skip_ws","b","end"]]]]],["if",[">=u","i","n"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",44],["set","i",["std.json._skip_ws","b",["+","i",1]]],["if",["=","c",125],["return",-1],["return",-1]]],0]],-1],"kind":"defn","name":"std.json._extract_from_object","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"segs","ty":"bytes"},{"name":"seg_idx","ty":"i32"},{"name":"seg_count","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i",["std.json._skip_ws","b","off"]],["if",[">=u","i","n"],["return",-1],0],["if",["=","seg_idx","seg_count"],["std.json._parse_value","b","i","out"],["if",["=",["bytes.get_u8","b","i"],123],["std.json._extract_from_object","b","i","segs","seg_idx","seg_count","out"],-1]]],"kind":"defn","name":"std.json._extract_from_value","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"segs","ty":"bytes"},{"name":"seg_idx","ty":"i32"},{"name":"seg_count","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["for","i",0,"n",["begin",["if",["=",["bytes.get_u8","b","i"],"target"],["return","i"],0],0]],-1],"kind":"defn","name":"std.json._find_byte","params":[{"name":"b","ty":"bytes"},{"name":"target","ty":"i32"}],"result":"i32"},{"body":["if",[">=u","c",48],["if",["<u","c",58],1,0],0],"kind":"defn","name":"std.json._is_digit","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["if",["=","c",32],1,["if",["=","c",9],1,["if",["=","c",10],1,["if",["=","c",13],1,0]]]],"kind":"defn","name":"std.json._is_ws","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","m",["bytes.len","lit"]],["if",[">=u",["+","off","m"],["+","n",1]],["return",0],0],["for","i",0,"m",["begin",["if",["=",["bytes.get_u8","b",["+","off","i"]],["bytes.get_u8","lit","i"]],0,["return",0]],0]],1],"kind":"defn","name":"std.json._match_bytes_at","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"lit","ty":"bytes"}],"result":"i32"},{"body":["begin",["let","off",["codec.read_u32_le","offsets",["*","idx",4]]],["let","key_len",["codec.read_u32_le","members","off"]],["bytes.slice","members",["+","off",4],"key_len"]],"kind":"defn","name":"std.json._member_key","params":[{"name":"members","ty":"bytes"},{"name":"offsets","ty":"bytes"},{"name":"idx","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["bytes.len","b"]],["vec_u8.push","out",91],["let","i",["std.json._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",-1],0],["if",["=",["bytes.get_u8","b","i"],93],["begin",["vec_u8.push","out",93],["return",["+","i",1]]],0],["let","first",1],["for","_",0,["+","n",1],["begin",["if",["=","first",0],["vec_u8.push","out",44],["set","first",0]],["set","i",["std.json._parse_value","b","i","out"]],["if",["<","i",0],["return",-1],0],["set","i",["std.json._skip_ws","b","i"]],["if",[">=u","i","n"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",44],["set","i",["std.json._skip_ws","b",["+","i",1]]],["if",["=","c",93],["begin",["vec_u8.push","out",93],["return",["+","i",1]]],["return",-1]]],0]],-1],"kind":"defn","name":"std.json._parse_array","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["if",["std.json._match_bytes_at","b","off","lit"],["begin",["vec_u8.extend_bytes","out","lit"],["+","off",["bytes.len","lit"]]],-1]],"kind":"defn","name":"std.json._parse_lit","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"lit","ty":"bytes"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i","off"],["if",["=",["bytes.get_u8","b","i"],45],["begin",["set","i",["+","i",1]],["if",[">=u","i","n"],["return",-1],0]],0],["if",[">=u","i","n"],["return",-1],0],["let","d0",["bytes.get_u8","b","i"]],["if",["=",["std.json._is_digit","d0"],0],["return",-1],0],["if",["=","d0",48],["begin",["set","i",["+","i",1]],["if",["if",["<u","i","n"],["std.json._is_digit",["bytes.get_u8","b","i"]],0],["return",-1],0]],["begin",["set","i",["+","i",1]],["let","done",0],["for","_",0,"n",["begin",["if","done",0,["if",[">=u","i","n"],["set","done",1],["if",["std.json._is_digit",["bytes.get_u8","b","i"]],["set","i",["+","i",1]],["set","done",1]]]],0]]]],["vec_u8.extend_bytes","out",["bytes.slice","b","off",["-","i","off"]]],"i"],"kind":"defn","name":"std.json._parse_number","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i",["std.json._skip_ws","b",["+","off",1]]],["if",[">=u","i","n"],["return",-1],0],["if",["=",["bytes.get_u8","b","i"],125],["begin",["vec_u8.push","out",123],["vec_u8.push","out",125],["return",["+","i",1]]],0],["let","members",["vec_u8.with_capacity",0]],["let","offsets",["vec_u8.with_capacity",0]],["let","count",0],["for","_",0,["+","n",1],["begin",["if",[">=u","i","n"],["return",-1],0],["if",["=",["bytes.get_u8","b","i"],34],0,["return",-1]],["let","key_start",["+","i",1]],["let","key_end",["std.json._string_end_or_err","b","key_start"]],["if",["<","key_end",0],["return",-1],0],["let","key_len",["-","key_end","key_start"]],["set","i",["+","key_end",1]],["set","i",["std.json._skip_ws","b","i"]],["if",["if",[">=u","i","n"],1,["=",["bytes.get_u8","b","i"],58]],0,["return",-1]],["set","i",["+","i",1]],["let","val_vec",["vec_u8.with_capacity",0]],["let","val_end",["std.json._parse_value","b","i","val_vec"]],["if",["<","val_end",0],["return",-1],0],["set","i",["std.json._skip_ws","b","val_end"]],["let","m_off",["vec_u8.len","members"]],["vec_u8.extend_bytes","offsets",["codec.write_u32_le","m_off"]],["vec_u8.extend_bytes","members",["codec.write_u32_le","key_len"]],["vec_u8.extend_bytes","members",["bytes.slice","b","key_start","key_len"]],["let","val_bytes",["vec_u8.as_bytes","val_vec"]],["let","val_len",["bytes.len","val_bytes"]],["vec_u8.extend_bytes","members",["codec.write_u32_le","val_len"]],["vec_u8.extend_bytes","members","val_bytes"],["set","count",["+","count",1]],["if",[">=u","i","n"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",44],["set","i",["std.json._skip_ws","b",["+","i",1]]],["if",["=","c",125],["begin",["std.json._emit_object_sorted",["vec_u8.as_bytes","members"],["vec_u8.as_bytes","offsets"],"count","out"],["return",["+","i",1]]],["return",-1]]],0]],-1],"kind":"defn","name":"std.json._parse_object","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","start",["+","off",1]],["let","end_quote",["std.json._string_end_or_err","b","start"]],["if",["<","end_quote",0],["return",-1],0],["vec_u8.push","out",34],["vec_u8.extend_bytes","out",["bytes.slice","b","start",["-","end_quote","start"]]],["vec_u8.push","out",34],["+","end_quote",1]],"kind":"defn","name":"std.json._parse_string","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i",["std.json._skip_ws","b","off"]],["if",[">=u","i","n"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",123],["std.json._parse_object","b","i","out"],["if",["=","c",91],["std.json._parse_array","b","i","out"],["if",["=","c",34],["std.json._parse_string","b","i","out"],["if",["=","c",116],["std.json._parse_lit","b","i",["bytes.lit","true"],"out"],["if",["=","c",102],["std.json._parse_lit","b","i",["bytes.lit","false"],"out"],["if",["=","c",110],["std.json._parse_lit","b","i",["bytes.lit","null"],"out"],["if",["if",["=","c",45],1,["std.json._is_digit","c"]],["std.json._parse_number","b","i","out"],-1]]]]]]]],"kind":"defn","name":"std.json._parse_value","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"},{"name":"out","ty":"i32"}],"result":"i32"},{"body":["begin",["let","off",0],["for","i",0,["+","idx",1],["begin",["let","len",["codec.read_u32_le","segs","off"]],["let","start",["+","off",4]],["if",["=","i","idx"],["return",["bytes.slice","segs","start","len"]],["set","off",["+","start","len"]]],0]],["bytes.alloc",0]],"kind":"defn","name":"std.json._segment_at","params":[{"name":"segs","ty":"bytes"},{"name":"idx","ty":"i32"}],"result":"bytes"},{"body":["begin",["let","n",["bytes.len","b"]],["for","i","off","n",["begin",["let","c",["bytes.get_u8","b","i"]],["if",["std.json._is_ws","c"],0,["return","i"]]]],"n"],"kind":"defn","name":"std.json._skip_ws","params":[{"name":"b","ty":"bytes"},{"name":"off","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["for","i","start","n",["begin",["let","c",["bytes.get_u8","b","i"]],["if",["=","c",34],["return","i"],0],["if",["=","c",92],["return",-1],0],["if",["<u","c",32],["return",-1],0],0]],-1],"kind":"defn","name":"std.json._string_end_or_err","params":[{"name":"b","ty":"bytes"},{"name":"start","ty":"i32"}],"result":"i32"},{"body":["begin",["let","out",["vec_u8.with_capacity",["bytes.len","b"]]],["let","end",["std.json._parse_value","b",0,"out"]],["if",["<","end",0],["return",["std.json._err"]],0],["let","end2",["std.json._skip_ws","b","end"]],["if",["=","end2",["bytes.len","b"]],["vec_u8.as_bytes","out"],["std.json._err"]]],"kind":"defn","name":"std.json.canonicalize_small","params":[{"name":"b","ty":"bytes"}],"result":"bytes"},{"body":["begin",["let","nul",["std.json._find_byte","b",0]],["if",["<","nul",0],["return",["std.json._err"]],0],["let","json",["bytes.slice","b",0,"nul"]],["let","path",["bytes.slice","b",["+","nul",1],["-",["bytes.len","b"],["+","nul",1]]]],["let","path_len",["bytes.len","path"]],["if",["=","path_len",0],["return",["std.json._err"]],0],["let","segs_vec",["vec_u8.with_capacity",["+","path_len",4]]],["let","seg_start",0],["let","seg_count",0],["for","i",0,"path_len",["begin",["if",["=",["bytes.get_u8","path","i"],46],["begin",["let","seg_len",["-","i","seg_start"]],["if",["=","seg_len",0],["return",["std.json._err"]],0],["vec_u8.extend_bytes","segs_vec",["codec.write_u32_le","seg_len"]],["vec_u8.extend_bytes","segs_vec",["bytes.slice","path","seg_start","seg_len"]],["set","seg_count",["+","seg_count",1]],["set","seg_start",["+","i",1]]],0],0]],["let","seg_len",["-","path_len","seg_start"]],["if",["=","seg_len",0],["return",["std.json._err"]],0],["vec_u8.extend_bytes","segs_vec",["codec.write_u32_le","seg_len"]],["vec_u8.extend_bytes","segs_vec",["bytes.slice","path","seg_start","seg_len"]],["set","seg_count",["+","seg_count",1]],["let","segs",["vec_u8.as_bytes","segs_vec"]],["let","out",["vec_u8.with_capacity",["bytes.len","json"]]],["let","extracted_end",["std.json._extract_from_value","json",0,"segs",0,"seg_count","out"]],["if",["<","extracted_end",0],["return",["std.json._err"]],0],["let","tmp",["vec_u8.with_capacity",0]],["let","root_end",["std.json._parse_value","json",0,"tmp"]],["if",["<","root_end",0],["return",["std.json._err"]],0],["let","root_end2",["std.json._skip_ws","json","root_end"]],["if",["=","root_end2",["bytes.len","json"]],["vec_u8.as_bytes","out"],["std.json._err"]]],"kind":"defn","name":"std.json.extract_path_canon_or_err","params":[{"name":"b","ty":"bytes"}],"result":"bytes"}],"imports":["std.slice"],"kind":"module","module_id":"std.json","schema_version":"x07.x07ast@0.1.0"}
