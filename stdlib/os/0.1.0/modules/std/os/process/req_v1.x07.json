{"decls":[{"kind":"export","names":["std.os.process.req_v1.arg","std.os.process.req_v1.cwd","std.os.process.req_v1.env","std.os.process.req_v1.finish","std.os.process.req_v1.new","std.os.process.req_v1.stdin","std.os.process.req_v1.validate_v1"]},{"body":["begin",["let","n",["view.len","req"]],["if",["<","n",6],["return",-1],0],["if",["!=",["view.get_u8","req",0],1],["return",-1],0],["let","argc",["codec.read_u32_le","req",2]],["if",["<","argc",0],["return",-1],0],["let","off",6],["for","i",0,"argc",["begin",["if",[">=u",["+","off",4],["+","n",1]],["return",-1],0],["let","arg_len",["codec.read_u32_le","req","off"]],["if",["<","arg_len",0],["return",-1],0],["let","arg_start",["+","off",4]],["if",[">=u",["+","arg_start","arg_len"],["+","n",1]],["return",-1],0],["set","off",["+","arg_start","arg_len"]],0]],"off"],"kind":"defn","name":"std.os.process.req_v1._argv_end","params":[{"name":"req","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","n",["view.len","req"]],["let","argv_end",["std.os.process.req_v1._argv_end","req"]],["if",["<","argv_end",0],["return",-1],0],["if",[">=u",["+","argv_end",4],["+","n",1]],["return",-1],0],["let","env_count",["codec.read_u32_le","req","argv_end"]],["if",["<","env_count",0],["return",-1],0],["let","off",["+","argv_end",4]],["for","i",0,"env_count",["begin",["if",[">=u",["+","off",4],["+","n",1]],["return",-1],0],["let","klen",["codec.read_u32_le","req","off"]],["if",["<","klen",0],["return",-1],0],["let","kstart",["+","off",4]],["if",[">=u",["+","kstart","klen"],["+","n",1]],["return",-1],0],["let","voff",["+","kstart","klen"]],["if",[">=u",["+","voff",4],["+","n",1]],["return",-1],0],["let","vlen",["codec.read_u32_le","req","voff"]],["if",["<","vlen",0],["return",-1],0],["let","vstart",["+","voff",4]],["if",[">=u",["+","vstart","vlen"],["+","n",1]],["return",-1],0],["set","off",["+","vstart","vlen"]],0]],"off"],"kind":"defn","name":"std.os.process.req_v1._env_end","params":[{"name":"req","ty":"bytes_view"}],"result":"i32"},{"body":["begin",["let","argv_end",["std.os.process.req_v1._argv_end",["vec_u8.as_view","req"]]],["if",["<","argv_end",0],["return","req"],0],["let","arg_len",["bytes.len","arg"]],["let","old_len",["vec_u8.len","req"]],["let","argc",["codec.read_u32_le",["vec_u8.as_view","req"],2]],["if",["=","old_len","argv_end"],["begin",["set","req",["std.u32.push_le","req","arg_len"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","arg"]]],["set","req",["std.u32.write_le_at_vec_u8","req",2,["+","argc",1]]],"req"],["begin",["let","v",["std.vec.with_capacity",["+","old_len",["+","arg_len",4]]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],0,"argv_end"]]],["set","v",["std.u32.push_le","v","arg_len"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","arg"]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],"argv_end",["-","old_len","argv_end"]]]],["set","v",["std.u32.write_le_at_vec_u8","v",2,["+","argc",1]]],"v"]]],"kind":"defn","name":"std.os.process.req_v1.arg","params":[{"name":"req","ty":"vec_u8"},{"name":"arg","ty":"bytes"}],"result":"vec_u8"},{"body":["begin",["let","argv_end",["std.os.process.req_v1._argv_end",["vec_u8.as_view","req"]]],["if",["<","argv_end",0],["return","req"],0],["let","cwd_len",["bytes.len","cwd"]],["let","len0",["vec_u8.len","req"]],["if",["=","len0","argv_end"],["set","req",["std.u32.push_le","req",0]],0],["let","env_end",["std.os.process.req_v1._env_end",["vec_u8.as_view","req"]]],["if",["<","env_end",0],["return","req"],0],["let","len1",["vec_u8.len","req"]],["if",["=","len1","env_end"],["begin",["set","req",["std.u32.push_le","req","cwd_len"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","cwd"]]],["set","req",["std.u32.push_le","req",0]],"req"],["begin",["if",[">=u",["+","env_end",4],["+","len1",1]],["return","req"],0],["let","old_cwd_len",["codec.read_u32_le",["vec_u8.as_view","req"],"env_end"]],["if",["<","old_cwd_len",0],["return","req"],0],["let","old_cwd_start",["+","env_end",4]],["let","after_cwd",["+","old_cwd_start","old_cwd_len"]],["if",[">=u","after_cwd",["+","len1",1]],["return","req"],0],["if",["=","after_cwd","len1"],["begin",["let","v",["std.vec.with_capacity",["+","env_end",["+",4,["+","cwd_len",4]]]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],0,"env_end"]]],["set","v",["std.u32.push_le","v","cwd_len"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","cwd"]]],["set","v",["std.u32.push_le","v",0]],"v"],["begin",["if",[">=u",["+","after_cwd",4],["+","len1",1]],["return","req"],0],["let","stdin_len",["codec.read_u32_le",["vec_u8.as_view","req"],"after_cwd"]],["if",["<","stdin_len",0],["return","req"],0],["let","stdin_start",["+","after_cwd",4]],["let","stdin_end",["+","stdin_start","stdin_len"]],["if",["!=","stdin_end","len1"],["return","req"],0],["let","v",["std.vec.with_capacity",["+","env_end",["+",4,["+","cwd_len",["+",4,"stdin_len"]]]]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],0,"env_end"]]],["set","v",["std.u32.push_le","v","cwd_len"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","cwd"]]],["set","v",["std.u32.push_le","v","stdin_len"]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],"stdin_start","stdin_len"]]],"v"]]]]],"kind":"defn","name":"std.os.process.req_v1.cwd","params":[{"name":"req","ty":"vec_u8"},{"name":"cwd","ty":"bytes"}],"result":"vec_u8"},{"body":["begin",["let","argv_end",["std.os.process.req_v1._argv_end",["vec_u8.as_view","req"]]],["if",["<","argv_end",0],["return","req"],0],["let","klen",["bytes.len","key"]],["let","vlen",["bytes.len","val"]],["let","old_len",["vec_u8.len","req"]],["if",["=","old_len","argv_end"],["set","req",["std.u32.push_le","req",0]],0],["let","env_end",["std.os.process.req_v1._env_end",["vec_u8.as_view","req"]]],["if",["<","env_end",0],["return","req"],0],["let","len1",["vec_u8.len","req"]],["let","env_count",["codec.read_u32_le",["vec_u8.as_view","req"],"argv_end"]],["if",["=","len1","env_end"],["begin",["set","req",["std.u32.push_le","req","klen"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","key"]]],["set","req",["std.u32.push_le","req","vlen"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","val"]]],["set","req",["std.u32.write_le_at_vec_u8","req","argv_end",["+","env_count",1]]],"req"],["begin",["let","v",["std.vec.with_capacity",["+","len1",["+",["+",8,"klen"],"vlen"]]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],0,"env_end"]]],["set","v",["std.u32.push_le","v","klen"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","key"]]],["set","v",["std.u32.push_le","v","vlen"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","val"]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],"env_end",["-","len1","env_end"]]]],["set","v",["std.u32.write_le_at_vec_u8","v","argv_end",["+","env_count",1]]],"v"]]],"kind":"defn","name":"std.os.process.req_v1.env","params":[{"name":"req","ty":"vec_u8"},{"name":"key","ty":"bytes"},{"name":"val","ty":"bytes"}],"result":"vec_u8"},{"body":["begin",["let","argv_end",["std.os.process.req_v1._argv_end",["vec_u8.as_view","req"]]],["if",["<","argv_end",0],["return",["std.vec.as_bytes","req"]],0],["let","len0",["vec_u8.len","req"]],["if",["=","len0","argv_end"],["set","req",["std.u32.push_le","req",0]],0],["let","env_end",["std.os.process.req_v1._env_end",["vec_u8.as_view","req"]]],["if",["<","env_end",0],["return",["std.vec.as_bytes","req"]],0],["let","len1",["vec_u8.len","req"]],["if",["=","len1","env_end"],["begin",["set","req",["std.u32.push_le","req",0]],["set","req",["std.u32.push_le","req",0]],["return",["std.vec.as_bytes","req"]]],0],["if",[">=u",["+","env_end",4],["+","len1",1]],["return",["std.vec.as_bytes","req"]],0],["let","cwd_len",["codec.read_u32_le",["vec_u8.as_view","req"],"env_end"]],["if",["<","cwd_len",0],["return",["std.vec.as_bytes","req"]],0],["let","cwd_start",["+","env_end",4]],["let","after_cwd",["+","cwd_start","cwd_len"]],["if",[">=u","after_cwd",["+","len1",1]],["return",["std.vec.as_bytes","req"]],0],["if",["=","after_cwd","len1"],["begin",["set","req",["std.u32.push_le","req",0]],["return",["std.vec.as_bytes","req"]]],0],["if",[">=u",["+","after_cwd",4],["+","len1",1]],["return",["std.vec.as_bytes","req"]],0],["let","stdin_len",["codec.read_u32_le",["vec_u8.as_view","req"],"after_cwd"]],["if",["<","stdin_len",0],["return",["std.vec.as_bytes","req"]],0],["let","stdin_start",["+","after_cwd",4]],["let","stdin_end",["+","stdin_start","stdin_len"]],["if",["!=","stdin_end","len1"],["return",["std.vec.as_bytes","req"]],0],["std.vec.as_bytes","req"]],"kind":"defn","name":"std.os.process.req_v1.finish","params":[{"name":"req","ty":"vec_u8"}],"result":"bytes","result_brand":"std.os.process.req_v1"},{"body":["begin",["let","exe_len",["bytes.len","exe"]],["let","v",["std.vec.with_capacity",["+","exe_len",64]]],["set","v",["std.vec.push","v",1]],["set","v",["std.vec.push","v",0]],["set","v",["std.u32.push_le","v",1]],["set","v",["std.u32.push_le","v","exe_len"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","exe"]]],"v"],"kind":"defn","name":"std.os.process.req_v1.new","params":[{"name":"exe","ty":"bytes"}],"result":"vec_u8"},{"body":["begin",["let","argv_end",["std.os.process.req_v1._argv_end",["vec_u8.as_view","req"]]],["if",["<","argv_end",0],["return","req"],0],["let","stdin_len",["bytes.len","stdin"]],["let","len0",["vec_u8.len","req"]],["if",["=","len0","argv_end"],["set","req",["std.u32.push_le","req",0]],0],["let","env_end",["std.os.process.req_v1._env_end",["vec_u8.as_view","req"]]],["if",["<","env_end",0],["return","req"],0],["let","len1",["vec_u8.len","req"]],["if",["=","len1","env_end"],["begin",["set","req",["std.u32.push_le","req",0]],["set","req",["std.u32.push_le","req","stdin_len"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","stdin"]]],"req"],["begin",["let","cwd_len",["codec.read_u32_le",["vec_u8.as_view","req"],"env_end"]],["if",["<","cwd_len",0],["return","req"],0],["let","cwd_start",["+","env_end",4]],["let","after_cwd",["+","cwd_start","cwd_len"]],["if",[">=u","after_cwd",["+","len1",1]],["return","req"],0],["if",["=","after_cwd","len1"],["begin",["set","req",["std.u32.push_le","req","stdin_len"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","stdin"]]],"req"],["begin",["if",[">=u",["+","after_cwd",4],["+","len1",1]],["return","req"],0],["let","old_stdin_len",["codec.read_u32_le",["vec_u8.as_view","req"],"after_cwd"]],["if",["<","old_stdin_len",0],["return","req"],0],["let","stdin_start",["+","after_cwd",4]],["let","stdin_end",["+","stdin_start","old_stdin_len"]],["if",["!=","stdin_end","len1"],["return","req"],0],["if",["=","old_stdin_len",0],["begin",["set","req",["std.u32.write_le_at_vec_u8","req","after_cwd","stdin_len"]],["set","req",["std.vec.extend_bytes","req",["bytes.view","stdin"]]],"req"],["begin",["let","v",["std.vec.with_capacity",["+","after_cwd",["+",4,"stdin_len"]]]],["set","v",["std.vec.extend_bytes","v",["view.slice",["vec_u8.as_view","req"],0,"after_cwd"]]],["set","v",["std.u32.push_le","v","stdin_len"]],["set","v",["std.vec.extend_bytes","v",["bytes.view","stdin"]]],"v"]]]]]]],"kind":"defn","name":"std.os.process.req_v1.stdin","params":[{"name":"req","ty":"vec_u8"},{"name":"stdin","ty":"bytes"}],"result":"vec_u8"},{"body":["begin",["let","n",["view.len","req"]],["if",["<","n",6],["return",["result_i32.err",2]],0],["if",["!=",["view.get_u8","req",0],1],["return",["result_i32.err",2]],0],["if",["!=",["view.get_u8","req",1],0],["return",["result_i32.err",2]],0],["let","argv_end",["std.os.process.req_v1._argv_end","req"]],["if",["<","argv_end",0],["return",["result_i32.err",2]],0],["let","env_end",["std.os.process.req_v1._env_end","req"]],["if",["<","env_end",0],["return",["result_i32.err",2]],0],["if",[">=u",["+","env_end",4],["+","n",1]],["return",["result_i32.err",2]],0],["let","cwd_len",["codec.read_u32_le","req","env_end"]],["if",["<","cwd_len",0],["return",["result_i32.err",2]],0],["let","cwd_start",["+","env_end",4]],["let","after_cwd",["+","cwd_start","cwd_len"]],["if",[">=u","after_cwd",["+","n",1]],["return",["result_i32.err",2]],0],["if",[">=u",["+","after_cwd",4],["+","n",1]],["return",["result_i32.err",2]],0],["let","stdin_len",["codec.read_u32_le","req","after_cwd"]],["if",["<","stdin_len",0],["return",["result_i32.err",2]],0],["let","stdin_start",["+","after_cwd",4]],["let","stdin_end",["+","stdin_start","stdin_len"]],["if",["!=","stdin_end","n"],["return",["result_i32.err",2]],0],["result_i32.ok",0]],"kind":"defn","name":"std.os.process.req_v1.validate_v1","params":[{"name":"req","ty":"bytes_view"}],"result":"result_i32"}],"imports":["std.u32","std.vec"],"kind":"module","meta":{"brands_v1":{"std.os.process.req_v1":{"doc":"docs/os/process-abi-v1.md#spawn-request-procreqv1","validate":"std.os.process.req_v1.validate_v1"}}},"module_id":"std.os.process.req_v1","schema_version":"x07.x07ast@0.3.0"}
