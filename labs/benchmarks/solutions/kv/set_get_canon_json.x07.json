{"decls":[{"body":["begin",["let","i",["+","start",1]],["let","depth",1],["for","_",0,["+","end",1],["begin",["if",[">=u","i","end"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",34],["begin",["let","q",["main.string_end_or_err","b",["+","i",1],"end"]],["if",["<","q",0],["return",-1],0],["set","i",["+","q",1]]],["if",["=","c",91],["begin",["set","depth",["+","depth",1]],["set","i",["+","i",1]]],["if",["=","c",93],["begin",["set","depth",["-","depth",1]],["set","i",["+","i",1]],["if",["=","depth",0],["return","i"],0]],["set","i",["+","i",1]]]]],0]],-1],"kind":"defn","name":"main.array_end_or_err","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["let","n",["bytes.len","b"]],["let","i",["main.skip_ws","b",0,"n"]],["if",[">=u","i","n"],["return",["bytes.lit","ERR"]],0],["if",["=",["bytes.get_u8","b","i"],123],0,["return",["bytes.lit","ERR"]]],["set","i",["main.skip_ws","b",["+","i",1],"n"]],["if",[">=u","i","n"],["return",["bytes.lit","ERR"]],0],["if",["=",["bytes.get_u8","b","i"],125],["return",["bytes.lit","{}"]],0],["let","meta",["vec_u8.with_capacity",["*","n",4]]],["let","count",0],["let","done",0],["for","_",0,["+","n",1],["if","done",0,["begin",["if",[">=u","i","n"],["return",["bytes.lit","ERR"]],0],["if",["=",["bytes.get_u8","b","i"],34],0,["return",["bytes.lit","ERR"]]],["let","key_start",["+","i",1]],["let","key_end",["main.string_end_or_err","b","key_start","n"]],["if",["<","key_end",0],["return",["bytes.lit","ERR"]],0],["let","key_len",["-","key_end","key_start"]],["set","i",["main.skip_ws","b",["+","key_end",1],"n"]],["if",[">=u","i","n"],["return",["bytes.lit","ERR"]],0],["if",["=",["bytes.get_u8","b","i"],58],0,["return",["bytes.lit","ERR"]]],["set","i",["main.skip_ws","b",["+","i",1],"n"]],["let","val_start","i"],["let","val_end",["main.value_end_or_err","b","val_start","n"]],["if",["<","val_end",0],["return",["bytes.lit","ERR"]],0],["set","meta",["vec_u8.extend_bytes","meta",["codec.write_u32_le","key_start"]]],["set","meta",["vec_u8.extend_bytes","meta",["codec.write_u32_le","key_len"]]],["set","meta",["vec_u8.extend_bytes","meta",["codec.write_u32_le","val_start"]]],["set","meta",["vec_u8.extend_bytes","meta",["codec.write_u32_le","val_end"]]],["set","count",["+","count",1]],["set","i",["main.skip_ws","b","val_end","n"]],["if",[">=u","i","n"],["return",["bytes.lit","ERR"]],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",44],["set","i",["main.skip_ws","b",["+","i",1],"n"]],["if",["=","c",125],["set","done",1],["return",["bytes.lit","ERR"]]]],0]]],["if",["=","done",0],["return",["bytes.lit","ERR"]],0],["let","meta_b",["vec_u8.into_bytes","meta"]],["let","out",["vec_u8.with_capacity","n"]],["set","out",["vec_u8.push","out",123]],["if",["=","count",0],["begin",["set","out",["vec_u8.push","out",125]],["return",["vec_u8.into_bytes","out"]]],0],["let","used",["bytes.alloc","count"]],["let","first",1],["for","_",0,"count",["begin",["let","best",-1],["for","j",0,"count",["begin",["if",["=",["bytes.get_u8","used","j"],1],0,["if",["=","best",-1],["set","best","j"],["begin",["let","js",["codec.read_u32_le","meta_b",["*","j",16]]],["let","jl",["codec.read_u32_le","meta_b",["+",["*","j",16],4]]],["let","bs",["codec.read_u32_le","meta_b",["*","best",16]]],["let","bl",["codec.read_u32_le","meta_b",["+",["*","best",16],4]]],["if",["<",["bytes.cmp_range","b","js","jl","b","bs","bl"],0],["set","best","j"],0]]]],0]],["set","used",["bytes.set_u8","used","best",1]],["if",["=","first",0],["set","out",["vec_u8.push","out",44]],["set","first",0]],["let","ks",["codec.read_u32_le","meta_b",["*","best",16]]],["let","kl",["codec.read_u32_le","meta_b",["+",["*","best",16],4]]],["let","vs",["codec.read_u32_le","meta_b",["+",["*","best",16],8]]],["let","ve",["codec.read_u32_le","meta_b",["+",["*","best",16],12]]],["set","out",["vec_u8.push","out",34]],["set","out",["vec_u8.extend_bytes_range","out","b","ks","kl"]],["set","out",["vec_u8.push","out",34]],["set","out",["vec_u8.push","out",58]],["set","out",["main.emit_minified_range","b","vs","ve","out"]],0]],["set","out",["vec_u8.push","out",125]],["vec_u8.into_bytes","out"]],"kind":"defn","name":"main.canon_obj_small","params":[{"name":"b","ty":"bytes_view"}],"result":"bytes"},{"body":["begin",["let","in_str",0],["let","esc",0],["for","i","start","end",["begin",["let","c",["bytes.get_u8","b","i"]],["if","in_str",["begin",["set","out",["vec_u8.push","out","c"]],["if","esc",["set","esc",0],["if",["=","c",92],["set","esc",1],["if",["=","c",34],["set","in_str",0],0]]],0],["begin",["if",["main.is_ws","c"],0,["begin",["set","out",["vec_u8.push","out","c"]],["if",["=","c",34],["set","in_str",1],0]]],0]],0]],"out"],"kind":"defn","name":"main.emit_minified_range","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"},{"name":"out","ty":"vec_u8"}],"result":"vec_u8"},{"body":["if",["=","c",32],1,["if",["=","c",9],1,["if",["=","c",10],1,["if",["=","c",13],1,0]]]],"kind":"defn","name":"main.is_ws","params":[{"name":"c","ty":"i32"}],"result":"i32"},{"body":["begin",["for","j","i","end",["begin",["let","c",["bytes.get_u8","b","j"]],["if",["main.is_ws","c"],0,["return","j"]],0]],"end"],"kind":"defn","name":"main.skip_ws","params":[{"name":"b","ty":"bytes_view"},{"name":"i","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["let","i","start"],["for","_",0,["+","end",1],["begin",["if",[">=u","i","end"],["return",-1],0],["let","c",["bytes.get_u8","b","i"]],["if",["=","c",34],["return","i"],0],["if",["=","c",92],["set","i",["+","i",2]],["begin",["if",["<u","c",32],["return",-1],0],["set","i",["+","i",1]]]],0]],-1],"kind":"defn","name":"main.string_end_or_err","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"},{"body":["begin",["if",[">=u","start","end"],["return",-1],0],["let","c",["bytes.get_u8","b","start"]],["if",["=","c",34],["begin",["let","q",["main.string_end_or_err","b",["+","start",1],"end"]],["if",["<","q",0],["return",-1],0],["return",["+","q",1]]],["if",["=","c",91],["return",["main.array_end_or_err","b","start","end"]],["if",["=","c",116],["begin",["if",[">=u",["+","start",4],["+","end",1]],["return",-1],0],["if",["=",["bytes.cmp_range","b","start",4,["bytes.lit","true"],0,4],0],["return",["+","start",4]],["return",-1]]],["if",["=","c",102],["begin",["if",[">=u",["+","start",5],["+","end",1]],["return",-1],0],["if",["=",["bytes.cmp_range","b","start",5,["bytes.lit","false"],0,5],0],["return",["+","start",5]],["return",-1]]],["if",["=","c",110],["begin",["if",[">=u",["+","start",4],["+","end",1]],["return",-1],0],["if",["=",["bytes.cmp_range","b","start",4,["bytes.lit","null"],0,4],0],["return",["+","start",4]],["return",-1]]],["begin",["let","i","start"],["if",["=","c",45],["set","i",["+","i",1]],0],["if",[">=u","i","end"],["return",-1],0],["let","d0",["bytes.get_u8","b","i"]],["if",["if",[">=u","d0",48],["<u","d0",58],0],0,["return",-1]],["set","i",["+","i",1]],["for","_",0,["+","end",1],["begin",["if",[">=u","i","end"],["return","i"],0],["let","d",["bytes.get_u8","b","i"]],["if",["if",[">=u","d",48],["<u","d",58],0],["set","i",["+","i",1]],["return","i"]],0]],"i"]]]]]]],"kind":"defn","name":"main.value_end_or_err","params":[{"name":"b","ty":"bytes_view"},{"name":"start","ty":"i32"},{"name":"end","ty":"i32"}],"result":"i32"}],"imports":["std.kv"],"kind":"entry","module_id":"main","schema_version":"x07.x07ast@0.2.0","solve":["begin",["let","n",["bytes.len","input"]],["if",["<u","n",1],["bytes.empty"],["begin",["let","key_len",["bytes.get_u8","input",0]],["if",["<u","n",["+",1,"key_len"]],["bytes.empty"],["begin",["let","key_view",["view.slice","input",1,"key_len"]],["let","key",["view.to_bytes","key_view"]],["let","json_off",["+",1,"key_len"]],["let","json_len",["-","n","json_off"]],["let","j",["view.slice","input","json_off","json_len"]],["let","canon",["main.canon_obj_small","j"]],["std.kv.set","key","canon"],["std.kv.get","key_view"]]]]]]}
